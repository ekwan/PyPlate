<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.0.0"/>
    <title>pyplate.pyplate API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../pyplate.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pyplate</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#EXTERNAL_PRECISION">EXTERNAL_PRECISION</a>
            </li>
            <li>
                    <a class="variable" href="#INTERNAL_PRECISION">INTERNAL_PRECISION</a>
            </li>
            <li>
                    <a class="variable" href="#VOLUME_STORAGE">VOLUME_STORAGE</a>
            </li>
            <li>
                    <a class="variable" href="#MOLES_STORAGE">MOLES_STORAGE</a>
            </li>
            <li>
                    <a class="class" href="#Unit">Unit</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Unit.convert_prefix">convert_prefix</a>
                        </li>
                        <li>
                                <a class="function" href="#Unit.extract_value_unit">extract_value_unit</a>
                        </li>
                        <li>
                                <a class="function" href="#Unit.convert_to_storage">convert_to_storage</a>
                        </li>
                        <li>
                                <a class="function" href="#Unit.convert_from_storage">convert_from_storage</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#is_integer">is_integer</a>
            </li>
            <li>
                    <a class="class" href="#Substance">Substance</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Substance.__init__">Substance</a>
                        </li>
                        <li>
                                <a class="variable" href="#Substance.SOLID">SOLID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Substance.LIQUID">LIQUID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Substance.ENZYME">ENZYME</a>
                        </li>
                        <li>
                                <a class="variable" href="#Substance.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Substance.molecule">molecule</a>
                        </li>
                        <li>
                                <a class="function" href="#Substance.solid">solid</a>
                        </li>
                        <li>
                                <a class="function" href="#Substance.liquid">liquid</a>
                        </li>
                        <li>
                                <a class="function" href="#Substance.enzyme">enzyme</a>
                        </li>
                        <li>
                                <a class="function" href="#Substance.is_solid">is_solid</a>
                        </li>
                        <li>
                                <a class="function" href="#Substance.is_liquid">is_liquid</a>
                        </li>
                        <li>
                                <a class="function" href="#Substance.is_enzyme">is_enzyme</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Container">Container</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Container.__init__">Container</a>
                        </li>
                        <li>
                                <a class="variable" href="#Container.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Container.contents">contents</a>
                        </li>
                        <li>
                                <a class="variable" href="#Container.volume">volume</a>
                        </li>
                        <li>
                                <a class="variable" href="#Container.max_volume">max_volume</a>
                        </li>
                        <li>
                                <a class="function" href="#Container.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Container.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#Container.transfer">transfer</a>
                        </li>
                        <li>
                                <a class="function" href="#Container.create_stock_solution">create_stock_solution</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Plate">Plate</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Plate.__init__">Plate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plate.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plate.make">make</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plate.wells">wells</a>
                        </li>
                        <li>
                                <a class="function" href="#Plate.volumes">volumes</a>
                        </li>
                        <li>
                                <a class="function" href="#Plate.substances">substances</a>
                        </li>
                        <li>
                                <a class="function" href="#Plate.moles">moles</a>
                        </li>
                        <li>
                                <a class="function" href="#Plate.volume">volume</a>
                        </li>
                        <li>
                                <a class="function" href="#Plate.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Plate.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#Plate.transfer">transfer</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Recipe">Recipe</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Recipe.indexes">indexes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Recipe.results">results</a>
                        </li>
                        <li>
                                <a class="variable" href="#Recipe.steps">steps</a>
                        </li>
                        <li>
                                <a class="variable" href="#Recipe.locked">locked</a>
                        </li>
                        <li>
                                <a class="variable" href="#Recipe.used">used</a>
                        </li>
                        <li>
                                <a class="function" href="#Recipe.uses">uses</a>
                        </li>
                        <li>
                                <a class="function" href="#Recipe.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#Recipe.transfer">transfer</a>
                        </li>
                        <li>
                                <a class="function" href="#Recipe.create_container">create_container</a>
                        </li>
                        <li>
                                <a class="function" href="#Recipe.create_stock_solution">create_stock_solution</a>
                        </li>
                        <li>
                                <a class="function" href="#Recipe.bake">bake</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../pyplate.html">pyplate</a><wbr>.pyplate    </h1>

                        <div class="docstring"><p>pyplate: a tool for designing chemistry experiments in plate format</p>

<p>All classes in this package are friends and use private methods of other classes freely.</p>
</div>

                        <input id="mod-pyplate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-pyplate-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">pyplate: a tool for designing chemistry experiments in plate format</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">All classes in this package are friends and use private methods of other classes freely.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="c1"># Allow typing reference while still building classes</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span> <span class="nn">re</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Dict</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">import</span> <span class="nn">numpy</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">pyplate.slicer</span> <span class="kn">import</span> <span class="n">Slicer</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="n">EXTERNAL_PRECISION</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="n">INTERNAL_PRECISION</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="n">VOLUME_STORAGE</span> <span class="o">=</span> <span class="mf">1e-6</span>  <span class="c1"># uL</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="n">MOLES_STORAGE</span> <span class="o">=</span> <span class="mf">1e-6</span>  <span class="c1"># umol</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="k">class</span> <span class="nc">Unit</span><span class="p">:</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    Provides unit conversion utility functions.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="k">def</span> <span class="nf">convert_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">        Converts an SI prefix into a multiplier.</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="n">prefixes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s1">&#39;Âµ&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">}</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="k">if</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span><span class="p">:</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>            <span class="k">return</span> <span class="n">prefixes</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid prefix: </span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="k">def</span> <span class="nf">extract_value_unit</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        Splits an amount into a value and unit, converting any SI prefix.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        Example: &#39;10 mL&#39; -&gt; (0.01, &#39;L&#39;)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="c1"># (floating point number in 1.0e1 format) possibly some white space (alpha string)</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([_\d]+(?:\.\d+)?(?:e-?\d+)?)\s*([a-zA-Z]+)&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid quantity.&quot;</span><span class="p">)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>            <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="k">for</span> <span class="n">base_unit</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">}:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>            <span class="k">if</span> <span class="n">unit</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">base_unit</span><span class="p">):</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>                <span class="n">prefix</span> <span class="o">=</span> <span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">base_unit</span><span class="p">)]</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>                <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">base_unit</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid unit.&quot;</span><span class="p">)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="k">def</span> <span class="nf">convert_to_unit_value</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        @private</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        Converts amount to standard units.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        :param substance: Substance in question</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        :param how_much: Amount of substance to convert</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        :param volume: Volume of containing Mixture in mL</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        :return: Value as per table below, but converted to storage format.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">                 +--------+--------+--------+--------+--------+--------+</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">                 |              Valid Input                   | Output |</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">                 |    g   |    L   |   mol  |    M   |    U   |        |</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        |SOLID   |   Yes  |   No   |   Yes  |   Yes  |   No   |   mol  |</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        |LIQUID  |   Yes  |   Yes  |   Yes  |   ??   |   No   |   mL   |</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        |ENZYME  |   No   |   No   |   No   |   No   |   Yes  |   U    |</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">extract_value_unit</span><span class="p">(</span><span class="n">how_much</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>  <span class="c1"># Convert to moles</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>  <span class="c1"># mass</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;mol&#39;</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>  <span class="c1"># molar</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>                <span class="k">if</span> <span class="n">volume</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must have a liquid to add a molar concentration.&#39;</span><span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>                <span class="c1"># value = molar concentration in mol/L, volume = volume in mL</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">volume</span> <span class="o">/</span> <span class="mi">1000</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;We only measure solids in grams and moles.&quot;</span><span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>            <span class="k">return</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="k">elif</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>  <span class="c1"># mass</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>                <span class="c1"># g -&gt; mL</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">substance</span><span class="o">.</span><span class="n">density</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>  <span class="c1"># volume</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">1000</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;mol&#39;</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                <span class="c1"># mol -&gt; mL</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">substance</span><span class="o">.</span><span class="n">concentration</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>            <span class="k">return</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="k">elif</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_enzyme</span><span class="p">():</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>                <span class="k">return</span> <span class="n">value</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">convert_to_storage</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        Converts value to storage format.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">        Example: (1, &#39;L&#39;) -&gt; 1e6 uL</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="n">unit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">prefix_value</span> <span class="o">/</span> <span class="n">VOLUME_STORAGE</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">prefix_value</span> <span class="o">/</span> <span class="n">MOLES_STORAGE</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="k">def</span> <span class="nf">convert_from_storage</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        Converts value from storage format.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">        Example: (1e3 uL, &#39;mL&#39;) -&gt; 1</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="k">if</span> <span class="n">unit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">VOLUME_STORAGE</span> <span class="o">/</span> <span class="n">prefix_value</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">MOLES_STORAGE</span> <span class="o">/</span> <span class="n">prefix_value</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="k">def</span> <span class="nf">is_integer</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">    Helper method to check if variable is integer.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="k">class</span> <span class="nc">Substance</span><span class="p">:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">    An abstract chemical or biological entity (e.g., reagent, enzyme, solvent, etc.). Immutable.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">    Solids and enzymes are assumed to require zero volume.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>    <span class="n">SOLID</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="n">LIQUID</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>    <span class="n">ENZYME</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_type</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">        Create a new substance.</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        Args:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">            mol_type: Substance.LIQUID, Substance.SOLID, or Substance.ENZYME.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">            molecule: (optional) A cctk molecule.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">mol_type</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span> <span class="o">=</span> <span class="n">molecule</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;SOLID (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;LIQUID (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ENZYME (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">mol_weight</span> \
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">density</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">concentration</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span><span class="p">))</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">solid</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Substance</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        Creates a solid substance.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        Args:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">            mol_weight: Molecular weight in g/mol</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="n">substance</span> <span class="o">=</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">SOLID</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="n">mol_weight</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="k">return</span> <span class="n">substance</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>    <span class="k">def</span> <span class="nf">liquid</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Substance</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        Creates a liquid substance.</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        Args:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">            mol_weight: Molecular weight in g/mol</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">            density: Density in g/mL</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="n">substance</span> <span class="o">=</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">LIQUID</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="n">mol_weight</span>  <span class="c1"># g / mol</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="n">density</span>  <span class="c1"># g / mL</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">density</span> <span class="o">/</span> <span class="n">mol_weight</span>  <span class="c1"># mol / mL</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="k">return</span> <span class="n">substance</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="k">def</span> <span class="nf">enzyme</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        Creates an enzyme.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        Args:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">            name: Name of enzyme.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="k">return</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">ENZYME</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="k">def</span> <span class="nf">is_solid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        Return true if Substance is a solid.</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">SOLID</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>    <span class="k">def</span> <span class="nf">is_liquid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        Return true if Substance is a liquid.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">LIQUID</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="k">def</span> <span class="nf">is_enzyme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        Return true if Substance is an enzyme.</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">ENZYME</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="k">class</span> <span class="nc">Container</span><span class="p">:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">    Stores specified quantities of Substances in a vessel with a given maximum volume. Immutable.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        Create a Container.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">        Args:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">            name: Name of container</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">            max_volume: Maximum volume that can be stored in the container in mL</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">            initial_contents: (optional) Iterable of tuples of the form (Substance, quantity)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Substance</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">max_volume</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>            <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span> <span class="ow">in</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_self_add</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Container</span><span class="p">:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">        Clones current Container.</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">)</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">contents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span>  <span class="c1"># Don&#39;t readjust this value</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">contents</span> <span class="ow">and</span> \
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">max_volume</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">,</span> <span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">items</span><span class="p">()))))</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>    <span class="k">def</span> <span class="nf">_self_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">        Adds to current Container, mutating it.</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">        Only to be used in the constructor and immediately after copy</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">        Args:</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">            source: Substance to add.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">            how_much: How much to add. (&#39;10 mol&#39;)</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="k">if</span> <span class="n">how_much</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">source</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="c1"># TODO: molarity from liquids?</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Molarity solutions can only be made from solids.&quot;</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="n">volume</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="n">amount_to_transfer</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_unit_value</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">how_much</span><span class="p">,</span> <span class="n">volume</span><span class="p">),</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">amount_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">+</span> <span class="n">amount_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Exceeded maximum volume&quot;</span><span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>    <span class="k">def</span> <span class="nf">_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_container</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; transfer volume (&#39;10 mL&#39;) from container to self &quot;&quot;&quot;</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_container</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>        <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">extract_value_unit</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="o">!=</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;We can only transfer liquid from other containers.&quot;</span><span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="k">if</span> <span class="n">volume_to_transfer</span> <span class="o">&gt;</span> <span class="n">source_container</span><span class="o">.</span><span class="n">volume</span><span class="p">:</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not enough mixture left in source container.&quot;</span> <span class="o">+</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                             <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mL&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> mL &quot;</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                             <span class="sa">f</span><span class="s2">&quot; needed of </span><span class="si">{</span><span class="n">source_container</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                             <span class="sa">f</span><span class="s2">&quot; out of </span><span class="si">{</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">source_container</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mL&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> mL.&quot;</span><span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="n">source_container</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">source_container</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">volume_to_transfer</span> <span class="o">/</span> <span class="n">source_container</span><span class="o">.</span><span class="n">volume</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">source_container</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">amount</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="n">source_container</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_container</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">]</span> <span class="o">-</span> <span class="n">amount</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">,</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                                                         <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="n">to</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">volume</span> <span class="o">+</span> <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="k">if</span> <span class="n">to</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="n">to</span><span class="o">.</span><span class="n">max_volume</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exceeded maximum volume in </span><span class="si">{</span><span class="n">to</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">source_container</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_container</span><span class="o">.</span><span class="n">volume</span> <span class="o">-</span> <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="k">return</span> <span class="n">source_container</span><span class="p">,</span> <span class="n">to</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>    <span class="k">def</span> <span class="nf">_transfer_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">        Transfer volume (&#39;10 mL&#39;) from slice to self</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        Returns:</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">            A tuple of a new plate and a new container, both modified.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="k">def</span> <span class="nf">helper_func</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot; Moves volume from elem to to_array[0]&quot;&quot;&quot;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>            <span class="n">elem</span><span class="p">,</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>            <span class="k">return</span> <span class="n">elem</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_slice</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>            <span class="n">source_slice</span> <span class="o">=</span> <span class="n">source_slice</span><span class="p">[:]</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_slice</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>        <span class="n">source_slice</span> <span class="o">=</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>        <span class="n">source_slice</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>        <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">extract_value_unit</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="c1"># volume_to_transfer *= 1000.0  # convert L to mL</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="o">!=</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;We can only transfer liquid from other containers.&quot;</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">volume_to_transfer</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">-</span> <span class="n">to</span><span class="o">.</span><span class="n">volume</span><span class="p">):</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not enough room left in destination container.&quot;</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="n">to_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">to</span><span class="p">]</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper_func</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">source_slice</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="n">source_slice</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">plate</span><span class="p">,</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="n">max_volume</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)))</span> \
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Container (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">) (</span><span class="si">{</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mL&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_volume</span><span class="si">}</span><span class="s2"> of (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Container</span><span class="p">:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        Move the given quantity (&#39;10 mol&#39;) of the source substance to the destination container.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        Returns:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">            A new copy of destination.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Container.add to add to a Container&quot;</span><span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="n">destination</span><span class="o">.</span><span class="n">_self_add</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="k">return</span> <span class="n">destination</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">        Move volume (&#39;10 mL&#39;) from source to destination container,</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        returning copies of the objects with amounts adjusted accordingly.</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">        Returns:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">            A tuple of (T, Container) where T is the type of the source.</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Container.transfer into a Container&quot;</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="k">return</span> <span class="n">destination</span><span class="o">.</span><span class="n">_transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>            <span class="k">return</span> <span class="n">destination</span><span class="o">.</span><span class="n">_transfer_slice</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>    <span class="k">def</span> <span class="nf">create_stock_solution</span><span class="p">(</span><span class="n">what</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">solvent</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        Create a stock solution.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        Args:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">            what: What to dilute.</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">            concentration: Desired concentration in mol/L</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">            solvent: What to dilute with.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">            volume: Desired total volume in mL.</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        Returns:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">            New container with desired solution.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">what</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">concentration</span><span class="si">:</span><span class="s2">.2</span><span class="si">}</span><span class="s2">M&quot;</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="n">moles_to_add</span> <span class="o">=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">concentration</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="k">if</span> <span class="n">what</span><span class="o">.</span><span class="n">is_enzyme</span><span class="p">():</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can&#39;t add enzymes by molarity.&quot;</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>        <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">solvent</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">moles_to_add</span><span class="p">,</span><span class="w"> </span><span class="n">INTERNAL_PRECISION</span><span class="p">)</span><span class="si">}</span><span class="s2"> mol&quot;</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Liquid</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>            <span class="n">volume_to_add</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">moles_to_add</span> <span class="o">*</span> <span class="n">what</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">/</span> <span class="p">(</span><span class="n">what</span><span class="o">.</span><span class="n">density</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">solvent</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">volume_to_add</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume_to_add</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="k">return</span> <span class="n">container</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="k">class</span> <span class="nc">Plate</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">    A spatially ordered collection of Containers, like a 96 well plate.</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">    The spatial arrangement must be rectangular. Immutable.</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_volume_per_well</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">make</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;generic&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">            Creates a generic plate.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">            Attributes:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">                name: name of plate</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">                max_volume_per_well: maximum volume of each well in uL</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">                make: name of this kind of plate</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">                rows (int or list): number of rows or list of names of rows</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">                columns (int or list): number of columns or list of names of columns</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid plate name&quot;</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">make</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">make</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid plate make&quot;</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">make</span> <span class="o">=</span> <span class="n">make</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;illegal number of rows&quot;</span><span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="n">rows</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>                <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>                    <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">26</span><span class="p">))</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>                    <span class="n">n</span> <span class="o">//=</span> <span class="mi">26</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>            <span class="c1"># self.row_names = [f&quot;{i + 1}&quot; for i in range(rows)]</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must have at least one row&quot;</span><span class="p">)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;row names must be strings&quot;</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>                        <span class="s2">&quot;zero length strings are not allowed as column labels&quot;</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>                    <span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>                <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>                        <span class="sa">f</span><span class="s2">&quot;please don&#39;t confuse me with row names that are integers (</span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>                    <span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rows</span><span class="p">)):</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;duplicate row names found&quot;</span><span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="o">=</span> <span class="n">rows</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;rows must be int or list&quot;</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_volume_per_well</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>            <span class="k">if</span> <span class="n">max_volume_per_well</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max volume per well must be greater than zero&quot;</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="s1">&#39;uL&#39;</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid max volume per well </span><span class="si">{</span><span class="n">max_volume_per_well</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="k">if</span> <span class="n">columns</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;illegal number of columns&quot;</span><span class="p">)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">)]</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must have at least one row&quot;</span><span class="p">)</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;row names must be strings&quot;</span><span class="p">)</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>                        <span class="s2">&quot;zero length strings are not allowed as column labels&quot;</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>                    <span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>                <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>                        <span class="sa">f</span><span class="s2">&quot;please don&#39;t confuse me with column names that are integers(</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>                    <span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)):</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;duplicate column names found&quot;</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;columns must be int or list&quot;</span><span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Container</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;well </span><span class="si">{</span><span class="n">row</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">col</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>                                             <span class="n">max_volume</span><span class="o">=</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">))</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>                                   <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span><span class="p">)]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">)])</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PlateSlicer</span><span class="p">:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Plate: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>    <span class="k">def</span> <span class="nf">volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substance</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="sd">        Args:</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">            substance: (optional) Substance to display volumes of.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">        Returns:</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">            numpy.ndarray of volumes for each well in uL</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="k">if</span> <span class="n">substance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="s1">&#39;uL&#39;</span><span class="p">))(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>            <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot; Returns volume of elem. &quot;&quot;&quot;</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>                <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">()</span> <span class="ow">and</span> <span class="n">substance</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>                    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;uL&#39;</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>                    <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>    <span class="k">def</span> <span class="nf">substances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">        Returns: A set of substances present in the plate.</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>        <span class="n">substances_arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">keys</span><span class="p">())(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>        <span class="k">return</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">substances_arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>    <span class="k">def</span> <span class="nf">moles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substance</span><span class="p">):</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        Returns: moles of substance in each well.</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>        <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot; Returns moles of substance in elem. &quot;&quot;&quot;</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>            <span class="k">if</span> <span class="n">substance</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>                <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>            <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>                <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">substance</span><span class="o">.</span><span class="n">density</span> <span class="o">/</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>                             <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span><span class="p">,</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>            <span class="k">elif</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>                <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;mol&#39;</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a><span class="sd">        Returns: total volume stored in plate in uL.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">        Returns: A clone of the current plate.</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>        <span class="n">new_plate</span> <span class="o">=</span> <span class="n">Plate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">make</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">new_plate</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">row_names</span><span class="p">,</span> <span class="n">new_plate</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span>  <span class="c1"># Don&#39;t readjust this value</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>        <span class="k">return</span> <span class="n">new_plate</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Plate</span> <span class="o">|</span> <span class="n">PlateSlicer</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="sd">        Move the given quantity (&#39;10 mol&#39;) of the source substance to the destination.</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">        Returns:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">            A new copy of destination plate.</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Plate.add to add to a Plate&quot;</span><span class="p">)</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>        <span class="c1"># noinspection PyProtectedMember</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Plate</span> <span class="o">|</span> <span class="n">PlateSlicer</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">        Move volume (&#39;10 mL&#39;) from source to destination,</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a><span class="sd">        returning copies of the objects with amounts adjusted accordingly.</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a><span class="sd">        Returns:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a><span class="sd">            A tuple of (T, Plate) where T is the type of the source.</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Plate.transfer into a Plate&quot;</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>        <span class="c1"># noinspection PyProtectedMember</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="o">.</span><span class="n">_transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a><span class="k">class</span> <span class="nc">Recipe</span><span class="p">:</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a><span class="sd">    A list of instructions for transforming one set of containers into another. The intended workflow is to declare</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a><span class="sd">    the source containers, enumerate the desired transformations, and call recipe.bake(). This method will ensure</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a><span class="sd">    that all solid and liquid handling instructions are valid. If they are indeed valid, then the updated containers</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a><span class="sd">    will be generated. Once recipe.bake() has been called, no more instructions can be added and the Recipe is</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a><span class="sd">    considered immutable.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locked</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">used</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>    <span class="k">def</span> <span class="nf">uses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a><span class="sd">        Declare *containers (iterable of Containers) as being used in the recipe.</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>            <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a><span class="sd">        Adds a step to the recipe which will move the given quantity (&#39;10 mol&#39;)</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a><span class="sd">        of the source substance to the destination.</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination type.&quot;</span><span class="p">)</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">destination</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Destination not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">))</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span> <span class="o">|</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a><span class="sd">        Adds a step to the recipe which will move volume from source to destination.</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a><span class="sd">        Note that all Substances in the source will be transferred in proportion to their volumetric ratios.</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination type.&quot;</span><span class="p">)</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">(</span><span class="n">Substance</span><span class="p">,</span> <span class="n">Container</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">source</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Source not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">destination</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Destination not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>            <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">[:]</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;transfer&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">volume</span><span class="p">))</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>    <span class="k">def</span> <span class="nf">create_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="p">,</span> <span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a><span class="sd">        Adds a step to the recipe which creates a container.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a><span class="sd">        Args:</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a><span class="sd">            name: Name of container</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a><span class="sd">            max_volume: Maximum volume that can be stored in the container in mL</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a><span class="sd">            initial_contents: (optional) Iterable of tuples of the form (Substance, quantity)</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a><span class="sd">        Returns:</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a><span class="sd">            A new Container so that it may be used in later recipe steps.</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="p">)</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">new_container</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>        <span class="k">if</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>            <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span> <span class="ow">in</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Containers can only be created from substances.&quot;</span><span class="p">)</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">substance</span><span class="p">,</span> <span class="n">new_container</span><span class="p">,</span> <span class="n">how_much</span><span class="p">))</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a>    <span class="k">def</span> <span class="nf">create_stock_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">solvent</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a><span class="sd">        Adds a step to the recipe which creates a stock solution.</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a><span class="sd">        Args:</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a><span class="sd">            what: What to dilute.</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a><span class="sd">            concentration: Desired concentration in mol/L</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a><span class="sd">            solvent: What to dilute with.</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a><span class="sd">            volume: Desired total volume in mL.</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a><span class="sd">        Returns:</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a><span class="sd">            A new Container so that it may be used in later recipe steps.</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{what.name}</span><span class="s2"> </span><span class="si">{concentration:.2}</span><span class="s2">M&quot;</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">new_container</span><span class="p">)</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;stock&#39;</span><span class="p">,</span> <span class="n">new_container</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span><span class="p">))</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a>    <span class="k">def</span> <span class="nf">bake</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a><span class="sd">        Completes steps stored in recipe.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a><span class="sd">        Checks validity of each step and ensures all declared objects have been used.</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a><span class="sd">        Locks Recipe from further modification.</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a><span class="sd">        Returns:</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a><span class="sd">            Copies of all used objects in the order they were declared.</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a>        <span class="k">for</span> <span class="n">operation</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a>            <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span><span class="p">:</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a>                <span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a>                <span class="c1"># containers and such can change while building the recipe</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a>                    <span class="n">new_to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a>                    <span class="n">new_to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;transfer&#39;</span><span class="p">:</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a>                <span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a>                <span class="c1"># used items can change in a recipe</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a>                <span class="n">frm_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">frm</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">frm</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm_index</span><span class="p">)</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a>                <span class="c1"># containers and such can change while baking the recipe</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a>                    <span class="n">new_frm</span> <span class="o">=</span> <span class="n">frm</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a>                    <span class="n">new_frm</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a>                    <span class="n">frm</span> <span class="o">=</span> <span class="n">new_frm</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a>                    <span class="n">frm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a>                    <span class="n">new_to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a>                    <span class="n">new_to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos">830</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos">831</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos">832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos">833</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>  <span class="c1"># Adding a substance is handled differently</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos">834</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos">835</span></a>                        <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos">836</span></a>                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos">837</span></a>                        <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos">838</span></a>                    <span class="c1"># to = to.add(frm, how_much)</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos">839</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos">840</span></a>                    <span class="n">frm</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos">841</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos">842</span></a>                    <span class="n">frm</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos">843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos">844</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">frm</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos">845</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos">846</span></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;stock&#39;</span><span class="p">:</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos">847</span></a>                <span class="n">to</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos">848</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos">849</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos">850</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">create_stock_solution</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos">851</span></a>
</span><span id="L-852"><a href="#L-852"><span class="linenos">852</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">):</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos">853</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Something declared as used wasn&#39;t used.&quot;</span><span class="p">)</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos">854</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locked</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos">855</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Substance</span><span class="p">)]</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos">856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos">857</span></a>
</span><span id="L-858"><a href="#L-858"><span class="linenos">858</span></a><span class="k">class</span> <span class="nc">PlateSlicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos">859</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos">860</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plate</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos">861</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">plate</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos">862</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">plate</span><span class="o">.</span><span class="n">wells</span><span class="p">,</span> <span class="n">plate</span><span class="o">.</span><span class="n">row_names</span><span class="p">,</span> <span class="n">plate</span><span class="o">.</span><span class="n">column_names</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos">863</span></a>
</span><span id="L-864"><a href="#L-864"><span class="linenos">864</span></a>    <span class="nd">@property</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos">865</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos">866</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos">867</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">wells</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos">868</span></a>
</span><span id="L-869"><a href="#L-869"><span class="linenos">869</span></a>    <span class="nd">@array</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos">870</span></a>    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos">871</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="n">array</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos">872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos">873</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos">874</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos">875</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos">876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos">877</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos">878</span></a>    <span class="k">def</span> <span class="nf">_add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos">879</span></a>        <span class="n">to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos">880</span></a>        <span class="n">to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos">881</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">Container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">how_much</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">to</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos">882</span></a>        <span class="n">to</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos">883</span></a>        <span class="k">return</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos">884</span></a>
</span><span id="L-885"><a href="#L-885"><span class="linenos">885</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos">886</span></a>    <span class="k">def</span> <span class="nf">_transfer</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos">887</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos">888</span></a>            <span class="n">to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos">889</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos">890</span></a>
</span><span id="L-891"><a href="#L-891"><span class="linenos">891</span></a>            <span class="k">def</span> <span class="nf">helper_func</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos">892</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos">893</span></a>                <span class="n">frm_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">elem</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">elem</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos">894</span></a>                <span class="k">return</span> <span class="n">elem</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos">895</span></a>
</span><span id="L-896"><a href="#L-896"><span class="linenos">896</span></a>            <span class="n">frm_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">frm</span><span class="p">]</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos">897</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper_func</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">to</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos">898</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">Container</span><span class="p">):</span>  <span class="c1"># A zero-dim array was returned.</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos">899</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos">900</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos">901</span></a>            <span class="k">return</span> <span class="n">frm_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos">902</span></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos">903</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos">904</span></a>
</span><span id="L-905"><a href="#L-905"><span class="linenos">905</span></a>        <span class="n">to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos">906</span></a>        <span class="n">frm</span> <span class="o">=</span> <span class="n">frm</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos">907</span></a>
</span><span id="L-908"><a href="#L-908"><span class="linenos">908</span></a>        <span class="k">if</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span> <span class="o">!=</span> <span class="n">frm</span><span class="o">.</span><span class="n">plate</span><span class="p">:</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos">909</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos">910</span></a>            <span class="n">frm</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">frm</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos">911</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos">912</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">frm</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos">913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos">914</span></a>        <span class="k">if</span> <span class="n">frm</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos">915</span></a>            <span class="c1"># Source from the single element in frm</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos">916</span></a>            <span class="k">if</span> <span class="n">frm</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">():</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos">917</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Shape of source should have been ()&quot;</span><span class="p">)</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos">918</span></a>
</span><span id="L-919"><a href="#L-919"><span class="linenos">919</span></a>            <span class="k">def</span> <span class="nf">helper_func</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos">920</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos">921</span></a>                <span class="n">frm_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">elem</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">elem</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos">922</span></a>                <span class="k">return</span> <span class="n">elem</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos">923</span></a>
</span><span id="L-924"><a href="#L-924"><span class="linenos">924</span></a>            <span class="n">frm_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">frm</span><span class="o">.</span><span class="n">get</span><span class="p">()]</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos">925</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper_func</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">to</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos">926</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos">927</span></a>            <span class="n">frm</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frm_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos">928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos">929</span></a>        <span class="k">elif</span> <span class="n">to</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos">930</span></a>            <span class="c1">#  Replace the single element in self</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos">931</span></a>            <span class="k">if</span> <span class="n">to</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">():</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos">932</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Shape of source should have been ()&quot;</span><span class="p">)</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos">933</span></a>
</span><span id="L-934"><a href="#L-934"><span class="linenos">934</span></a>            <span class="k">def</span> <span class="nf">helper_func</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos">935</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos">936</span></a>                <span class="n">elem</span><span class="p">,</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos">937</span></a>                <span class="k">return</span> <span class="n">elem</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos">938</span></a>
</span><span id="L-939"><a href="#L-939"><span class="linenos">939</span></a>            <span class="n">to_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">to</span><span class="o">.</span><span class="n">get</span><span class="p">()]</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos">940</span></a>            <span class="n">frm</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper_func</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">frm</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos">941</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos">942</span></a>
</span><span id="L-943"><a href="#L-943"><span class="linenos">943</span></a>        <span class="k">elif</span> <span class="n">frm</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">to</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span> <span class="n">frm</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">to</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos">944</span></a>            <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">elem1</span><span class="p">,</span> <span class="n">elem2</span><span class="p">):</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos">945</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot; @private &quot;&quot;&quot;</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos">946</span></a>                <span class="k">return</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">elem1</span><span class="p">,</span> <span class="n">elem2</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos">947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos">948</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">frompyfunc</span><span class="p">(</span><span class="n">helper</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos">949</span></a>            <span class="n">frm_result</span><span class="p">,</span> <span class="n">to_result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">frm</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">to</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos">950</span></a>            <span class="n">frm</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">frm_result</span><span class="p">)</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos">951</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">to_result</span><span class="p">)</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos">952</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos">953</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Source and destination slices must be the same size and shape.&quot;</span><span class="p">)</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos">954</span></a>
</span><span id="L-955"><a href="#L-955"><span class="linenos">955</span></a>        <span class="k">return</span> <span class="n">frm</span><span class="o">.</span><span class="n">plate</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">plate</span>
</span></pre></div>


            </section>
                <section id="EXTERNAL_PRECISION">
                    <div class="attr variable">
            <span class="name">EXTERNAL_PRECISION</span>        =
<span class="default_value">3</span>

        
    </div>
    <a class="headerlink" href="#EXTERNAL_PRECISION"></a>
    
    

                </section>
                <section id="INTERNAL_PRECISION">
                    <div class="attr variable">
            <span class="name">INTERNAL_PRECISION</span>        =
<span class="default_value">10</span>

        
    </div>
    <a class="headerlink" href="#INTERNAL_PRECISION"></a>
    
    

                </section>
                <section id="VOLUME_STORAGE">
                    <div class="attr variable">
            <span class="name">VOLUME_STORAGE</span>        =
<span class="default_value">1e-06</span>

        
    </div>
    <a class="headerlink" href="#VOLUME_STORAGE"></a>
    
    

                </section>
                <section id="MOLES_STORAGE">
                    <div class="attr variable">
            <span class="name">MOLES_STORAGE</span>        =
<span class="default_value">1e-06</span>

        
    </div>
    <a class="headerlink" href="#MOLES_STORAGE"></a>
    
    

                </section>
                <section id="Unit">
                            <input id="Unit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Unit</span>:

                <label class="view-source-button" for="Unit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Unit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Unit-23"><a href="#Unit-23"><span class="linenos"> 23</span></a><span class="k">class</span> <span class="nc">Unit</span><span class="p">:</span>
</span><span id="Unit-24"><a href="#Unit-24"><span class="linenos"> 24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit-25"><a href="#Unit-25"><span class="linenos"> 25</span></a><span class="sd">    Provides unit conversion utility functions.</span>
</span><span id="Unit-26"><a href="#Unit-26"><span class="linenos"> 26</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Unit-27"><a href="#Unit-27"><span class="linenos"> 27</span></a>
</span><span id="Unit-28"><a href="#Unit-28"><span class="linenos"> 28</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit-29"><a href="#Unit-29"><span class="linenos"> 29</span></a>    <span class="k">def</span> <span class="nf">convert_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
</span><span id="Unit-30"><a href="#Unit-30"><span class="linenos"> 30</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit-31"><a href="#Unit-31"><span class="linenos"> 31</span></a>
</span><span id="Unit-32"><a href="#Unit-32"><span class="linenos"> 32</span></a><span class="sd">        Converts an SI prefix into a multiplier.</span>
</span><span id="Unit-33"><a href="#Unit-33"><span class="linenos"> 33</span></a>
</span><span id="Unit-34"><a href="#Unit-34"><span class="linenos"> 34</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit-35"><a href="#Unit-35"><span class="linenos"> 35</span></a>        <span class="n">prefixes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s1">&#39;Âµ&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">}</span>
</span><span id="Unit-36"><a href="#Unit-36"><span class="linenos"> 36</span></a>        <span class="k">if</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span><span class="p">:</span>
</span><span id="Unit-37"><a href="#Unit-37"><span class="linenos"> 37</span></a>            <span class="k">return</span> <span class="n">prefixes</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span>
</span><span id="Unit-38"><a href="#Unit-38"><span class="linenos"> 38</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid prefix: </span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Unit-39"><a href="#Unit-39"><span class="linenos"> 39</span></a>
</span><span id="Unit-40"><a href="#Unit-40"><span class="linenos"> 40</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit-41"><a href="#Unit-41"><span class="linenos"> 41</span></a>    <span class="k">def</span> <span class="nf">extract_value_unit</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="Unit-42"><a href="#Unit-42"><span class="linenos"> 42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit-43"><a href="#Unit-43"><span class="linenos"> 43</span></a>
</span><span id="Unit-44"><a href="#Unit-44"><span class="linenos"> 44</span></a><span class="sd">        Splits an amount into a value and unit, converting any SI prefix.</span>
</span><span id="Unit-45"><a href="#Unit-45"><span class="linenos"> 45</span></a><span class="sd">        Example: &#39;10 mL&#39; -&gt; (0.01, &#39;L&#39;)</span>
</span><span id="Unit-46"><a href="#Unit-46"><span class="linenos"> 46</span></a>
</span><span id="Unit-47"><a href="#Unit-47"><span class="linenos"> 47</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit-48"><a href="#Unit-48"><span class="linenos"> 48</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Unit-49"><a href="#Unit-49"><span class="linenos"> 49</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span>
</span><span id="Unit-50"><a href="#Unit-50"><span class="linenos"> 50</span></a>        <span class="c1"># (floating point number in 1.0e1 format) possibly some white space (alpha string)</span>
</span><span id="Unit-51"><a href="#Unit-51"><span class="linenos"> 51</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([_\d]+(?:\.\d+)?(?:e-?\d+)?)\s*([a-zA-Z]+)&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span><span id="Unit-52"><a href="#Unit-52"><span class="linenos"> 52</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
</span><span id="Unit-53"><a href="#Unit-53"><span class="linenos"> 53</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid quantity.&quot;</span><span class="p">)</span>
</span><span id="Unit-54"><a href="#Unit-54"><span class="linenos"> 54</span></a>        <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</span><span id="Unit-55"><a href="#Unit-55"><span class="linenos"> 55</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="Unit-56"><a href="#Unit-56"><span class="linenos"> 56</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
</span><span id="Unit-57"><a href="#Unit-57"><span class="linenos"> 57</span></a>            <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span>
</span><span id="Unit-58"><a href="#Unit-58"><span class="linenos"> 58</span></a>        <span class="k">for</span> <span class="n">base_unit</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">}:</span>
</span><span id="Unit-59"><a href="#Unit-59"><span class="linenos"> 59</span></a>            <span class="k">if</span> <span class="n">unit</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">base_unit</span><span class="p">):</span>
</span><span id="Unit-60"><a href="#Unit-60"><span class="linenos"> 60</span></a>                <span class="n">prefix</span> <span class="o">=</span> <span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">base_unit</span><span class="p">)]</span>
</span><span id="Unit-61"><a href="#Unit-61"><span class="linenos"> 61</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
</span><span id="Unit-62"><a href="#Unit-62"><span class="linenos"> 62</span></a>                <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">base_unit</span>
</span><span id="Unit-63"><a href="#Unit-63"><span class="linenos"> 63</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid unit.&quot;</span><span class="p">)</span>
</span><span id="Unit-64"><a href="#Unit-64"><span class="linenos"> 64</span></a>
</span><span id="Unit-65"><a href="#Unit-65"><span class="linenos"> 65</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit-66"><a href="#Unit-66"><span class="linenos"> 66</span></a>    <span class="k">def</span> <span class="nf">convert_to_unit_value</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="Unit-67"><a href="#Unit-67"><span class="linenos"> 67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit-68"><a href="#Unit-68"><span class="linenos"> 68</span></a><span class="sd">        @private</span>
</span><span id="Unit-69"><a href="#Unit-69"><span class="linenos"> 69</span></a><span class="sd">        Converts amount to standard units.</span>
</span><span id="Unit-70"><a href="#Unit-70"><span class="linenos"> 70</span></a>
</span><span id="Unit-71"><a href="#Unit-71"><span class="linenos"> 71</span></a><span class="sd">        :param substance: Substance in question</span>
</span><span id="Unit-72"><a href="#Unit-72"><span class="linenos"> 72</span></a><span class="sd">        :param how_much: Amount of substance to convert</span>
</span><span id="Unit-73"><a href="#Unit-73"><span class="linenos"> 73</span></a><span class="sd">        :param volume: Volume of containing Mixture in mL</span>
</span><span id="Unit-74"><a href="#Unit-74"><span class="linenos"> 74</span></a><span class="sd">        :return: Value as per table below, but converted to storage format.</span>
</span><span id="Unit-75"><a href="#Unit-75"><span class="linenos"> 75</span></a>
</span><span id="Unit-76"><a href="#Unit-76"><span class="linenos"> 76</span></a><span class="sd">                 +--------+--------+--------+--------+--------+--------+</span>
</span><span id="Unit-77"><a href="#Unit-77"><span class="linenos"> 77</span></a><span class="sd">                 |              Valid Input                   | Output |</span>
</span><span id="Unit-78"><a href="#Unit-78"><span class="linenos"> 78</span></a><span class="sd">                 |    g   |    L   |   mol  |    M   |    U   |        |</span>
</span><span id="Unit-79"><a href="#Unit-79"><span class="linenos"> 79</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="Unit-80"><a href="#Unit-80"><span class="linenos"> 80</span></a><span class="sd">        |SOLID   |   Yes  |   No   |   Yes  |   Yes  |   No   |   mol  |</span>
</span><span id="Unit-81"><a href="#Unit-81"><span class="linenos"> 81</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="Unit-82"><a href="#Unit-82"><span class="linenos"> 82</span></a><span class="sd">        |LIQUID  |   Yes  |   Yes  |   Yes  |   ??   |   No   |   mL   |</span>
</span><span id="Unit-83"><a href="#Unit-83"><span class="linenos"> 83</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="Unit-84"><a href="#Unit-84"><span class="linenos"> 84</span></a><span class="sd">        |ENZYME  |   No   |   No   |   No   |   No   |   Yes  |   U    |</span>
</span><span id="Unit-85"><a href="#Unit-85"><span class="linenos"> 85</span></a><span class="sd">        +--------+--------+--------+--------+--------+--------+--------+</span>
</span><span id="Unit-86"><a href="#Unit-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit-87"><a href="#Unit-87"><span class="linenos"> 87</span></a>
</span><span id="Unit-88"><a href="#Unit-88"><span class="linenos"> 88</span></a>        <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">extract_value_unit</span><span class="p">(</span><span class="n">how_much</span><span class="p">)</span>
</span><span id="Unit-89"><a href="#Unit-89"><span class="linenos"> 89</span></a>        <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>  <span class="c1"># Convert to moles</span>
</span><span id="Unit-90"><a href="#Unit-90"><span class="linenos"> 90</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>  <span class="c1"># mass</span>
</span><span id="Unit-91"><a href="#Unit-91"><span class="linenos"> 91</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span>
</span><span id="Unit-92"><a href="#Unit-92"><span class="linenos"> 92</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;mol&#39;</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="Unit-93"><a href="#Unit-93"><span class="linenos"> 93</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Unit-94"><a href="#Unit-94"><span class="linenos"> 94</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>  <span class="c1"># molar</span>
</span><span id="Unit-95"><a href="#Unit-95"><span class="linenos"> 95</span></a>                <span class="k">if</span> <span class="n">volume</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="Unit-96"><a href="#Unit-96"><span class="linenos"> 96</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must have a liquid to add a molar concentration.&#39;</span><span class="p">)</span>
</span><span id="Unit-97"><a href="#Unit-97"><span class="linenos"> 97</span></a>                <span class="c1"># value = molar concentration in mol/L, volume = volume in mL</span>
</span><span id="Unit-98"><a href="#Unit-98"><span class="linenos"> 98</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">volume</span> <span class="o">/</span> <span class="mi">1000</span>
</span><span id="Unit-99"><a href="#Unit-99"><span class="linenos"> 99</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Unit-100"><a href="#Unit-100"><span class="linenos">100</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;We only measure solids in grams and moles.&quot;</span><span class="p">)</span>
</span><span id="Unit-101"><a href="#Unit-101"><span class="linenos">101</span></a>            <span class="k">return</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span><span class="p">)</span>
</span><span id="Unit-102"><a href="#Unit-102"><span class="linenos">102</span></a>        <span class="k">elif</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="Unit-103"><a href="#Unit-103"><span class="linenos">103</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>  <span class="c1"># mass</span>
</span><span id="Unit-104"><a href="#Unit-104"><span class="linenos">104</span></a>                <span class="c1"># g -&gt; mL</span>
</span><span id="Unit-105"><a href="#Unit-105"><span class="linenos">105</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">substance</span><span class="o">.</span><span class="n">density</span>
</span><span id="Unit-106"><a href="#Unit-106"><span class="linenos">106</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>  <span class="c1"># volume</span>
</span><span id="Unit-107"><a href="#Unit-107"><span class="linenos">107</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">1000</span>
</span><span id="Unit-108"><a href="#Unit-108"><span class="linenos">108</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;mol&#39;</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="Unit-109"><a href="#Unit-109"><span class="linenos">109</span></a>                <span class="c1"># mol -&gt; mL</span>
</span><span id="Unit-110"><a href="#Unit-110"><span class="linenos">110</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">substance</span><span class="o">.</span><span class="n">concentration</span>
</span><span id="Unit-111"><a href="#Unit-111"><span class="linenos">111</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Unit-112"><a href="#Unit-112"><span class="linenos">112</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span>
</span><span id="Unit-113"><a href="#Unit-113"><span class="linenos">113</span></a>            <span class="k">return</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span>
</span><span id="Unit-114"><a href="#Unit-114"><span class="linenos">114</span></a>        <span class="k">elif</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_enzyme</span><span class="p">():</span>
</span><span id="Unit-115"><a href="#Unit-115"><span class="linenos">115</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
</span><span id="Unit-116"><a href="#Unit-116"><span class="linenos">116</span></a>                <span class="k">return</span> <span class="n">value</span>
</span><span id="Unit-117"><a href="#Unit-117"><span class="linenos">117</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span>
</span><span id="Unit-118"><a href="#Unit-118"><span class="linenos">118</span></a>
</span><span id="Unit-119"><a href="#Unit-119"><span class="linenos">119</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit-120"><a href="#Unit-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">convert_to_storage</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Unit-121"><a href="#Unit-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit-122"><a href="#Unit-122"><span class="linenos">122</span></a>
</span><span id="Unit-123"><a href="#Unit-123"><span class="linenos">123</span></a><span class="sd">        Converts value to storage format.</span>
</span><span id="Unit-124"><a href="#Unit-124"><span class="linenos">124</span></a><span class="sd">        Example: (1, &#39;L&#39;) -&gt; 1e6 uL</span>
</span><span id="Unit-125"><a href="#Unit-125"><span class="linenos">125</span></a>
</span><span id="Unit-126"><a href="#Unit-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit-127"><a href="#Unit-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">unit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="Unit-128"><a href="#Unit-128"><span class="linenos">128</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Unit-129"><a href="#Unit-129"><span class="linenos">129</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">prefix_value</span> <span class="o">/</span> <span class="n">VOLUME_STORAGE</span>
</span><span id="Unit-130"><a href="#Unit-130"><span class="linenos">130</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="Unit-131"><a href="#Unit-131"><span class="linenos">131</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Unit-132"><a href="#Unit-132"><span class="linenos">132</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">prefix_value</span> <span class="o">/</span> <span class="n">MOLES_STORAGE</span>
</span><span id="Unit-133"><a href="#Unit-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Unit-134"><a href="#Unit-134"><span class="linenos">134</span></a>
</span><span id="Unit-135"><a href="#Unit-135"><span class="linenos">135</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit-136"><a href="#Unit-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">convert_from_storage</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
</span><span id="Unit-137"><a href="#Unit-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit-138"><a href="#Unit-138"><span class="linenos">138</span></a>
</span><span id="Unit-139"><a href="#Unit-139"><span class="linenos">139</span></a><span class="sd">        Converts value from storage format.</span>
</span><span id="Unit-140"><a href="#Unit-140"><span class="linenos">140</span></a><span class="sd">        Example: (1e3 uL, &#39;mL&#39;) -&gt; 1</span>
</span><span id="Unit-141"><a href="#Unit-141"><span class="linenos">141</span></a>
</span><span id="Unit-142"><a href="#Unit-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit-143"><a href="#Unit-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="n">unit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="Unit-144"><a href="#Unit-144"><span class="linenos">144</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Unit-145"><a href="#Unit-145"><span class="linenos">145</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">VOLUME_STORAGE</span> <span class="o">/</span> <span class="n">prefix_value</span>
</span><span id="Unit-146"><a href="#Unit-146"><span class="linenos">146</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="Unit-147"><a href="#Unit-147"><span class="linenos">147</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Unit-148"><a href="#Unit-148"><span class="linenos">148</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">MOLES_STORAGE</span> <span class="o">/</span> <span class="n">prefix_value</span>
</span><span id="Unit-149"><a href="#Unit-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Provides unit conversion utility functions.</p>
</div>


                            <div id="Unit.convert_prefix" class="classattr">
                                        <input id="Unit.convert_prefix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">convert_prefix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">prefix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Unit.convert_prefix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Unit.convert_prefix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Unit.convert_prefix-28"><a href="#Unit.convert_prefix-28"><span class="linenos">28</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit.convert_prefix-29"><a href="#Unit.convert_prefix-29"><span class="linenos">29</span></a>    <span class="k">def</span> <span class="nf">convert_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
</span><span id="Unit.convert_prefix-30"><a href="#Unit.convert_prefix-30"><span class="linenos">30</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit.convert_prefix-31"><a href="#Unit.convert_prefix-31"><span class="linenos">31</span></a>
</span><span id="Unit.convert_prefix-32"><a href="#Unit.convert_prefix-32"><span class="linenos">32</span></a><span class="sd">        Converts an SI prefix into a multiplier.</span>
</span><span id="Unit.convert_prefix-33"><a href="#Unit.convert_prefix-33"><span class="linenos">33</span></a>
</span><span id="Unit.convert_prefix-34"><a href="#Unit.convert_prefix-34"><span class="linenos">34</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit.convert_prefix-35"><a href="#Unit.convert_prefix-35"><span class="linenos">35</span></a>        <span class="n">prefixes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s1">&#39;Âµ&#39;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">}</span>
</span><span id="Unit.convert_prefix-36"><a href="#Unit.convert_prefix-36"><span class="linenos">36</span></a>        <span class="k">if</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span><span class="p">:</span>
</span><span id="Unit.convert_prefix-37"><a href="#Unit.convert_prefix-37"><span class="linenos">37</span></a>            <span class="k">return</span> <span class="n">prefixes</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span>
</span><span id="Unit.convert_prefix-38"><a href="#Unit.convert_prefix-38"><span class="linenos">38</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid prefix: </span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts an SI prefix into a multiplier.</p>
</div>


                            </div>
                            <div id="Unit.extract_value_unit" class="classattr">
                                        <input id="Unit.extract_value_unit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">extract_value_unit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">s</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Unit.extract_value_unit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Unit.extract_value_unit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Unit.extract_value_unit-40"><a href="#Unit.extract_value_unit-40"><span class="linenos">40</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit.extract_value_unit-41"><a href="#Unit.extract_value_unit-41"><span class="linenos">41</span></a>    <span class="k">def</span> <span class="nf">extract_value_unit</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="Unit.extract_value_unit-42"><a href="#Unit.extract_value_unit-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit.extract_value_unit-43"><a href="#Unit.extract_value_unit-43"><span class="linenos">43</span></a>
</span><span id="Unit.extract_value_unit-44"><a href="#Unit.extract_value_unit-44"><span class="linenos">44</span></a><span class="sd">        Splits an amount into a value and unit, converting any SI prefix.</span>
</span><span id="Unit.extract_value_unit-45"><a href="#Unit.extract_value_unit-45"><span class="linenos">45</span></a><span class="sd">        Example: &#39;10 mL&#39; -&gt; (0.01, &#39;L&#39;)</span>
</span><span id="Unit.extract_value_unit-46"><a href="#Unit.extract_value_unit-46"><span class="linenos">46</span></a>
</span><span id="Unit.extract_value_unit-47"><a href="#Unit.extract_value_unit-47"><span class="linenos">47</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit.extract_value_unit-48"><a href="#Unit.extract_value_unit-48"><span class="linenos">48</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Unit.extract_value_unit-49"><a href="#Unit.extract_value_unit-49"><span class="linenos">49</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span>
</span><span id="Unit.extract_value_unit-50"><a href="#Unit.extract_value_unit-50"><span class="linenos">50</span></a>        <span class="c1"># (floating point number in 1.0e1 format) possibly some white space (alpha string)</span>
</span><span id="Unit.extract_value_unit-51"><a href="#Unit.extract_value_unit-51"><span class="linenos">51</span></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([_\d]+(?:\.\d+)?(?:e-?\d+)?)\s*([a-zA-Z]+)&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span><span id="Unit.extract_value_unit-52"><a href="#Unit.extract_value_unit-52"><span class="linenos">52</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
</span><span id="Unit.extract_value_unit-53"><a href="#Unit.extract_value_unit-53"><span class="linenos">53</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid quantity.&quot;</span><span class="p">)</span>
</span><span id="Unit.extract_value_unit-54"><a href="#Unit.extract_value_unit-54"><span class="linenos">54</span></a>        <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</span><span id="Unit.extract_value_unit-55"><a href="#Unit.extract_value_unit-55"><span class="linenos">55</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="Unit.extract_value_unit-56"><a href="#Unit.extract_value_unit-56"><span class="linenos">56</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
</span><span id="Unit.extract_value_unit-57"><a href="#Unit.extract_value_unit-57"><span class="linenos">57</span></a>            <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span>
</span><span id="Unit.extract_value_unit-58"><a href="#Unit.extract_value_unit-58"><span class="linenos">58</span></a>        <span class="k">for</span> <span class="n">base_unit</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">}:</span>
</span><span id="Unit.extract_value_unit-59"><a href="#Unit.extract_value_unit-59"><span class="linenos">59</span></a>            <span class="k">if</span> <span class="n">unit</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">base_unit</span><span class="p">):</span>
</span><span id="Unit.extract_value_unit-60"><a href="#Unit.extract_value_unit-60"><span class="linenos">60</span></a>                <span class="n">prefix</span> <span class="o">=</span> <span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">base_unit</span><span class="p">)]</span>
</span><span id="Unit.extract_value_unit-61"><a href="#Unit.extract_value_unit-61"><span class="linenos">61</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
</span><span id="Unit.extract_value_unit-62"><a href="#Unit.extract_value_unit-62"><span class="linenos">62</span></a>                <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">base_unit</span>
</span><span id="Unit.extract_value_unit-63"><a href="#Unit.extract_value_unit-63"><span class="linenos">63</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid unit.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Splits an amount into a value and unit, converting any SI prefix.
Example: '10 mL' -> (0.01, 'L')</p>
</div>


                            </div>
                            <div id="Unit.convert_to_storage" class="classattr">
                                        <input id="Unit.convert_to_storage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">convert_to_storage</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">unit</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Unit.convert_to_storage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Unit.convert_to_storage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Unit.convert_to_storage-119"><a href="#Unit.convert_to_storage-119"><span class="linenos">119</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit.convert_to_storage-120"><a href="#Unit.convert_to_storage-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">convert_to_storage</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Unit.convert_to_storage-121"><a href="#Unit.convert_to_storage-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit.convert_to_storage-122"><a href="#Unit.convert_to_storage-122"><span class="linenos">122</span></a>
</span><span id="Unit.convert_to_storage-123"><a href="#Unit.convert_to_storage-123"><span class="linenos">123</span></a><span class="sd">        Converts value to storage format.</span>
</span><span id="Unit.convert_to_storage-124"><a href="#Unit.convert_to_storage-124"><span class="linenos">124</span></a><span class="sd">        Example: (1, &#39;L&#39;) -&gt; 1e6 uL</span>
</span><span id="Unit.convert_to_storage-125"><a href="#Unit.convert_to_storage-125"><span class="linenos">125</span></a>
</span><span id="Unit.convert_to_storage-126"><a href="#Unit.convert_to_storage-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit.convert_to_storage-127"><a href="#Unit.convert_to_storage-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">unit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="Unit.convert_to_storage-128"><a href="#Unit.convert_to_storage-128"><span class="linenos">128</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Unit.convert_to_storage-129"><a href="#Unit.convert_to_storage-129"><span class="linenos">129</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">prefix_value</span> <span class="o">/</span> <span class="n">VOLUME_STORAGE</span>
</span><span id="Unit.convert_to_storage-130"><a href="#Unit.convert_to_storage-130"><span class="linenos">130</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="Unit.convert_to_storage-131"><a href="#Unit.convert_to_storage-131"><span class="linenos">131</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Unit.convert_to_storage-132"><a href="#Unit.convert_to_storage-132"><span class="linenos">132</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">prefix_value</span> <span class="o">/</span> <span class="n">MOLES_STORAGE</span>
</span><span id="Unit.convert_to_storage-133"><a href="#Unit.convert_to_storage-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts value to storage format.
Example: (1, 'L') -> 1e6 uL</p>
</div>


                            </div>
                            <div id="Unit.convert_from_storage" class="classattr">
                                        <input id="Unit.convert_from_storage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">convert_from_storage</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span>, </span><span class="param"><span class="n">unit</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Unit.convert_from_storage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Unit.convert_from_storage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Unit.convert_from_storage-135"><a href="#Unit.convert_from_storage-135"><span class="linenos">135</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Unit.convert_from_storage-136"><a href="#Unit.convert_from_storage-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">convert_from_storage</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
</span><span id="Unit.convert_from_storage-137"><a href="#Unit.convert_from_storage-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Unit.convert_from_storage-138"><a href="#Unit.convert_from_storage-138"><span class="linenos">138</span></a>
</span><span id="Unit.convert_from_storage-139"><a href="#Unit.convert_from_storage-139"><span class="linenos">139</span></a><span class="sd">        Converts value from storage format.</span>
</span><span id="Unit.convert_from_storage-140"><a href="#Unit.convert_from_storage-140"><span class="linenos">140</span></a><span class="sd">        Example: (1e3 uL, &#39;mL&#39;) -&gt; 1</span>
</span><span id="Unit.convert_from_storage-141"><a href="#Unit.convert_from_storage-141"><span class="linenos">141</span></a>
</span><span id="Unit.convert_from_storage-142"><a href="#Unit.convert_from_storage-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Unit.convert_from_storage-143"><a href="#Unit.convert_from_storage-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="n">unit</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="Unit.convert_from_storage-144"><a href="#Unit.convert_from_storage-144"><span class="linenos">144</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Unit.convert_from_storage-145"><a href="#Unit.convert_from_storage-145"><span class="linenos">145</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">VOLUME_STORAGE</span> <span class="o">/</span> <span class="n">prefix_value</span>
</span><span id="Unit.convert_from_storage-146"><a href="#Unit.convert_from_storage-146"><span class="linenos">146</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># moles</span>
</span><span id="Unit.convert_from_storage-147"><a href="#Unit.convert_from_storage-147"><span class="linenos">147</span></a>            <span class="n">prefix_value</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_prefix</span><span class="p">(</span><span class="n">unit</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Unit.convert_from_storage-148"><a href="#Unit.convert_from_storage-148"><span class="linenos">148</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">MOLES_STORAGE</span> <span class="o">/</span> <span class="n">prefix_value</span>
</span><span id="Unit.convert_from_storage-149"><a href="#Unit.convert_from_storage-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts value from storage format.
Example: (1e3 uL, 'mL') -> 1</p>
</div>


                            </div>
                </section>
                <section id="is_integer">
                            <input id="is_integer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_integer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">s</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="is_integer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_integer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_integer-152"><a href="#is_integer-152"><span class="linenos">152</span></a><span class="k">def</span> <span class="nf">is_integer</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="is_integer-153"><a href="#is_integer-153"><span class="linenos">153</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="is_integer-154"><a href="#is_integer-154"><span class="linenos">154</span></a><span class="sd">    Helper method to check if variable is integer.</span>
</span><span id="is_integer-155"><a href="#is_integer-155"><span class="linenos">155</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_integer-156"><a href="#is_integer-156"><span class="linenos">156</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="is_integer-157"><a href="#is_integer-157"><span class="linenos">157</span></a>        <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="is_integer-158"><a href="#is_integer-158"><span class="linenos">158</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="is_integer-159"><a href="#is_integer-159"><span class="linenos">159</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="is_integer-160"><a href="#is_integer-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Helper method to check if variable is integer.</p>
</div>


                </section>
                <section id="Substance">
                            <input id="Substance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Substance</span>:

                <label class="view-source-button" for="Substance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance-163"><a href="#Substance-163"><span class="linenos">163</span></a><span class="k">class</span> <span class="nc">Substance</span><span class="p">:</span>
</span><span id="Substance-164"><a href="#Substance-164"><span class="linenos">164</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-165"><a href="#Substance-165"><span class="linenos">165</span></a><span class="sd">    An abstract chemical or biological entity (e.g., reagent, enzyme, solvent, etc.). Immutable.</span>
</span><span id="Substance-166"><a href="#Substance-166"><span class="linenos">166</span></a><span class="sd">    Solids and enzymes are assumed to require zero volume.</span>
</span><span id="Substance-167"><a href="#Substance-167"><span class="linenos">167</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Substance-168"><a href="#Substance-168"><span class="linenos">168</span></a>    <span class="n">SOLID</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Substance-169"><a href="#Substance-169"><span class="linenos">169</span></a>    <span class="n">LIQUID</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Substance-170"><a href="#Substance-170"><span class="linenos">170</span></a>    <span class="n">ENZYME</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="Substance-171"><a href="#Substance-171"><span class="linenos">171</span></a>
</span><span id="Substance-172"><a href="#Substance-172"><span class="linenos">172</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_type</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Substance-173"><a href="#Substance-173"><span class="linenos">173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-174"><a href="#Substance-174"><span class="linenos">174</span></a><span class="sd">        Create a new substance.</span>
</span><span id="Substance-175"><a href="#Substance-175"><span class="linenos">175</span></a>
</span><span id="Substance-176"><a href="#Substance-176"><span class="linenos">176</span></a><span class="sd">        Args:</span>
</span><span id="Substance-177"><a href="#Substance-177"><span class="linenos">177</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="Substance-178"><a href="#Substance-178"><span class="linenos">178</span></a><span class="sd">            mol_type: Substance.LIQUID, Substance.SOLID, or Substance.ENZYME.</span>
</span><span id="Substance-179"><a href="#Substance-179"><span class="linenos">179</span></a><span class="sd">            molecule: (optional) A cctk molecule.</span>
</span><span id="Substance-180"><a href="#Substance-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance-181"><a href="#Substance-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Substance-182"><a href="#Substance-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">mol_type</span>
</span><span id="Substance-183"><a href="#Substance-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Substance-184"><a href="#Substance-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span> <span class="o">=</span> <span class="n">molecule</span>
</span><span id="Substance-185"><a href="#Substance-185"><span class="linenos">185</span></a>
</span><span id="Substance-186"><a href="#Substance-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance-187"><a href="#Substance-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="Substance-188"><a href="#Substance-188"><span class="linenos">188</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;SOLID (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Substance-189"><a href="#Substance-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="Substance-190"><a href="#Substance-190"><span class="linenos">190</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;LIQUID (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Substance-191"><a href="#Substance-191"><span class="linenos">191</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Substance-192"><a href="#Substance-192"><span class="linenos">192</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ENZYME (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Substance-193"><a href="#Substance-193"><span class="linenos">193</span></a>
</span><span id="Substance-194"><a href="#Substance-194"><span class="linenos">194</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Substance-195"><a href="#Substance-195"><span class="linenos">195</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Substance-196"><a href="#Substance-196"><span class="linenos">196</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Substance-197"><a href="#Substance-197"><span class="linenos">197</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">mol_weight</span> \
</span><span id="Substance-198"><a href="#Substance-198"><span class="linenos">198</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">density</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">concentration</span>
</span><span id="Substance-199"><a href="#Substance-199"><span class="linenos">199</span></a>
</span><span id="Substance-200"><a href="#Substance-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance-201"><a href="#Substance-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span><span class="p">))</span>
</span><span id="Substance-202"><a href="#Substance-202"><span class="linenos">202</span></a>
</span><span id="Substance-203"><a href="#Substance-203"><span class="linenos">203</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Substance-204"><a href="#Substance-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">solid</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Substance</span><span class="p">:</span>
</span><span id="Substance-205"><a href="#Substance-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-206"><a href="#Substance-206"><span class="linenos">206</span></a><span class="sd">        Creates a solid substance.</span>
</span><span id="Substance-207"><a href="#Substance-207"><span class="linenos">207</span></a>
</span><span id="Substance-208"><a href="#Substance-208"><span class="linenos">208</span></a><span class="sd">        Args:</span>
</span><span id="Substance-209"><a href="#Substance-209"><span class="linenos">209</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="Substance-210"><a href="#Substance-210"><span class="linenos">210</span></a><span class="sd">            mol_weight: Molecular weight in g/mol</span>
</span><span id="Substance-211"><a href="#Substance-211"><span class="linenos">211</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="Substance-212"><a href="#Substance-212"><span class="linenos">212</span></a>
</span><span id="Substance-213"><a href="#Substance-213"><span class="linenos">213</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="Substance-214"><a href="#Substance-214"><span class="linenos">214</span></a>
</span><span id="Substance-215"><a href="#Substance-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance-216"><a href="#Substance-216"><span class="linenos">216</span></a>        <span class="n">substance</span> <span class="o">=</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">SOLID</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="Substance-217"><a href="#Substance-217"><span class="linenos">217</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="n">mol_weight</span>
</span><span id="Substance-218"><a href="#Substance-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="n">substance</span>
</span><span id="Substance-219"><a href="#Substance-219"><span class="linenos">219</span></a>
</span><span id="Substance-220"><a href="#Substance-220"><span class="linenos">220</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Substance-221"><a href="#Substance-221"><span class="linenos">221</span></a>    <span class="k">def</span> <span class="nf">liquid</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Substance</span><span class="p">:</span>
</span><span id="Substance-222"><a href="#Substance-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-223"><a href="#Substance-223"><span class="linenos">223</span></a><span class="sd">        Creates a liquid substance.</span>
</span><span id="Substance-224"><a href="#Substance-224"><span class="linenos">224</span></a>
</span><span id="Substance-225"><a href="#Substance-225"><span class="linenos">225</span></a><span class="sd">        Args:</span>
</span><span id="Substance-226"><a href="#Substance-226"><span class="linenos">226</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="Substance-227"><a href="#Substance-227"><span class="linenos">227</span></a><span class="sd">            mol_weight: Molecular weight in g/mol</span>
</span><span id="Substance-228"><a href="#Substance-228"><span class="linenos">228</span></a><span class="sd">            density: Density in g/mL</span>
</span><span id="Substance-229"><a href="#Substance-229"><span class="linenos">229</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="Substance-230"><a href="#Substance-230"><span class="linenos">230</span></a>
</span><span id="Substance-231"><a href="#Substance-231"><span class="linenos">231</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="Substance-232"><a href="#Substance-232"><span class="linenos">232</span></a>
</span><span id="Substance-233"><a href="#Substance-233"><span class="linenos">233</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance-234"><a href="#Substance-234"><span class="linenos">234</span></a>        <span class="n">substance</span> <span class="o">=</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">LIQUID</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="Substance-235"><a href="#Substance-235"><span class="linenos">235</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="n">mol_weight</span>  <span class="c1"># g / mol</span>
</span><span id="Substance-236"><a href="#Substance-236"><span class="linenos">236</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="n">density</span>  <span class="c1"># g / mL</span>
</span><span id="Substance-237"><a href="#Substance-237"><span class="linenos">237</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">density</span> <span class="o">/</span> <span class="n">mol_weight</span>  <span class="c1"># mol / mL</span>
</span><span id="Substance-238"><a href="#Substance-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">substance</span>
</span><span id="Substance-239"><a href="#Substance-239"><span class="linenos">239</span></a>
</span><span id="Substance-240"><a href="#Substance-240"><span class="linenos">240</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Substance-241"><a href="#Substance-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">enzyme</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Substance-242"><a href="#Substance-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-243"><a href="#Substance-243"><span class="linenos">243</span></a><span class="sd">        Creates an enzyme.</span>
</span><span id="Substance-244"><a href="#Substance-244"><span class="linenos">244</span></a>
</span><span id="Substance-245"><a href="#Substance-245"><span class="linenos">245</span></a><span class="sd">        Args:</span>
</span><span id="Substance-246"><a href="#Substance-246"><span class="linenos">246</span></a><span class="sd">            name: Name of enzyme.</span>
</span><span id="Substance-247"><a href="#Substance-247"><span class="linenos">247</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="Substance-248"><a href="#Substance-248"><span class="linenos">248</span></a>
</span><span id="Substance-249"><a href="#Substance-249"><span class="linenos">249</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="Substance-250"><a href="#Substance-250"><span class="linenos">250</span></a>
</span><span id="Substance-251"><a href="#Substance-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance-252"><a href="#Substance-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">ENZYME</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="Substance-253"><a href="#Substance-253"><span class="linenos">253</span></a>
</span><span id="Substance-254"><a href="#Substance-254"><span class="linenos">254</span></a>    <span class="k">def</span> <span class="nf">is_solid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance-255"><a href="#Substance-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-256"><a href="#Substance-256"><span class="linenos">256</span></a><span class="sd">        Return true if Substance is a solid.</span>
</span><span id="Substance-257"><a href="#Substance-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance-258"><a href="#Substance-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">SOLID</span>
</span><span id="Substance-259"><a href="#Substance-259"><span class="linenos">259</span></a>
</span><span id="Substance-260"><a href="#Substance-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">is_liquid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance-261"><a href="#Substance-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-262"><a href="#Substance-262"><span class="linenos">262</span></a><span class="sd">        Return true if Substance is a liquid.</span>
</span><span id="Substance-263"><a href="#Substance-263"><span class="linenos">263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance-264"><a href="#Substance-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">LIQUID</span>
</span><span id="Substance-265"><a href="#Substance-265"><span class="linenos">265</span></a>
</span><span id="Substance-266"><a href="#Substance-266"><span class="linenos">266</span></a>    <span class="k">def</span> <span class="nf">is_enzyme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance-267"><a href="#Substance-267"><span class="linenos">267</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance-268"><a href="#Substance-268"><span class="linenos">268</span></a><span class="sd">        Return true if Substance is an enzyme.</span>
</span><span id="Substance-269"><a href="#Substance-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance-270"><a href="#Substance-270"><span class="linenos">270</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">ENZYME</span>
</span></pre></div>


            <div class="docstring"><p>An abstract chemical or biological entity (e.g., reagent, enzyme, solvent, etc.). Immutable.
Solids and enzymes are assumed to require zero volume.</p>
</div>


                            <div id="Substance.__init__" class="classattr">
                                        <input id="Substance.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Substance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">mol_type</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">molecule</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Substance.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance.__init__-172"><a href="#Substance.__init__-172"><span class="linenos">172</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_type</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Substance.__init__-173"><a href="#Substance.__init__-173"><span class="linenos">173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance.__init__-174"><a href="#Substance.__init__-174"><span class="linenos">174</span></a><span class="sd">        Create a new substance.</span>
</span><span id="Substance.__init__-175"><a href="#Substance.__init__-175"><span class="linenos">175</span></a>
</span><span id="Substance.__init__-176"><a href="#Substance.__init__-176"><span class="linenos">176</span></a><span class="sd">        Args:</span>
</span><span id="Substance.__init__-177"><a href="#Substance.__init__-177"><span class="linenos">177</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="Substance.__init__-178"><a href="#Substance.__init__-178"><span class="linenos">178</span></a><span class="sd">            mol_type: Substance.LIQUID, Substance.SOLID, or Substance.ENZYME.</span>
</span><span id="Substance.__init__-179"><a href="#Substance.__init__-179"><span class="linenos">179</span></a><span class="sd">            molecule: (optional) A cctk molecule.</span>
</span><span id="Substance.__init__-180"><a href="#Substance.__init__-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance.__init__-181"><a href="#Substance.__init__-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Substance.__init__-182"><a href="#Substance.__init__-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">mol_type</span>
</span><span id="Substance.__init__-183"><a href="#Substance.__init__-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Substance.__init__-184"><a href="#Substance.__init__-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span> <span class="o">=</span> <span class="n">molecule</span>
</span></pre></div>


            <div class="docstring"><p>Create a new substance.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  Name of substance.</li>
<li><strong>mol_type:</strong>  <a href="#Substance.LIQUID">Substance.LIQUID</a>, <a href="#Substance.SOLID">Substance.SOLID</a>, or <a href="#Substance.ENZYME">Substance.ENZYME</a>.</li>
<li><strong>molecule:</strong>  (optional) A cctk molecule.</li>
</ul>
</div>


                            </div>
                            <div id="Substance.SOLID" class="classattr">
                                <div class="attr variable">
            <span class="name">SOLID</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#Substance.SOLID"></a>
    
    

                            </div>
                            <div id="Substance.LIQUID" class="classattr">
                                <div class="attr variable">
            <span class="name">LIQUID</span>        =
<span class="default_value">2</span>

        
    </div>
    <a class="headerlink" href="#Substance.LIQUID"></a>
    
    

                            </div>
                            <div id="Substance.ENZYME" class="classattr">
                                <div class="attr variable">
            <span class="name">ENZYME</span>        =
<span class="default_value">3</span>

        
    </div>
    <a class="headerlink" href="#Substance.ENZYME"></a>
    
    

                            </div>
                            <div id="Substance.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span>

        
    </div>
    <a class="headerlink" href="#Substance.name"></a>
    
    

                            </div>
                            <div id="Substance.molecule" class="classattr">
                                <div class="attr variable">
            <span class="name">molecule</span>

        
    </div>
    <a class="headerlink" href="#Substance.molecule"></a>
    
    

                            </div>
                            <div id="Substance.solid" class="classattr">
                                        <input id="Substance.solid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">solid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">molecule</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>:</span></span>

                <label class="view-source-button" for="Substance.solid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance.solid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance.solid-203"><a href="#Substance.solid-203"><span class="linenos">203</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Substance.solid-204"><a href="#Substance.solid-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">solid</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Substance</span><span class="p">:</span>
</span><span id="Substance.solid-205"><a href="#Substance.solid-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance.solid-206"><a href="#Substance.solid-206"><span class="linenos">206</span></a><span class="sd">        Creates a solid substance.</span>
</span><span id="Substance.solid-207"><a href="#Substance.solid-207"><span class="linenos">207</span></a>
</span><span id="Substance.solid-208"><a href="#Substance.solid-208"><span class="linenos">208</span></a><span class="sd">        Args:</span>
</span><span id="Substance.solid-209"><a href="#Substance.solid-209"><span class="linenos">209</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="Substance.solid-210"><a href="#Substance.solid-210"><span class="linenos">210</span></a><span class="sd">            mol_weight: Molecular weight in g/mol</span>
</span><span id="Substance.solid-211"><a href="#Substance.solid-211"><span class="linenos">211</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="Substance.solid-212"><a href="#Substance.solid-212"><span class="linenos">212</span></a>
</span><span id="Substance.solid-213"><a href="#Substance.solid-213"><span class="linenos">213</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="Substance.solid-214"><a href="#Substance.solid-214"><span class="linenos">214</span></a>
</span><span id="Substance.solid-215"><a href="#Substance.solid-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance.solid-216"><a href="#Substance.solid-216"><span class="linenos">216</span></a>        <span class="n">substance</span> <span class="o">=</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">SOLID</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="Substance.solid-217"><a href="#Substance.solid-217"><span class="linenos">217</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="n">mol_weight</span>
</span><span id="Substance.solid-218"><a href="#Substance.solid-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="n">substance</span>
</span></pre></div>


            <div class="docstring"><p>Creates a solid substance.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  Name of substance.</li>
<li><strong>mol_weight:</strong>  Molecular weight in g/mol</li>
<li><strong>molecule:</strong>  (optional) cctk molecule</li>
</ul>

<p>Returns: New substance.</p>
</div>


                            </div>
                            <div id="Substance.liquid" class="classattr">
                                        <input id="Substance.liquid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">liquid</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">density</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">molecule</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>:</span></span>

                <label class="view-source-button" for="Substance.liquid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance.liquid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance.liquid-220"><a href="#Substance.liquid-220"><span class="linenos">220</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Substance.liquid-221"><a href="#Substance.liquid-221"><span class="linenos">221</span></a>    <span class="k">def</span> <span class="nf">liquid</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mol_weight</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Substance</span><span class="p">:</span>
</span><span id="Substance.liquid-222"><a href="#Substance.liquid-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance.liquid-223"><a href="#Substance.liquid-223"><span class="linenos">223</span></a><span class="sd">        Creates a liquid substance.</span>
</span><span id="Substance.liquid-224"><a href="#Substance.liquid-224"><span class="linenos">224</span></a>
</span><span id="Substance.liquid-225"><a href="#Substance.liquid-225"><span class="linenos">225</span></a><span class="sd">        Args:</span>
</span><span id="Substance.liquid-226"><a href="#Substance.liquid-226"><span class="linenos">226</span></a><span class="sd">            name: Name of substance.</span>
</span><span id="Substance.liquid-227"><a href="#Substance.liquid-227"><span class="linenos">227</span></a><span class="sd">            mol_weight: Molecular weight in g/mol</span>
</span><span id="Substance.liquid-228"><a href="#Substance.liquid-228"><span class="linenos">228</span></a><span class="sd">            density: Density in g/mL</span>
</span><span id="Substance.liquid-229"><a href="#Substance.liquid-229"><span class="linenos">229</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="Substance.liquid-230"><a href="#Substance.liquid-230"><span class="linenos">230</span></a>
</span><span id="Substance.liquid-231"><a href="#Substance.liquid-231"><span class="linenos">231</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="Substance.liquid-232"><a href="#Substance.liquid-232"><span class="linenos">232</span></a>
</span><span id="Substance.liquid-233"><a href="#Substance.liquid-233"><span class="linenos">233</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance.liquid-234"><a href="#Substance.liquid-234"><span class="linenos">234</span></a>        <span class="n">substance</span> <span class="o">=</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">LIQUID</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span><span id="Substance.liquid-235"><a href="#Substance.liquid-235"><span class="linenos">235</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">=</span> <span class="n">mol_weight</span>  <span class="c1"># g / mol</span>
</span><span id="Substance.liquid-236"><a href="#Substance.liquid-236"><span class="linenos">236</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="n">density</span>  <span class="c1"># g / mL</span>
</span><span id="Substance.liquid-237"><a href="#Substance.liquid-237"><span class="linenos">237</span></a>        <span class="n">substance</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">density</span> <span class="o">/</span> <span class="n">mol_weight</span>  <span class="c1"># mol / mL</span>
</span><span id="Substance.liquid-238"><a href="#Substance.liquid-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">substance</span>
</span></pre></div>


            <div class="docstring"><p>Creates a liquid substance.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  Name of substance.</li>
<li><strong>mol_weight:</strong>  Molecular weight in g/mol</li>
<li><strong>density:</strong>  Density in g/mL</li>
<li><strong>molecule:</strong>  (optional) cctk molecule</li>
</ul>

<p>Returns: New substance.</p>
</div>


                            </div>
                            <div id="Substance.enzyme" class="classattr">
                                        <input id="Substance.enzyme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">enzyme</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">molecule</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Substance.enzyme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance.enzyme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance.enzyme-240"><a href="#Substance.enzyme-240"><span class="linenos">240</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Substance.enzyme-241"><a href="#Substance.enzyme-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">enzyme</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Substance.enzyme-242"><a href="#Substance.enzyme-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance.enzyme-243"><a href="#Substance.enzyme-243"><span class="linenos">243</span></a><span class="sd">        Creates an enzyme.</span>
</span><span id="Substance.enzyme-244"><a href="#Substance.enzyme-244"><span class="linenos">244</span></a>
</span><span id="Substance.enzyme-245"><a href="#Substance.enzyme-245"><span class="linenos">245</span></a><span class="sd">        Args:</span>
</span><span id="Substance.enzyme-246"><a href="#Substance.enzyme-246"><span class="linenos">246</span></a><span class="sd">            name: Name of enzyme.</span>
</span><span id="Substance.enzyme-247"><a href="#Substance.enzyme-247"><span class="linenos">247</span></a><span class="sd">            molecule: (optional) cctk molecule</span>
</span><span id="Substance.enzyme-248"><a href="#Substance.enzyme-248"><span class="linenos">248</span></a>
</span><span id="Substance.enzyme-249"><a href="#Substance.enzyme-249"><span class="linenos">249</span></a><span class="sd">        Returns: New substance.</span>
</span><span id="Substance.enzyme-250"><a href="#Substance.enzyme-250"><span class="linenos">250</span></a>
</span><span id="Substance.enzyme-251"><a href="#Substance.enzyme-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance.enzyme-252"><a href="#Substance.enzyme-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="n">Substance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Substance</span><span class="o">.</span><span class="n">ENZYME</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates an enzyme.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  Name of enzyme.</li>
<li><strong>molecule:</strong>  (optional) cctk molecule</li>
</ul>

<p>Returns: New substance.</p>
</div>


                            </div>
                            <div id="Substance.is_solid" class="classattr">
                                        <input id="Substance.is_solid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_solid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Substance.is_solid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance.is_solid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance.is_solid-254"><a href="#Substance.is_solid-254"><span class="linenos">254</span></a>    <span class="k">def</span> <span class="nf">is_solid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance.is_solid-255"><a href="#Substance.is_solid-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance.is_solid-256"><a href="#Substance.is_solid-256"><span class="linenos">256</span></a><span class="sd">        Return true if Substance is a solid.</span>
</span><span id="Substance.is_solid-257"><a href="#Substance.is_solid-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance.is_solid-258"><a href="#Substance.is_solid-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">SOLID</span>
</span></pre></div>


            <div class="docstring"><p>Return true if Substance is a solid.</p>
</div>


                            </div>
                            <div id="Substance.is_liquid" class="classattr">
                                        <input id="Substance.is_liquid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_liquid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Substance.is_liquid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance.is_liquid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance.is_liquid-260"><a href="#Substance.is_liquid-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">is_liquid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance.is_liquid-261"><a href="#Substance.is_liquid-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance.is_liquid-262"><a href="#Substance.is_liquid-262"><span class="linenos">262</span></a><span class="sd">        Return true if Substance is a liquid.</span>
</span><span id="Substance.is_liquid-263"><a href="#Substance.is_liquid-263"><span class="linenos">263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance.is_liquid-264"><a href="#Substance.is_liquid-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">LIQUID</span>
</span></pre></div>


            <div class="docstring"><p>Return true if Substance is a liquid.</p>
</div>


                            </div>
                            <div id="Substance.is_enzyme" class="classattr">
                                        <input id="Substance.is_enzyme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_enzyme</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Substance.is_enzyme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Substance.is_enzyme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Substance.is_enzyme-266"><a href="#Substance.is_enzyme-266"><span class="linenos">266</span></a>    <span class="k">def</span> <span class="nf">is_enzyme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Substance.is_enzyme-267"><a href="#Substance.is_enzyme-267"><span class="linenos">267</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Substance.is_enzyme-268"><a href="#Substance.is_enzyme-268"><span class="linenos">268</span></a><span class="sd">        Return true if Substance is an enzyme.</span>
</span><span id="Substance.is_enzyme-269"><a href="#Substance.is_enzyme-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Substance.is_enzyme-270"><a href="#Substance.is_enzyme-270"><span class="linenos">270</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">Substance</span><span class="o">.</span><span class="n">ENZYME</span>
</span></pre></div>


            <div class="docstring"><p>Return true if Substance is an enzyme.</p>
</div>


                            </div>
                </section>
                <section id="Container">
                            <input id="Container-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Container</span>:

                <label class="view-source-button" for="Container-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Container"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Container-273"><a href="#Container-273"><span class="linenos">273</span></a><span class="k">class</span> <span class="nc">Container</span><span class="p">:</span>
</span><span id="Container-274"><a href="#Container-274"><span class="linenos">274</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-275"><a href="#Container-275"><span class="linenos">275</span></a><span class="sd">    Stores specified quantities of Substances in a vessel with a given maximum volume. Immutable.</span>
</span><span id="Container-276"><a href="#Container-276"><span class="linenos">276</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Container-277"><a href="#Container-277"><span class="linenos">277</span></a>
</span><span id="Container-278"><a href="#Container-278"><span class="linenos">278</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Container-279"><a href="#Container-279"><span class="linenos">279</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-280"><a href="#Container-280"><span class="linenos">280</span></a><span class="sd">        Create a Container.</span>
</span><span id="Container-281"><a href="#Container-281"><span class="linenos">281</span></a>
</span><span id="Container-282"><a href="#Container-282"><span class="linenos">282</span></a><span class="sd">        Args:</span>
</span><span id="Container-283"><a href="#Container-283"><span class="linenos">283</span></a><span class="sd">            name: Name of container</span>
</span><span id="Container-284"><a href="#Container-284"><span class="linenos">284</span></a><span class="sd">            max_volume: Maximum volume that can be stored in the container in mL</span>
</span><span id="Container-285"><a href="#Container-285"><span class="linenos">285</span></a><span class="sd">            initial_contents: (optional) Iterable of tuples of the form (Substance, quantity)</span>
</span><span id="Container-286"><a href="#Container-286"><span class="linenos">286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container-287"><a href="#Container-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Container-288"><a href="#Container-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Substance</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Container-289"><a href="#Container-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Container-290"><a href="#Container-290"><span class="linenos">290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">max_volume</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span>
</span><span id="Container-291"><a href="#Container-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Container-292"><a href="#Container-292"><span class="linenos">292</span></a>            <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span> <span class="ow">in</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Container-293"><a href="#Container-293"><span class="linenos">293</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_self_add</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Container-294"><a href="#Container-294"><span class="linenos">294</span></a>
</span><span id="Container-295"><a href="#Container-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Container</span><span class="p">:</span>
</span><span id="Container-296"><a href="#Container-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-297"><a href="#Container-297"><span class="linenos">297</span></a><span class="sd">        Clones current Container.</span>
</span><span id="Container-298"><a href="#Container-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container-299"><a href="#Container-299"><span class="linenos">299</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">)</span>
</span><span id="Container-300"><a href="#Container-300"><span class="linenos">300</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">contents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container-301"><a href="#Container-301"><span class="linenos">301</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span>
</span><span id="Container-302"><a href="#Container-302"><span class="linenos">302</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span>  <span class="c1"># Don&#39;t readjust this value</span>
</span><span id="Container-303"><a href="#Container-303"><span class="linenos">303</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span><span id="Container-304"><a href="#Container-304"><span class="linenos">304</span></a>
</span><span id="Container-305"><a href="#Container-305"><span class="linenos">305</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Container-306"><a href="#Container-306"><span class="linenos">306</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container-307"><a href="#Container-307"><span class="linenos">307</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Container-308"><a href="#Container-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">contents</span> <span class="ow">and</span> \
</span><span id="Container-309"><a href="#Container-309"><span class="linenos">309</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">volume</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">max_volume</span>
</span><span id="Container-310"><a href="#Container-310"><span class="linenos">310</span></a>
</span><span id="Container-311"><a href="#Container-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Container-312"><a href="#Container-312"><span class="linenos">312</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">,</span> <span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">items</span><span class="p">()))))</span>
</span><span id="Container-313"><a href="#Container-313"><span class="linenos">313</span></a>
</span><span id="Container-314"><a href="#Container-314"><span class="linenos">314</span></a>    <span class="k">def</span> <span class="nf">_self_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Container-315"><a href="#Container-315"><span class="linenos">315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-316"><a href="#Container-316"><span class="linenos">316</span></a>
</span><span id="Container-317"><a href="#Container-317"><span class="linenos">317</span></a><span class="sd">        Adds to current Container, mutating it.</span>
</span><span id="Container-318"><a href="#Container-318"><span class="linenos">318</span></a><span class="sd">        Only to be used in the constructor and immediately after copy</span>
</span><span id="Container-319"><a href="#Container-319"><span class="linenos">319</span></a>
</span><span id="Container-320"><a href="#Container-320"><span class="linenos">320</span></a><span class="sd">        Args:</span>
</span><span id="Container-321"><a href="#Container-321"><span class="linenos">321</span></a><span class="sd">            source: Substance to add.</span>
</span><span id="Container-322"><a href="#Container-322"><span class="linenos">322</span></a><span class="sd">            how_much: How much to add. (&#39;10 mol&#39;)</span>
</span><span id="Container-323"><a href="#Container-323"><span class="linenos">323</span></a>
</span><span id="Container-324"><a href="#Container-324"><span class="linenos">324</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container-325"><a href="#Container-325"><span class="linenos">325</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Container-326"><a href="#Container-326"><span class="linenos">326</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Container-327"><a href="#Container-327"><span class="linenos">327</span></a>        <span class="k">if</span> <span class="n">how_much</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">source</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="Container-328"><a href="#Container-328"><span class="linenos">328</span></a>            <span class="c1"># TODO: molarity from liquids?</span>
</span><span id="Container-329"><a href="#Container-329"><span class="linenos">329</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Molarity solutions can only be made from solids.&quot;</span><span class="p">)</span>
</span><span id="Container-330"><a href="#Container-330"><span class="linenos">330</span></a>        <span class="n">volume</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span>
</span><span id="Container-331"><a href="#Container-331"><span class="linenos">331</span></a>        <span class="n">amount_to_transfer</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_unit_value</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">how_much</span><span class="p">,</span> <span class="n">volume</span><span class="p">),</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-332"><a href="#Container-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">amount_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-333"><a href="#Container-333"><span class="linenos">333</span></a>        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="Container-334"><a href="#Container-334"><span class="linenos">334</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">+</span> <span class="n">amount_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-335"><a href="#Container-335"><span class="linenos">335</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">:</span>
</span><span id="Container-336"><a href="#Container-336"><span class="linenos">336</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Exceeded maximum volume&quot;</span><span class="p">)</span>
</span><span id="Container-337"><a href="#Container-337"><span class="linenos">337</span></a>
</span><span id="Container-338"><a href="#Container-338"><span class="linenos">338</span></a>    <span class="k">def</span> <span class="nf">_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_container</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Container-339"><a href="#Container-339"><span class="linenos">339</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; transfer volume (&#39;10 mL&#39;) from container to self &quot;&quot;&quot;</span>
</span><span id="Container-340"><a href="#Container-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_container</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container-341"><a href="#Container-341"><span class="linenos">341</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Container-342"><a href="#Container-342"><span class="linenos">342</span></a>        <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">extract_value_unit</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Container-343"><a href="#Container-343"><span class="linenos">343</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)</span>
</span><span id="Container-344"><a href="#Container-344"><span class="linenos">344</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-345"><a href="#Container-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="o">!=</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="Container-346"><a href="#Container-346"><span class="linenos">346</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;We can only transfer liquid from other containers.&quot;</span><span class="p">)</span>
</span><span id="Container-347"><a href="#Container-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">volume_to_transfer</span> <span class="o">&gt;</span> <span class="n">source_container</span><span class="o">.</span><span class="n">volume</span><span class="p">:</span>
</span><span id="Container-348"><a href="#Container-348"><span class="linenos">348</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not enough mixture left in source container.&quot;</span> <span class="o">+</span>
</span><span id="Container-349"><a href="#Container-349"><span class="linenos">349</span></a>                             <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mL&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> mL &quot;</span>
</span><span id="Container-350"><a href="#Container-350"><span class="linenos">350</span></a>                             <span class="sa">f</span><span class="s2">&quot; needed of </span><span class="si">{</span><span class="n">source_container</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span>
</span><span id="Container-351"><a href="#Container-351"><span class="linenos">351</span></a>                             <span class="sa">f</span><span class="s2">&quot; out of </span><span class="si">{</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">source_container</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mL&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> mL.&quot;</span><span class="p">)</span>
</span><span id="Container-352"><a href="#Container-352"><span class="linenos">352</span></a>        <span class="n">source_container</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">source_container</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container-353"><a href="#Container-353"><span class="linenos">353</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">volume_to_transfer</span> <span class="o">/</span> <span class="n">source_container</span><span class="o">.</span><span class="n">volume</span>
</span><span id="Container-354"><a href="#Container-354"><span class="linenos">354</span></a>        <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">source_container</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Container-355"><a href="#Container-355"><span class="linenos">355</span></a>            <span class="n">to</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">amount</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-356"><a href="#Container-356"><span class="linenos">356</span></a>            <span class="n">source_container</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_container</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">]</span> <span class="o">-</span> <span class="n">amount</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">,</span>
</span><span id="Container-357"><a href="#Container-357"><span class="linenos">357</span></a>                                                         <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-358"><a href="#Container-358"><span class="linenos">358</span></a>        <span class="n">to</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">volume</span> <span class="o">+</span> <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-359"><a href="#Container-359"><span class="linenos">359</span></a>        <span class="k">if</span> <span class="n">to</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="n">to</span><span class="o">.</span><span class="n">max_volume</span><span class="p">:</span>
</span><span id="Container-360"><a href="#Container-360"><span class="linenos">360</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exceeded maximum volume in </span><span class="si">{</span><span class="n">to</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="Container-361"><a href="#Container-361"><span class="linenos">361</span></a>        <span class="n">source_container</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_container</span><span class="o">.</span><span class="n">volume</span> <span class="o">-</span> <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-362"><a href="#Container-362"><span class="linenos">362</span></a>        <span class="k">return</span> <span class="n">source_container</span><span class="p">,</span> <span class="n">to</span>
</span><span id="Container-363"><a href="#Container-363"><span class="linenos">363</span></a>
</span><span id="Container-364"><a href="#Container-364"><span class="linenos">364</span></a>    <span class="k">def</span> <span class="nf">_transfer_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="Container-365"><a href="#Container-365"><span class="linenos">365</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-366"><a href="#Container-366"><span class="linenos">366</span></a><span class="sd">        Transfer volume (&#39;10 mL&#39;) from slice to self</span>
</span><span id="Container-367"><a href="#Container-367"><span class="linenos">367</span></a>
</span><span id="Container-368"><a href="#Container-368"><span class="linenos">368</span></a><span class="sd">        Returns:</span>
</span><span id="Container-369"><a href="#Container-369"><span class="linenos">369</span></a><span class="sd">            A tuple of a new plate and a new container, both modified.</span>
</span><span id="Container-370"><a href="#Container-370"><span class="linenos">370</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container-371"><a href="#Container-371"><span class="linenos">371</span></a>
</span><span id="Container-372"><a href="#Container-372"><span class="linenos">372</span></a>        <span class="k">def</span> <span class="nf">helper_func</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="Container-373"><a href="#Container-373"><span class="linenos">373</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot; Moves volume from elem to to_array[0]&quot;&quot;&quot;</span>
</span><span id="Container-374"><a href="#Container-374"><span class="linenos">374</span></a>            <span class="n">elem</span><span class="p">,</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="Container-375"><a href="#Container-375"><span class="linenos">375</span></a>            <span class="k">return</span> <span class="n">elem</span>
</span><span id="Container-376"><a href="#Container-376"><span class="linenos">376</span></a>
</span><span id="Container-377"><a href="#Container-377"><span class="linenos">377</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_slice</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Container-378"><a href="#Container-378"><span class="linenos">378</span></a>            <span class="n">source_slice</span> <span class="o">=</span> <span class="n">source_slice</span><span class="p">[:]</span>
</span><span id="Container-379"><a href="#Container-379"><span class="linenos">379</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_slice</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Container-380"><a href="#Container-380"><span class="linenos">380</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Container-381"><a href="#Container-381"><span class="linenos">381</span></a>        <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container-382"><a href="#Container-382"><span class="linenos">382</span></a>        <span class="n">source_slice</span> <span class="o">=</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container-383"><a href="#Container-383"><span class="linenos">383</span></a>        <span class="n">source_slice</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">plate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container-384"><a href="#Container-384"><span class="linenos">384</span></a>        <span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">extract_value_unit</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Container-385"><a href="#Container-385"><span class="linenos">385</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)</span>
</span><span id="Container-386"><a href="#Container-386"><span class="linenos">386</span></a>        <span class="c1"># volume_to_transfer *= 1000.0  # convert L to mL</span>
</span><span id="Container-387"><a href="#Container-387"><span class="linenos">387</span></a>        <span class="n">volume_to_transfer</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">volume_to_transfer</span><span class="p">,</span> <span class="n">INTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-388"><a href="#Container-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="o">!=</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="Container-389"><a href="#Container-389"><span class="linenos">389</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;We can only transfer liquid from other containers.&quot;</span><span class="p">)</span>
</span><span id="Container-390"><a href="#Container-390"><span class="linenos">390</span></a>        <span class="k">if</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">volume_to_transfer</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">-</span> <span class="n">to</span><span class="o">.</span><span class="n">volume</span><span class="p">):</span>
</span><span id="Container-391"><a href="#Container-391"><span class="linenos">391</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not enough room left in destination container.&quot;</span><span class="p">)</span>
</span><span id="Container-392"><a href="#Container-392"><span class="linenos">392</span></a>
</span><span id="Container-393"><a href="#Container-393"><span class="linenos">393</span></a>        <span class="n">to_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">to</span><span class="p">]</span>
</span><span id="Container-394"><a href="#Container-394"><span class="linenos">394</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper_func</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">source_slice</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span><span id="Container-395"><a href="#Container-395"><span class="linenos">395</span></a>        <span class="n">source_slice</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="Container-396"><a href="#Container-396"><span class="linenos">396</span></a>        <span class="k">return</span> <span class="n">source_slice</span><span class="o">.</span><span class="n">plate</span><span class="p">,</span> <span class="n">to_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Container-397"><a href="#Container-397"><span class="linenos">397</span></a>
</span><span id="Container-398"><a href="#Container-398"><span class="linenos">398</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Container-399"><a href="#Container-399"><span class="linenos">399</span></a>        <span class="n">max_volume</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)))</span> \
</span><span id="Container-400"><a href="#Container-400"><span class="linenos">400</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
</span><span id="Container-401"><a href="#Container-401"><span class="linenos">401</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Container (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">) (</span><span class="si">{</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mL&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
</span><span id="Container-402"><a href="#Container-402"><span class="linenos">402</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_volume</span><span class="si">}</span><span class="s2"> of (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Container-403"><a href="#Container-403"><span class="linenos">403</span></a>
</span><span id="Container-404"><a href="#Container-404"><span class="linenos">404</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Container-405"><a href="#Container-405"><span class="linenos">405</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Container</span><span class="p">:</span>
</span><span id="Container-406"><a href="#Container-406"><span class="linenos">406</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-407"><a href="#Container-407"><span class="linenos">407</span></a><span class="sd">        Move the given quantity (&#39;10 mol&#39;) of the source substance to the destination container.</span>
</span><span id="Container-408"><a href="#Container-408"><span class="linenos">408</span></a>
</span><span id="Container-409"><a href="#Container-409"><span class="linenos">409</span></a><span class="sd">        Returns:</span>
</span><span id="Container-410"><a href="#Container-410"><span class="linenos">410</span></a><span class="sd">            A new copy of destination.</span>
</span><span id="Container-411"><a href="#Container-411"><span class="linenos">411</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container-412"><a href="#Container-412"><span class="linenos">412</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container-413"><a href="#Container-413"><span class="linenos">413</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Container.add to add to a Container&quot;</span><span class="p">)</span>
</span><span id="Container-414"><a href="#Container-414"><span class="linenos">414</span></a>        <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container-415"><a href="#Container-415"><span class="linenos">415</span></a>        <span class="n">destination</span><span class="o">.</span><span class="n">_self_add</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Container-416"><a href="#Container-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="n">destination</span>
</span><span id="Container-417"><a href="#Container-417"><span class="linenos">417</span></a>
</span><span id="Container-418"><a href="#Container-418"><span class="linenos">418</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Container-419"><a href="#Container-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="Container-420"><a href="#Container-420"><span class="linenos">420</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-421"><a href="#Container-421"><span class="linenos">421</span></a><span class="sd">        Move volume (&#39;10 mL&#39;) from source to destination container,</span>
</span><span id="Container-422"><a href="#Container-422"><span class="linenos">422</span></a><span class="sd">        returning copies of the objects with amounts adjusted accordingly.</span>
</span><span id="Container-423"><a href="#Container-423"><span class="linenos">423</span></a>
</span><span id="Container-424"><a href="#Container-424"><span class="linenos">424</span></a><span class="sd">        Returns:</span>
</span><span id="Container-425"><a href="#Container-425"><span class="linenos">425</span></a><span class="sd">            A tuple of (T, Container) where T is the type of the source.</span>
</span><span id="Container-426"><a href="#Container-426"><span class="linenos">426</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container-427"><a href="#Container-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container-428"><a href="#Container-428"><span class="linenos">428</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Container.transfer into a Container&quot;</span><span class="p">)</span>
</span><span id="Container-429"><a href="#Container-429"><span class="linenos">429</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container-430"><a href="#Container-430"><span class="linenos">430</span></a>            <span class="k">return</span> <span class="n">destination</span><span class="o">.</span><span class="n">_transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="Container-431"><a href="#Container-431"><span class="linenos">431</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Container-432"><a href="#Container-432"><span class="linenos">432</span></a>            <span class="k">return</span> <span class="n">destination</span><span class="o">.</span><span class="n">_transfer_slice</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="Container-433"><a href="#Container-433"><span class="linenos">433</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Container-434"><a href="#Container-434"><span class="linenos">434</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Container-435"><a href="#Container-435"><span class="linenos">435</span></a>
</span><span id="Container-436"><a href="#Container-436"><span class="linenos">436</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Container-437"><a href="#Container-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">create_stock_solution</span><span class="p">(</span><span class="n">what</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">solvent</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Container-438"><a href="#Container-438"><span class="linenos">438</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container-439"><a href="#Container-439"><span class="linenos">439</span></a><span class="sd">        Create a stock solution.</span>
</span><span id="Container-440"><a href="#Container-440"><span class="linenos">440</span></a>
</span><span id="Container-441"><a href="#Container-441"><span class="linenos">441</span></a><span class="sd">        Args:</span>
</span><span id="Container-442"><a href="#Container-442"><span class="linenos">442</span></a><span class="sd">            what: What to dilute.</span>
</span><span id="Container-443"><a href="#Container-443"><span class="linenos">443</span></a><span class="sd">            concentration: Desired concentration in mol/L</span>
</span><span id="Container-444"><a href="#Container-444"><span class="linenos">444</span></a><span class="sd">            solvent: What to dilute with.</span>
</span><span id="Container-445"><a href="#Container-445"><span class="linenos">445</span></a><span class="sd">            volume: Desired total volume in mL.</span>
</span><span id="Container-446"><a href="#Container-446"><span class="linenos">446</span></a>
</span><span id="Container-447"><a href="#Container-447"><span class="linenos">447</span></a><span class="sd">        Returns:</span>
</span><span id="Container-448"><a href="#Container-448"><span class="linenos">448</span></a><span class="sd">            New container with desired solution.</span>
</span><span id="Container-449"><a href="#Container-449"><span class="linenos">449</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container-450"><a href="#Container-450"><span class="linenos">450</span></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">what</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">concentration</span><span class="si">:</span><span class="s2">.2</span><span class="si">}</span><span class="s2">M&quot;</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Container-451"><a href="#Container-451"><span class="linenos">451</span></a>        <span class="n">moles_to_add</span> <span class="o">=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">concentration</span>
</span><span id="Container-452"><a href="#Container-452"><span class="linenos">452</span></a>        <span class="k">if</span> <span class="n">what</span><span class="o">.</span><span class="n">is_enzyme</span><span class="p">():</span>
</span><span id="Container-453"><a href="#Container-453"><span class="linenos">453</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can&#39;t add enzymes by molarity.&quot;</span><span class="p">)</span>
</span><span id="Container-454"><a href="#Container-454"><span class="linenos">454</span></a>        <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="Container-455"><a href="#Container-455"><span class="linenos">455</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">solvent</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="Container-456"><a href="#Container-456"><span class="linenos">456</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">moles_to_add</span><span class="p">,</span><span class="w"> </span><span class="n">INTERNAL_PRECISION</span><span class="p">)</span><span class="si">}</span><span class="s2"> mol&quot;</span><span class="p">)</span>
</span><span id="Container-457"><a href="#Container-457"><span class="linenos">457</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Liquid</span>
</span><span id="Container-458"><a href="#Container-458"><span class="linenos">458</span></a>            <span class="n">volume_to_add</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">moles_to_add</span> <span class="o">*</span> <span class="n">what</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">/</span> <span class="p">(</span><span class="n">what</span><span class="o">.</span><span class="n">density</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container-459"><a href="#Container-459"><span class="linenos">459</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">solvent</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">volume_to_add</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="Container-460"><a href="#Container-460"><span class="linenos">460</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume_to_add</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="Container-461"><a href="#Container-461"><span class="linenos">461</span></a>        <span class="k">return</span> <span class="n">container</span>
</span></pre></div>


            <div class="docstring"><p>Stores specified quantities of Substances in a vessel with a given maximum volume. Immutable.</p>
</div>


                            <div id="Container.__init__" class="classattr">
                                        <input id="Container.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Container</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span>, </span><span class="param"><span class="n">max_volume</span><span class="o">=</span><span class="n">inf</span>, </span><span class="param"><span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Container.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Container.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Container.__init__-278"><a href="#Container.__init__-278"><span class="linenos">278</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Container.__init__-279"><a href="#Container.__init__-279"><span class="linenos">279</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container.__init__-280"><a href="#Container.__init__-280"><span class="linenos">280</span></a><span class="sd">        Create a Container.</span>
</span><span id="Container.__init__-281"><a href="#Container.__init__-281"><span class="linenos">281</span></a>
</span><span id="Container.__init__-282"><a href="#Container.__init__-282"><span class="linenos">282</span></a><span class="sd">        Args:</span>
</span><span id="Container.__init__-283"><a href="#Container.__init__-283"><span class="linenos">283</span></a><span class="sd">            name: Name of container</span>
</span><span id="Container.__init__-284"><a href="#Container.__init__-284"><span class="linenos">284</span></a><span class="sd">            max_volume: Maximum volume that can be stored in the container in mL</span>
</span><span id="Container.__init__-285"><a href="#Container.__init__-285"><span class="linenos">285</span></a><span class="sd">            initial_contents: (optional) Iterable of tuples of the form (Substance, quantity)</span>
</span><span id="Container.__init__-286"><a href="#Container.__init__-286"><span class="linenos">286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container.__init__-287"><a href="#Container.__init__-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Container.__init__-288"><a href="#Container.__init__-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Substance</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Container.__init__-289"><a href="#Container.__init__-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Container.__init__-290"><a href="#Container.__init__-290"><span class="linenos">290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">max_volume</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span>
</span><span id="Container.__init__-291"><a href="#Container.__init__-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Container.__init__-292"><a href="#Container.__init__-292"><span class="linenos">292</span></a>            <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span> <span class="ow">in</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Container.__init__-293"><a href="#Container.__init__-293"><span class="linenos">293</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_self_add</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a Container.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  Name of container</li>
<li><strong>max_volume:</strong>  Maximum volume that can be stored in the container in mL</li>
<li><strong>initial_contents:</strong>  (optional) Iterable of tuples of the form (Substance, quantity)</li>
</ul>
</div>


                            </div>
                            <div id="Container.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span>

        
    </div>
    <a class="headerlink" href="#Container.name"></a>
    
    

                            </div>
                            <div id="Container.contents" class="classattr">
                                <div class="attr variable">
            <span class="name">contents</span><span class="annotation">: Dict[<a href="#Substance">pyplate.pyplate.Substance</a>, float]</span>

        
    </div>
    <a class="headerlink" href="#Container.contents"></a>
    
    

                            </div>
                            <div id="Container.volume" class="classattr">
                                <div class="attr variable">
            <span class="name">volume</span>

        
    </div>
    <a class="headerlink" href="#Container.volume"></a>
    
    

                            </div>
                            <div id="Container.max_volume" class="classattr">
                                <div class="attr variable">
            <span class="name">max_volume</span>

        
    </div>
    <a class="headerlink" href="#Container.max_volume"></a>
    
    

                            </div>
                            <div id="Container.copy" class="classattr">
                                        <input id="Container.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#Container">pyplate.pyplate.Container</a></span>:</span></span>

                <label class="view-source-button" for="Container.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Container.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Container.copy-295"><a href="#Container.copy-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Container</span><span class="p">:</span>
</span><span id="Container.copy-296"><a href="#Container.copy-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container.copy-297"><a href="#Container.copy-297"><span class="linenos">297</span></a><span class="sd">        Clones current Container.</span>
</span><span id="Container.copy-298"><a href="#Container.copy-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container.copy-299"><a href="#Container.copy-299"><span class="linenos">299</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span><span class="p">)</span>
</span><span id="Container.copy-300"><a href="#Container.copy-300"><span class="linenos">300</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">contents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container.copy-301"><a href="#Container.copy-301"><span class="linenos">301</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span>
</span><span id="Container.copy-302"><a href="#Container.copy-302"><span class="linenos">302</span></a>        <span class="n">new_container</span><span class="o">.</span><span class="n">max_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume</span>  <span class="c1"># Don&#39;t readjust this value</span>
</span><span id="Container.copy-303"><a href="#Container.copy-303"><span class="linenos">303</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span></pre></div>


            <div class="docstring"><p>Clones current Container.</p>
</div>


                            </div>
                            <div id="Container.add" class="classattr">
                                        <input id="Container.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>,</span><span class="param">	<span class="n">destination</span><span class="p">:</span> <span class="n"><a href="#Container">pyplate.pyplate.Container</a></span>,</span><span class="param">	<span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n"><a href="#Container">pyplate.pyplate.Container</a></span>:</span></span>

                <label class="view-source-button" for="Container.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Container.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Container.add-404"><a href="#Container.add-404"><span class="linenos">404</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Container.add-405"><a href="#Container.add-405"><span class="linenos">405</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">how_much</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Container</span><span class="p">:</span>
</span><span id="Container.add-406"><a href="#Container.add-406"><span class="linenos">406</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container.add-407"><a href="#Container.add-407"><span class="linenos">407</span></a><span class="sd">        Move the given quantity (&#39;10 mol&#39;) of the source substance to the destination container.</span>
</span><span id="Container.add-408"><a href="#Container.add-408"><span class="linenos">408</span></a>
</span><span id="Container.add-409"><a href="#Container.add-409"><span class="linenos">409</span></a><span class="sd">        Returns:</span>
</span><span id="Container.add-410"><a href="#Container.add-410"><span class="linenos">410</span></a><span class="sd">            A new copy of destination.</span>
</span><span id="Container.add-411"><a href="#Container.add-411"><span class="linenos">411</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container.add-412"><a href="#Container.add-412"><span class="linenos">412</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container.add-413"><a href="#Container.add-413"><span class="linenos">413</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Container.add to add to a Container&quot;</span><span class="p">)</span>
</span><span id="Container.add-414"><a href="#Container.add-414"><span class="linenos">414</span></a>        <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Container.add-415"><a href="#Container.add-415"><span class="linenos">415</span></a>        <span class="n">destination</span><span class="o">.</span><span class="n">_self_add</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Container.add-416"><a href="#Container.add-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="n">destination</span>
</span></pre></div>


            <div class="docstring"><p>Move the given quantity ('10 mol') of the source substance to the destination container.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new copy of destination.</p>
</blockquote>
</div>


                            </div>
                            <div id="Container.transfer" class="classattr">
                                        <input id="Container.transfer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">transfer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">source</span>, </span><span class="param"><span class="n">destination</span><span class="p">:</span> <span class="n"><a href="#Container">pyplate.pyplate.Container</a></span>, </span><span class="param"><span class="n">volume</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Container.transfer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Container.transfer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Container.transfer-418"><a href="#Container.transfer-418"><span class="linenos">418</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Container.transfer-419"><a href="#Container.transfer-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="Container.transfer-420"><a href="#Container.transfer-420"><span class="linenos">420</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container.transfer-421"><a href="#Container.transfer-421"><span class="linenos">421</span></a><span class="sd">        Move volume (&#39;10 mL&#39;) from source to destination container,</span>
</span><span id="Container.transfer-422"><a href="#Container.transfer-422"><span class="linenos">422</span></a><span class="sd">        returning copies of the objects with amounts adjusted accordingly.</span>
</span><span id="Container.transfer-423"><a href="#Container.transfer-423"><span class="linenos">423</span></a>
</span><span id="Container.transfer-424"><a href="#Container.transfer-424"><span class="linenos">424</span></a><span class="sd">        Returns:</span>
</span><span id="Container.transfer-425"><a href="#Container.transfer-425"><span class="linenos">425</span></a><span class="sd">            A tuple of (T, Container) where T is the type of the source.</span>
</span><span id="Container.transfer-426"><a href="#Container.transfer-426"><span class="linenos">426</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container.transfer-427"><a href="#Container.transfer-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container.transfer-428"><a href="#Container.transfer-428"><span class="linenos">428</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Container.transfer into a Container&quot;</span><span class="p">)</span>
</span><span id="Container.transfer-429"><a href="#Container.transfer-429"><span class="linenos">429</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Container.transfer-430"><a href="#Container.transfer-430"><span class="linenos">430</span></a>            <span class="k">return</span> <span class="n">destination</span><span class="o">.</span><span class="n">_transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="Container.transfer-431"><a href="#Container.transfer-431"><span class="linenos">431</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Container.transfer-432"><a href="#Container.transfer-432"><span class="linenos">432</span></a>            <span class="k">return</span> <span class="n">destination</span><span class="o">.</span><span class="n">_transfer_slice</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="Container.transfer-433"><a href="#Container.transfer-433"><span class="linenos">433</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Container.transfer-434"><a href="#Container.transfer-434"><span class="linenos">434</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Move volume ('10 mL') from source to destination container,
returning copies of the objects with amounts adjusted accordingly.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple of (T, Container) where T is the type of the source.</p>
</blockquote>
</div>


                            </div>
                            <div id="Container.create_stock_solution" class="classattr">
                                        <input id="Container.create_stock_solution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">create_stock_solution</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">what</span><span class="p">:</span> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>,</span><span class="param">	<span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">solvent</span><span class="p">:</span> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Container.create_stock_solution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Container.create_stock_solution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Container.create_stock_solution-436"><a href="#Container.create_stock_solution-436"><span class="linenos">436</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Container.create_stock_solution-437"><a href="#Container.create_stock_solution-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">create_stock_solution</span><span class="p">(</span><span class="n">what</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">solvent</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Container.create_stock_solution-438"><a href="#Container.create_stock_solution-438"><span class="linenos">438</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Container.create_stock_solution-439"><a href="#Container.create_stock_solution-439"><span class="linenos">439</span></a><span class="sd">        Create a stock solution.</span>
</span><span id="Container.create_stock_solution-440"><a href="#Container.create_stock_solution-440"><span class="linenos">440</span></a>
</span><span id="Container.create_stock_solution-441"><a href="#Container.create_stock_solution-441"><span class="linenos">441</span></a><span class="sd">        Args:</span>
</span><span id="Container.create_stock_solution-442"><a href="#Container.create_stock_solution-442"><span class="linenos">442</span></a><span class="sd">            what: What to dilute.</span>
</span><span id="Container.create_stock_solution-443"><a href="#Container.create_stock_solution-443"><span class="linenos">443</span></a><span class="sd">            concentration: Desired concentration in mol/L</span>
</span><span id="Container.create_stock_solution-444"><a href="#Container.create_stock_solution-444"><span class="linenos">444</span></a><span class="sd">            solvent: What to dilute with.</span>
</span><span id="Container.create_stock_solution-445"><a href="#Container.create_stock_solution-445"><span class="linenos">445</span></a><span class="sd">            volume: Desired total volume in mL.</span>
</span><span id="Container.create_stock_solution-446"><a href="#Container.create_stock_solution-446"><span class="linenos">446</span></a>
</span><span id="Container.create_stock_solution-447"><a href="#Container.create_stock_solution-447"><span class="linenos">447</span></a><span class="sd">        Returns:</span>
</span><span id="Container.create_stock_solution-448"><a href="#Container.create_stock_solution-448"><span class="linenos">448</span></a><span class="sd">            New container with desired solution.</span>
</span><span id="Container.create_stock_solution-449"><a href="#Container.create_stock_solution-449"><span class="linenos">449</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Container.create_stock_solution-450"><a href="#Container.create_stock_solution-450"><span class="linenos">450</span></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">what</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">concentration</span><span class="si">:</span><span class="s2">.2</span><span class="si">}</span><span class="s2">M&quot;</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Container.create_stock_solution-451"><a href="#Container.create_stock_solution-451"><span class="linenos">451</span></a>        <span class="n">moles_to_add</span> <span class="o">=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">concentration</span>
</span><span id="Container.create_stock_solution-452"><a href="#Container.create_stock_solution-452"><span class="linenos">452</span></a>        <span class="k">if</span> <span class="n">what</span><span class="o">.</span><span class="n">is_enzyme</span><span class="p">():</span>
</span><span id="Container.create_stock_solution-453"><a href="#Container.create_stock_solution-453"><span class="linenos">453</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can&#39;t add enzymes by molarity.&quot;</span><span class="p">)</span>
</span><span id="Container.create_stock_solution-454"><a href="#Container.create_stock_solution-454"><span class="linenos">454</span></a>        <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="Container.create_stock_solution-455"><a href="#Container.create_stock_solution-455"><span class="linenos">455</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">solvent</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="Container.create_stock_solution-456"><a href="#Container.create_stock_solution-456"><span class="linenos">456</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">moles_to_add</span><span class="p">,</span><span class="w"> </span><span class="n">INTERNAL_PRECISION</span><span class="p">)</span><span class="si">}</span><span class="s2"> mol&quot;</span><span class="p">)</span>
</span><span id="Container.create_stock_solution-457"><a href="#Container.create_stock_solution-457"><span class="linenos">457</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Liquid</span>
</span><span id="Container.create_stock_solution-458"><a href="#Container.create_stock_solution-458"><span class="linenos">458</span></a>            <span class="n">volume_to_add</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">moles_to_add</span> <span class="o">*</span> <span class="n">what</span><span class="o">.</span><span class="n">mol_weight</span> <span class="o">/</span> <span class="p">(</span><span class="n">what</span><span class="o">.</span><span class="n">density</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Container.create_stock_solution-459"><a href="#Container.create_stock_solution-459"><span class="linenos">459</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">solvent</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">volume_to_add</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="Container.create_stock_solution-460"><a href="#Container.create_stock_solution-460"><span class="linenos">460</span></a>            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume_to_add</span><span class="si">}</span><span class="s2"> mL&quot;</span><span class="p">)</span>
</span><span id="Container.create_stock_solution-461"><a href="#Container.create_stock_solution-461"><span class="linenos">461</span></a>        <span class="k">return</span> <span class="n">container</span>
</span></pre></div>


            <div class="docstring"><p>Create a stock solution.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>what:</strong>  What to dilute.</li>
<li><strong>concentration:</strong>  Desired concentration in mol/L</li>
<li><strong>solvent:</strong>  What to dilute with.</li>
<li><strong>volume:</strong>  Desired total volume in mL.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>New container with desired solution.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Plate">
                            <input id="Plate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Plate</span>:

                <label class="view-source-button" for="Plate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate-464"><a href="#Plate-464"><span class="linenos">464</span></a><span class="k">class</span> <span class="nc">Plate</span><span class="p">:</span>
</span><span id="Plate-465"><a href="#Plate-465"><span class="linenos">465</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-466"><a href="#Plate-466"><span class="linenos">466</span></a><span class="sd">    A spatially ordered collection of Containers, like a 96 well plate.</span>
</span><span id="Plate-467"><a href="#Plate-467"><span class="linenos">467</span></a><span class="sd">    The spatial arrangement must be rectangular. Immutable.</span>
</span><span id="Plate-468"><a href="#Plate-468"><span class="linenos">468</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Plate-469"><a href="#Plate-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_volume_per_well</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">make</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;generic&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
</span><span id="Plate-470"><a href="#Plate-470"><span class="linenos">470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-471"><a href="#Plate-471"><span class="linenos">471</span></a><span class="sd">            Creates a generic plate.</span>
</span><span id="Plate-472"><a href="#Plate-472"><span class="linenos">472</span></a>
</span><span id="Plate-473"><a href="#Plate-473"><span class="linenos">473</span></a><span class="sd">            Attributes:</span>
</span><span id="Plate-474"><a href="#Plate-474"><span class="linenos">474</span></a><span class="sd">                name: name of plate</span>
</span><span id="Plate-475"><a href="#Plate-475"><span class="linenos">475</span></a><span class="sd">                max_volume_per_well: maximum volume of each well in uL</span>
</span><span id="Plate-476"><a href="#Plate-476"><span class="linenos">476</span></a><span class="sd">                make: name of this kind of plate</span>
</span><span id="Plate-477"><a href="#Plate-477"><span class="linenos">477</span></a><span class="sd">                rows (int or list): number of rows or list of names of rows</span>
</span><span id="Plate-478"><a href="#Plate-478"><span class="linenos">478</span></a><span class="sd">                columns (int or list): number of columns or list of names of columns</span>
</span><span id="Plate-479"><a href="#Plate-479"><span class="linenos">479</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-480"><a href="#Plate-480"><span class="linenos">480</span></a>
</span><span id="Plate-481"><a href="#Plate-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-482"><a href="#Plate-482"><span class="linenos">482</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid plate name&quot;</span><span class="p">)</span>
</span><span id="Plate-483"><a href="#Plate-483"><span class="linenos">483</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Plate-484"><a href="#Plate-484"><span class="linenos">484</span></a>
</span><span id="Plate-485"><a href="#Plate-485"><span class="linenos">485</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">make</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">make</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-486"><a href="#Plate-486"><span class="linenos">486</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid plate make&quot;</span><span class="p">)</span>
</span><span id="Plate-487"><a href="#Plate-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">make</span> <span class="o">=</span> <span class="n">make</span>
</span><span id="Plate-488"><a href="#Plate-488"><span class="linenos">488</span></a>
</span><span id="Plate-489"><a href="#Plate-489"><span class="linenos">489</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Plate-490"><a href="#Plate-490"><span class="linenos">490</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Plate-491"><a href="#Plate-491"><span class="linenos">491</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;illegal number of rows&quot;</span><span class="p">)</span>
</span><span id="Plate-492"><a href="#Plate-492"><span class="linenos">492</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="n">rows</span>
</span><span id="Plate-493"><a href="#Plate-493"><span class="linenos">493</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Plate-494"><a href="#Plate-494"><span class="linenos">494</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Plate-495"><a href="#Plate-495"><span class="linenos">495</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Plate-496"><a href="#Plate-496"><span class="linenos">496</span></a>                <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-497"><a href="#Plate-497"><span class="linenos">497</span></a>                    <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Plate-498"><a href="#Plate-498"><span class="linenos">498</span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">26</span><span class="p">))</span>
</span><span id="Plate-499"><a href="#Plate-499"><span class="linenos">499</span></a>                    <span class="n">n</span> <span class="o">//=</span> <span class="mi">26</span>
</span><span id="Plate-500"><a href="#Plate-500"><span class="linenos">500</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
</span><span id="Plate-501"><a href="#Plate-501"><span class="linenos">501</span></a>            <span class="c1"># self.row_names = [f&quot;{i + 1}&quot; for i in range(rows)]</span>
</span><span id="Plate-502"><a href="#Plate-502"><span class="linenos">502</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plate-503"><a href="#Plate-503"><span class="linenos">503</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-504"><a href="#Plate-504"><span class="linenos">504</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must have at least one row&quot;</span><span class="p">)</span>
</span><span id="Plate-505"><a href="#Plate-505"><span class="linenos">505</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="Plate-506"><a href="#Plate-506"><span class="linenos">506</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Plate-507"><a href="#Plate-507"><span class="linenos">507</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;row names must be strings&quot;</span><span class="p">)</span>
</span><span id="Plate-508"><a href="#Plate-508"><span class="linenos">508</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-509"><a href="#Plate-509"><span class="linenos">509</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate-510"><a href="#Plate-510"><span class="linenos">510</span></a>                        <span class="s2">&quot;zero length strings are not allowed as column labels&quot;</span>
</span><span id="Plate-511"><a href="#Plate-511"><span class="linenos">511</span></a>                    <span class="p">)</span>
</span><span id="Plate-512"><a href="#Plate-512"><span class="linenos">512</span></a>                <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
</span><span id="Plate-513"><a href="#Plate-513"><span class="linenos">513</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate-514"><a href="#Plate-514"><span class="linenos">514</span></a>                        <span class="sa">f</span><span class="s2">&quot;please don&#39;t confuse me with row names that are integers (</span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Plate-515"><a href="#Plate-515"><span class="linenos">515</span></a>                    <span class="p">)</span>
</span><span id="Plate-516"><a href="#Plate-516"><span class="linenos">516</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rows</span><span class="p">)):</span>
</span><span id="Plate-517"><a href="#Plate-517"><span class="linenos">517</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;duplicate row names found&quot;</span><span class="p">)</span>
</span><span id="Plate-518"><a href="#Plate-518"><span class="linenos">518</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</span><span id="Plate-519"><a href="#Plate-519"><span class="linenos">519</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="o">=</span> <span class="n">rows</span>
</span><span id="Plate-520"><a href="#Plate-520"><span class="linenos">520</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plate-521"><a href="#Plate-521"><span class="linenos">521</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;rows must be int or list&quot;</span><span class="p">)</span>
</span><span id="Plate-522"><a href="#Plate-522"><span class="linenos">522</span></a>
</span><span id="Plate-523"><a href="#Plate-523"><span class="linenos">523</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Plate-524"><a href="#Plate-524"><span class="linenos">524</span></a>            <span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_volume_per_well</span><span class="p">)</span>
</span><span id="Plate-525"><a href="#Plate-525"><span class="linenos">525</span></a>            <span class="k">if</span> <span class="n">max_volume_per_well</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-526"><a href="#Plate-526"><span class="linenos">526</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max volume per well must be greater than zero&quot;</span><span class="p">)</span>
</span><span id="Plate-527"><a href="#Plate-527"><span class="linenos">527</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="s1">&#39;uL&#39;</span><span class="p">)</span>
</span><span id="Plate-528"><a href="#Plate-528"><span class="linenos">528</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
</span><span id="Plate-529"><a href="#Plate-529"><span class="linenos">529</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid max volume per well </span><span class="si">{</span><span class="n">max_volume_per_well</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Plate-530"><a href="#Plate-530"><span class="linenos">530</span></a>
</span><span id="Plate-531"><a href="#Plate-531"><span class="linenos">531</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Plate-532"><a href="#Plate-532"><span class="linenos">532</span></a>            <span class="k">if</span> <span class="n">columns</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Plate-533"><a href="#Plate-533"><span class="linenos">533</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;illegal number of columns&quot;</span><span class="p">)</span>
</span><span id="Plate-534"><a href="#Plate-534"><span class="linenos">534</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="Plate-535"><a href="#Plate-535"><span class="linenos">535</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">)]</span>
</span><span id="Plate-536"><a href="#Plate-536"><span class="linenos">536</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plate-537"><a href="#Plate-537"><span class="linenos">537</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-538"><a href="#Plate-538"><span class="linenos">538</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must have at least one row&quot;</span><span class="p">)</span>
</span><span id="Plate-539"><a href="#Plate-539"><span class="linenos">539</span></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="Plate-540"><a href="#Plate-540"><span class="linenos">540</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Plate-541"><a href="#Plate-541"><span class="linenos">541</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;row names must be strings&quot;</span><span class="p">)</span>
</span><span id="Plate-542"><a href="#Plate-542"><span class="linenos">542</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate-543"><a href="#Plate-543"><span class="linenos">543</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate-544"><a href="#Plate-544"><span class="linenos">544</span></a>                        <span class="s2">&quot;zero length strings are not allowed as column labels&quot;</span>
</span><span id="Plate-545"><a href="#Plate-545"><span class="linenos">545</span></a>                    <span class="p">)</span>
</span><span id="Plate-546"><a href="#Plate-546"><span class="linenos">546</span></a>                <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
</span><span id="Plate-547"><a href="#Plate-547"><span class="linenos">547</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate-548"><a href="#Plate-548"><span class="linenos">548</span></a>                        <span class="sa">f</span><span class="s2">&quot;please don&#39;t confuse me with column names that are integers(</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Plate-549"><a href="#Plate-549"><span class="linenos">549</span></a>                    <span class="p">)</span>
</span><span id="Plate-550"><a href="#Plate-550"><span class="linenos">550</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)):</span>
</span><span id="Plate-551"><a href="#Plate-551"><span class="linenos">551</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;duplicate column names found&quot;</span><span class="p">)</span>
</span><span id="Plate-552"><a href="#Plate-552"><span class="linenos">552</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Plate-553"><a href="#Plate-553"><span class="linenos">553</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="Plate-554"><a href="#Plate-554"><span class="linenos">554</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plate-555"><a href="#Plate-555"><span class="linenos">555</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;columns must be int or list&quot;</span><span class="p">)</span>
</span><span id="Plate-556"><a href="#Plate-556"><span class="linenos">556</span></a>
</span><span id="Plate-557"><a href="#Plate-557"><span class="linenos">557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Container</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;well </span><span class="si">{</span><span class="n">row</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">col</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Plate-558"><a href="#Plate-558"><span class="linenos">558</span></a>                                             <span class="n">max_volume</span><span class="o">=</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">))</span>
</span><span id="Plate-559"><a href="#Plate-559"><span class="linenos">559</span></a>                                   <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span><span class="p">)]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">)])</span>
</span><span id="Plate-560"><a href="#Plate-560"><span class="linenos">560</span></a>
</span><span id="Plate-561"><a href="#Plate-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PlateSlicer</span><span class="p">:</span>
</span><span id="Plate-562"><a href="#Plate-562"><span class="linenos">562</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span id="Plate-563"><a href="#Plate-563"><span class="linenos">563</span></a>
</span><span id="Plate-564"><a href="#Plate-564"><span class="linenos">564</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plate-565"><a href="#Plate-565"><span class="linenos">565</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Plate: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Plate-566"><a href="#Plate-566"><span class="linenos">566</span></a>
</span><span id="Plate-567"><a href="#Plate-567"><span class="linenos">567</span></a>    <span class="k">def</span> <span class="nf">volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substance</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Plate-568"><a href="#Plate-568"><span class="linenos">568</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-569"><a href="#Plate-569"><span class="linenos">569</span></a>
</span><span id="Plate-570"><a href="#Plate-570"><span class="linenos">570</span></a><span class="sd">        Args:</span>
</span><span id="Plate-571"><a href="#Plate-571"><span class="linenos">571</span></a><span class="sd">            substance: (optional) Substance to display volumes of.</span>
</span><span id="Plate-572"><a href="#Plate-572"><span class="linenos">572</span></a>
</span><span id="Plate-573"><a href="#Plate-573"><span class="linenos">573</span></a><span class="sd">        Returns:</span>
</span><span id="Plate-574"><a href="#Plate-574"><span class="linenos">574</span></a><span class="sd">            numpy.ndarray of volumes for each well in uL</span>
</span><span id="Plate-575"><a href="#Plate-575"><span class="linenos">575</span></a>
</span><span id="Plate-576"><a href="#Plate-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-577"><a href="#Plate-577"><span class="linenos">577</span></a>        <span class="k">if</span> <span class="n">substance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Plate-578"><a href="#Plate-578"><span class="linenos">578</span></a>            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="s1">&#39;uL&#39;</span><span class="p">))(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="Plate-579"><a href="#Plate-579"><span class="linenos">579</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plate-580"><a href="#Plate-580"><span class="linenos">580</span></a>            <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="Plate-581"><a href="#Plate-581"><span class="linenos">581</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot; Returns volume of elem. &quot;&quot;&quot;</span>
</span><span id="Plate-582"><a href="#Plate-582"><span class="linenos">582</span></a>                <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">()</span> <span class="ow">and</span> <span class="n">substance</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
</span><span id="Plate-583"><a href="#Plate-583"><span class="linenos">583</span></a>                    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;uL&#39;</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Plate-584"><a href="#Plate-584"><span class="linenos">584</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Plate-585"><a href="#Plate-585"><span class="linenos">585</span></a>                    <span class="k">return</span> <span class="mi">0</span>
</span><span id="Plate-586"><a href="#Plate-586"><span class="linenos">586</span></a>
</span><span id="Plate-587"><a href="#Plate-587"><span class="linenos">587</span></a>            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="Plate-588"><a href="#Plate-588"><span class="linenos">588</span></a>
</span><span id="Plate-589"><a href="#Plate-589"><span class="linenos">589</span></a>    <span class="k">def</span> <span class="nf">substances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plate-590"><a href="#Plate-590"><span class="linenos">590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-591"><a href="#Plate-591"><span class="linenos">591</span></a>
</span><span id="Plate-592"><a href="#Plate-592"><span class="linenos">592</span></a><span class="sd">        Returns: A set of substances present in the plate.</span>
</span><span id="Plate-593"><a href="#Plate-593"><span class="linenos">593</span></a>
</span><span id="Plate-594"><a href="#Plate-594"><span class="linenos">594</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-595"><a href="#Plate-595"><span class="linenos">595</span></a>        <span class="n">substances_arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">keys</span><span class="p">())(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="Plate-596"><a href="#Plate-596"><span class="linenos">596</span></a>        <span class="k">return</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">substances_arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</span><span id="Plate-597"><a href="#Plate-597"><span class="linenos">597</span></a>
</span><span id="Plate-598"><a href="#Plate-598"><span class="linenos">598</span></a>    <span class="k">def</span> <span class="nf">moles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substance</span><span class="p">):</span>
</span><span id="Plate-599"><a href="#Plate-599"><span class="linenos">599</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-600"><a href="#Plate-600"><span class="linenos">600</span></a><span class="sd">        Returns: moles of substance in each well.</span>
</span><span id="Plate-601"><a href="#Plate-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-602"><a href="#Plate-602"><span class="linenos">602</span></a>
</span><span id="Plate-603"><a href="#Plate-603"><span class="linenos">603</span></a>        <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="Plate-604"><a href="#Plate-604"><span class="linenos">604</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot; Returns moles of substance in elem. &quot;&quot;&quot;</span>
</span><span id="Plate-605"><a href="#Plate-605"><span class="linenos">605</span></a>            <span class="k">if</span> <span class="n">substance</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
</span><span id="Plate-606"><a href="#Plate-606"><span class="linenos">606</span></a>                <span class="k">return</span> <span class="mi">0</span>
</span><span id="Plate-607"><a href="#Plate-607"><span class="linenos">607</span></a>            <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="Plate-608"><a href="#Plate-608"><span class="linenos">608</span></a>                <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">substance</span><span class="o">.</span><span class="n">density</span> <span class="o">/</span>
</span><span id="Plate-609"><a href="#Plate-609"><span class="linenos">609</span></a>                             <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span><span class="p">,</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Plate-610"><a href="#Plate-610"><span class="linenos">610</span></a>            <span class="k">elif</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="Plate-611"><a href="#Plate-611"><span class="linenos">611</span></a>                <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;mol&#39;</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Plate-612"><a href="#Plate-612"><span class="linenos">612</span></a>
</span><span id="Plate-613"><a href="#Plate-613"><span class="linenos">613</span></a>        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="Plate-614"><a href="#Plate-614"><span class="linenos">614</span></a>
</span><span id="Plate-615"><a href="#Plate-615"><span class="linenos">615</span></a>    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plate-616"><a href="#Plate-616"><span class="linenos">616</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-617"><a href="#Plate-617"><span class="linenos">617</span></a><span class="sd">        Returns: total volume stored in plate in uL.</span>
</span><span id="Plate-618"><a href="#Plate-618"><span class="linenos">618</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-619"><a href="#Plate-619"><span class="linenos">619</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="Plate-620"><a href="#Plate-620"><span class="linenos">620</span></a>
</span><span id="Plate-621"><a href="#Plate-621"><span class="linenos">621</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plate-622"><a href="#Plate-622"><span class="linenos">622</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-623"><a href="#Plate-623"><span class="linenos">623</span></a><span class="sd">        Returns: A clone of the current plate.</span>
</span><span id="Plate-624"><a href="#Plate-624"><span class="linenos">624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-625"><a href="#Plate-625"><span class="linenos">625</span></a>        <span class="n">new_plate</span> <span class="o">=</span> <span class="n">Plate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">make</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Plate-626"><a href="#Plate-626"><span class="linenos">626</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">new_plate</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span>
</span><span id="Plate-627"><a href="#Plate-627"><span class="linenos">627</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">row_names</span><span class="p">,</span> <span class="n">new_plate</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span>
</span><span id="Plate-628"><a href="#Plate-628"><span class="linenos">628</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span>  <span class="c1"># Don&#39;t readjust this value</span>
</span><span id="Plate-629"><a href="#Plate-629"><span class="linenos">629</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Plate-630"><a href="#Plate-630"><span class="linenos">630</span></a>        <span class="k">return</span> <span class="n">new_plate</span>
</span><span id="Plate-631"><a href="#Plate-631"><span class="linenos">631</span></a>
</span><span id="Plate-632"><a href="#Plate-632"><span class="linenos">632</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Plate-633"><a href="#Plate-633"><span class="linenos">633</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Plate</span> <span class="o">|</span> <span class="n">PlateSlicer</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="Plate-634"><a href="#Plate-634"><span class="linenos">634</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-635"><a href="#Plate-635"><span class="linenos">635</span></a><span class="sd">        Move the given quantity (&#39;10 mol&#39;) of the source substance to the destination.</span>
</span><span id="Plate-636"><a href="#Plate-636"><span class="linenos">636</span></a>
</span><span id="Plate-637"><a href="#Plate-637"><span class="linenos">637</span></a><span class="sd">        Returns:</span>
</span><span id="Plate-638"><a href="#Plate-638"><span class="linenos">638</span></a><span class="sd">            A new copy of destination plate.</span>
</span><span id="Plate-639"><a href="#Plate-639"><span class="linenos">639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-640"><a href="#Plate-640"><span class="linenos">640</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Plate-641"><a href="#Plate-641"><span class="linenos">641</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Plate.add to add to a Plate&quot;</span><span class="p">)</span>
</span><span id="Plate-642"><a href="#Plate-642"><span class="linenos">642</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Plate-643"><a href="#Plate-643"><span class="linenos">643</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="Plate-644"><a href="#Plate-644"><span class="linenos">644</span></a>        <span class="c1"># noinspection PyProtectedMember</span>
</span><span id="Plate-645"><a href="#Plate-645"><span class="linenos">645</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Plate-646"><a href="#Plate-646"><span class="linenos">646</span></a>
</span><span id="Plate-647"><a href="#Plate-647"><span class="linenos">647</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Plate-648"><a href="#Plate-648"><span class="linenos">648</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Plate</span> <span class="o">|</span> <span class="n">PlateSlicer</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="Plate-649"><a href="#Plate-649"><span class="linenos">649</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate-650"><a href="#Plate-650"><span class="linenos">650</span></a><span class="sd">        Move volume (&#39;10 mL&#39;) from source to destination,</span>
</span><span id="Plate-651"><a href="#Plate-651"><span class="linenos">651</span></a><span class="sd">        returning copies of the objects with amounts adjusted accordingly.</span>
</span><span id="Plate-652"><a href="#Plate-652"><span class="linenos">652</span></a>
</span><span id="Plate-653"><a href="#Plate-653"><span class="linenos">653</span></a><span class="sd">        Returns:</span>
</span><span id="Plate-654"><a href="#Plate-654"><span class="linenos">654</span></a><span class="sd">            A tuple of (T, Plate) where T is the type of the source.</span>
</span><span id="Plate-655"><a href="#Plate-655"><span class="linenos">655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate-656"><a href="#Plate-656"><span class="linenos">656</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Plate-657"><a href="#Plate-657"><span class="linenos">657</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Plate.transfer into a Plate&quot;</span><span class="p">)</span>
</span><span id="Plate-658"><a href="#Plate-658"><span class="linenos">658</span></a>        <span class="c1"># noinspection PyProtectedMember</span>
</span><span id="Plate-659"><a href="#Plate-659"><span class="linenos">659</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="o">.</span><span class="n">_transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A spatially ordered collection of Containers, like a 96 well plate.
The spatial arrangement must be rectangular. Immutable.</p>
</div>


                            <div id="Plate.__init__" class="classattr">
                                        <input id="Plate.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Plate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">max_volume_per_well</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">make</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;generic&#39;</span>,</span><span class="param">	<span class="n">rows</span><span class="o">=</span><span class="mi">8</span>,</span><span class="param">	<span class="n">columns</span><span class="o">=</span><span class="mi">12</span></span>)</span>

                <label class="view-source-button" for="Plate.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.__init__-469"><a href="#Plate.__init__-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_volume_per_well</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">make</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;generic&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
</span><span id="Plate.__init__-470"><a href="#Plate.__init__-470"><span class="linenos">470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.__init__-471"><a href="#Plate.__init__-471"><span class="linenos">471</span></a><span class="sd">            Creates a generic plate.</span>
</span><span id="Plate.__init__-472"><a href="#Plate.__init__-472"><span class="linenos">472</span></a>
</span><span id="Plate.__init__-473"><a href="#Plate.__init__-473"><span class="linenos">473</span></a><span class="sd">            Attributes:</span>
</span><span id="Plate.__init__-474"><a href="#Plate.__init__-474"><span class="linenos">474</span></a><span class="sd">                name: name of plate</span>
</span><span id="Plate.__init__-475"><a href="#Plate.__init__-475"><span class="linenos">475</span></a><span class="sd">                max_volume_per_well: maximum volume of each well in uL</span>
</span><span id="Plate.__init__-476"><a href="#Plate.__init__-476"><span class="linenos">476</span></a><span class="sd">                make: name of this kind of plate</span>
</span><span id="Plate.__init__-477"><a href="#Plate.__init__-477"><span class="linenos">477</span></a><span class="sd">                rows (int or list): number of rows or list of names of rows</span>
</span><span id="Plate.__init__-478"><a href="#Plate.__init__-478"><span class="linenos">478</span></a><span class="sd">                columns (int or list): number of columns or list of names of columns</span>
</span><span id="Plate.__init__-479"><a href="#Plate.__init__-479"><span class="linenos">479</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.__init__-480"><a href="#Plate.__init__-480"><span class="linenos">480</span></a>
</span><span id="Plate.__init__-481"><a href="#Plate.__init__-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-482"><a href="#Plate.__init__-482"><span class="linenos">482</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid plate name&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-483"><a href="#Plate.__init__-483"><span class="linenos">483</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Plate.__init__-484"><a href="#Plate.__init__-484"><span class="linenos">484</span></a>
</span><span id="Plate.__init__-485"><a href="#Plate.__init__-485"><span class="linenos">485</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">make</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">make</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-486"><a href="#Plate.__init__-486"><span class="linenos">486</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid plate make&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-487"><a href="#Plate.__init__-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">make</span> <span class="o">=</span> <span class="n">make</span>
</span><span id="Plate.__init__-488"><a href="#Plate.__init__-488"><span class="linenos">488</span></a>
</span><span id="Plate.__init__-489"><a href="#Plate.__init__-489"><span class="linenos">489</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Plate.__init__-490"><a href="#Plate.__init__-490"><span class="linenos">490</span></a>            <span class="k">if</span> <span class="n">rows</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Plate.__init__-491"><a href="#Plate.__init__-491"><span class="linenos">491</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;illegal number of rows&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-492"><a href="#Plate.__init__-492"><span class="linenos">492</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="n">rows</span>
</span><span id="Plate.__init__-493"><a href="#Plate.__init__-493"><span class="linenos">493</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Plate.__init__-494"><a href="#Plate.__init__-494"><span class="linenos">494</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Plate.__init__-495"><a href="#Plate.__init__-495"><span class="linenos">495</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Plate.__init__-496"><a href="#Plate.__init__-496"><span class="linenos">496</span></a>                <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-497"><a href="#Plate.__init__-497"><span class="linenos">497</span></a>                    <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Plate.__init__-498"><a href="#Plate.__init__-498"><span class="linenos">498</span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">26</span><span class="p">))</span>
</span><span id="Plate.__init__-499"><a href="#Plate.__init__-499"><span class="linenos">499</span></a>                    <span class="n">n</span> <span class="o">//=</span> <span class="mi">26</span>
</span><span id="Plate.__init__-500"><a href="#Plate.__init__-500"><span class="linenos">500</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
</span><span id="Plate.__init__-501"><a href="#Plate.__init__-501"><span class="linenos">501</span></a>            <span class="c1"># self.row_names = [f&quot;{i + 1}&quot; for i in range(rows)]</span>
</span><span id="Plate.__init__-502"><a href="#Plate.__init__-502"><span class="linenos">502</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plate.__init__-503"><a href="#Plate.__init__-503"><span class="linenos">503</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-504"><a href="#Plate.__init__-504"><span class="linenos">504</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must have at least one row&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-505"><a href="#Plate.__init__-505"><span class="linenos">505</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
</span><span id="Plate.__init__-506"><a href="#Plate.__init__-506"><span class="linenos">506</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Plate.__init__-507"><a href="#Plate.__init__-507"><span class="linenos">507</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;row names must be strings&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-508"><a href="#Plate.__init__-508"><span class="linenos">508</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-509"><a href="#Plate.__init__-509"><span class="linenos">509</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate.__init__-510"><a href="#Plate.__init__-510"><span class="linenos">510</span></a>                        <span class="s2">&quot;zero length strings are not allowed as column labels&quot;</span>
</span><span id="Plate.__init__-511"><a href="#Plate.__init__-511"><span class="linenos">511</span></a>                    <span class="p">)</span>
</span><span id="Plate.__init__-512"><a href="#Plate.__init__-512"><span class="linenos">512</span></a>                <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
</span><span id="Plate.__init__-513"><a href="#Plate.__init__-513"><span class="linenos">513</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate.__init__-514"><a href="#Plate.__init__-514"><span class="linenos">514</span></a>                        <span class="sa">f</span><span class="s2">&quot;please don&#39;t confuse me with row names that are integers (</span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Plate.__init__-515"><a href="#Plate.__init__-515"><span class="linenos">515</span></a>                    <span class="p">)</span>
</span><span id="Plate.__init__-516"><a href="#Plate.__init__-516"><span class="linenos">516</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rows</span><span class="p">)):</span>
</span><span id="Plate.__init__-517"><a href="#Plate.__init__-517"><span class="linenos">517</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;duplicate row names found&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-518"><a href="#Plate.__init__-518"><span class="linenos">518</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</span><span id="Plate.__init__-519"><a href="#Plate.__init__-519"><span class="linenos">519</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="o">=</span> <span class="n">rows</span>
</span><span id="Plate.__init__-520"><a href="#Plate.__init__-520"><span class="linenos">520</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plate.__init__-521"><a href="#Plate.__init__-521"><span class="linenos">521</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;rows must be int or list&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-522"><a href="#Plate.__init__-522"><span class="linenos">522</span></a>
</span><span id="Plate.__init__-523"><a href="#Plate.__init__-523"><span class="linenos">523</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Plate.__init__-524"><a href="#Plate.__init__-524"><span class="linenos">524</span></a>            <span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_volume_per_well</span><span class="p">)</span>
</span><span id="Plate.__init__-525"><a href="#Plate.__init__-525"><span class="linenos">525</span></a>            <span class="k">if</span> <span class="n">max_volume_per_well</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-526"><a href="#Plate.__init__-526"><span class="linenos">526</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max volume per well must be greater than zero&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-527"><a href="#Plate.__init__-527"><span class="linenos">527</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_to_storage</span><span class="p">(</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="s1">&#39;uL&#39;</span><span class="p">)</span>
</span><span id="Plate.__init__-528"><a href="#Plate.__init__-528"><span class="linenos">528</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
</span><span id="Plate.__init__-529"><a href="#Plate.__init__-529"><span class="linenos">529</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid max volume per well </span><span class="si">{</span><span class="n">max_volume_per_well</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-530"><a href="#Plate.__init__-530"><span class="linenos">530</span></a>
</span><span id="Plate.__init__-531"><a href="#Plate.__init__-531"><span class="linenos">531</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Plate.__init__-532"><a href="#Plate.__init__-532"><span class="linenos">532</span></a>            <span class="k">if</span> <span class="n">columns</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Plate.__init__-533"><a href="#Plate.__init__-533"><span class="linenos">533</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;illegal number of columns&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-534"><a href="#Plate.__init__-534"><span class="linenos">534</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="Plate.__init__-535"><a href="#Plate.__init__-535"><span class="linenos">535</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">)]</span>
</span><span id="Plate.__init__-536"><a href="#Plate.__init__-536"><span class="linenos">536</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plate.__init__-537"><a href="#Plate.__init__-537"><span class="linenos">537</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-538"><a href="#Plate.__init__-538"><span class="linenos">538</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must have at least one row&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-539"><a href="#Plate.__init__-539"><span class="linenos">539</span></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="Plate.__init__-540"><a href="#Plate.__init__-540"><span class="linenos">540</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Plate.__init__-541"><a href="#Plate.__init__-541"><span class="linenos">541</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;row names must be strings&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-542"><a href="#Plate.__init__-542"><span class="linenos">542</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plate.__init__-543"><a href="#Plate.__init__-543"><span class="linenos">543</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate.__init__-544"><a href="#Plate.__init__-544"><span class="linenos">544</span></a>                        <span class="s2">&quot;zero length strings are not allowed as column labels&quot;</span>
</span><span id="Plate.__init__-545"><a href="#Plate.__init__-545"><span class="linenos">545</span></a>                    <span class="p">)</span>
</span><span id="Plate.__init__-546"><a href="#Plate.__init__-546"><span class="linenos">546</span></a>                <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
</span><span id="Plate.__init__-547"><a href="#Plate.__init__-547"><span class="linenos">547</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Plate.__init__-548"><a href="#Plate.__init__-548"><span class="linenos">548</span></a>                        <span class="sa">f</span><span class="s2">&quot;please don&#39;t confuse me with column names that are integers(</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Plate.__init__-549"><a href="#Plate.__init__-549"><span class="linenos">549</span></a>                    <span class="p">)</span>
</span><span id="Plate.__init__-550"><a href="#Plate.__init__-550"><span class="linenos">550</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)):</span>
</span><span id="Plate.__init__-551"><a href="#Plate.__init__-551"><span class="linenos">551</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;duplicate column names found&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-552"><a href="#Plate.__init__-552"><span class="linenos">552</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Plate.__init__-553"><a href="#Plate.__init__-553"><span class="linenos">553</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="Plate.__init__-554"><a href="#Plate.__init__-554"><span class="linenos">554</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plate.__init__-555"><a href="#Plate.__init__-555"><span class="linenos">555</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;columns must be int or list&quot;</span><span class="p">)</span>
</span><span id="Plate.__init__-556"><a href="#Plate.__init__-556"><span class="linenos">556</span></a>
</span><span id="Plate.__init__-557"><a href="#Plate.__init__-557"><span class="linenos">557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Container</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;well </span><span class="si">{</span><span class="n">row</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">col</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Plate.__init__-558"><a href="#Plate.__init__-558"><span class="linenos">558</span></a>                                             <span class="n">max_volume</span><span class="o">=</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="s1">&#39;mL&#39;</span><span class="p">))</span>
</span><span id="Plate.__init__-559"><a href="#Plate.__init__-559"><span class="linenos">559</span></a>                                   <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span><span class="p">)]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">)])</span>
</span></pre></div>


            <div class="docstring"><p>Creates a generic plate.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>name:</strong>  name of plate</li>
<li><strong>max_volume_per_well:</strong>  maximum volume of each well in uL</li>
<li><strong>make:</strong>  name of this kind of plate</li>
<li><strong>rows (int or list):</strong>  number of rows or list of names of rows</li>
<li><strong>columns (int or list):</strong>  number of columns or list of names of columns</li>
</ul>
</div>


                            </div>
                            <div id="Plate.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span>

        
    </div>
    <a class="headerlink" href="#Plate.name"></a>
    
    

                            </div>
                            <div id="Plate.make" class="classattr">
                                <div class="attr variable">
            <span class="name">make</span>

        
    </div>
    <a class="headerlink" href="#Plate.make"></a>
    
    

                            </div>
                            <div id="Plate.wells" class="classattr">
                                <div class="attr variable">
            <span class="name">wells</span>

        
    </div>
    <a class="headerlink" href="#Plate.wells"></a>
    
    

                            </div>
                            <div id="Plate.volumes" class="classattr">
                                        <input id="Plate.volumes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">volumes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">substance</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plate.volumes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.volumes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.volumes-567"><a href="#Plate.volumes-567"><span class="linenos">567</span></a>    <span class="k">def</span> <span class="nf">volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substance</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Plate.volumes-568"><a href="#Plate.volumes-568"><span class="linenos">568</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.volumes-569"><a href="#Plate.volumes-569"><span class="linenos">569</span></a>
</span><span id="Plate.volumes-570"><a href="#Plate.volumes-570"><span class="linenos">570</span></a><span class="sd">        Args:</span>
</span><span id="Plate.volumes-571"><a href="#Plate.volumes-571"><span class="linenos">571</span></a><span class="sd">            substance: (optional) Substance to display volumes of.</span>
</span><span id="Plate.volumes-572"><a href="#Plate.volumes-572"><span class="linenos">572</span></a>
</span><span id="Plate.volumes-573"><a href="#Plate.volumes-573"><span class="linenos">573</span></a><span class="sd">        Returns:</span>
</span><span id="Plate.volumes-574"><a href="#Plate.volumes-574"><span class="linenos">574</span></a><span class="sd">            numpy.ndarray of volumes for each well in uL</span>
</span><span id="Plate.volumes-575"><a href="#Plate.volumes-575"><span class="linenos">575</span></a>
</span><span id="Plate.volumes-576"><a href="#Plate.volumes-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.volumes-577"><a href="#Plate.volumes-577"><span class="linenos">577</span></a>        <span class="k">if</span> <span class="n">substance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Plate.volumes-578"><a href="#Plate.volumes-578"><span class="linenos">578</span></a>            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="s1">&#39;uL&#39;</span><span class="p">))(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="Plate.volumes-579"><a href="#Plate.volumes-579"><span class="linenos">579</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plate.volumes-580"><a href="#Plate.volumes-580"><span class="linenos">580</span></a>            <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="Plate.volumes-581"><a href="#Plate.volumes-581"><span class="linenos">581</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot; Returns volume of elem. &quot;&quot;&quot;</span>
</span><span id="Plate.volumes-582"><a href="#Plate.volumes-582"><span class="linenos">582</span></a>                <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">()</span> <span class="ow">and</span> <span class="n">substance</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
</span><span id="Plate.volumes-583"><a href="#Plate.volumes-583"><span class="linenos">583</span></a>                    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;uL&#39;</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Plate.volumes-584"><a href="#Plate.volumes-584"><span class="linenos">584</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Plate.volumes-585"><a href="#Plate.volumes-585"><span class="linenos">585</span></a>                    <span class="k">return</span> <span class="mi">0</span>
</span><span id="Plate.volumes-586"><a href="#Plate.volumes-586"><span class="linenos">586</span></a>
</span><span id="Plate.volumes-587"><a href="#Plate.volumes-587"><span class="linenos">587</span></a>            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>substance:</strong>  (optional) Substance to display volumes of.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>numpy.ndarray of volumes for each well in uL</p>
</blockquote>
</div>


                            </div>
                            <div id="Plate.substances" class="classattr">
                                        <input id="Plate.substances-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">substances</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plate.substances-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.substances"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.substances-589"><a href="#Plate.substances-589"><span class="linenos">589</span></a>    <span class="k">def</span> <span class="nf">substances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plate.substances-590"><a href="#Plate.substances-590"><span class="linenos">590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.substances-591"><a href="#Plate.substances-591"><span class="linenos">591</span></a>
</span><span id="Plate.substances-592"><a href="#Plate.substances-592"><span class="linenos">592</span></a><span class="sd">        Returns: A set of substances present in the plate.</span>
</span><span id="Plate.substances-593"><a href="#Plate.substances-593"><span class="linenos">593</span></a>
</span><span id="Plate.substances-594"><a href="#Plate.substances-594"><span class="linenos">594</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.substances-595"><a href="#Plate.substances-595"><span class="linenos">595</span></a>        <span class="n">substances_arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">keys</span><span class="p">())(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span><span id="Plate.substances-596"><a href="#Plate.substances-596"><span class="linenos">596</span></a>        <span class="k">return</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">substances_arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</span></pre></div>


            <div class="docstring"><p>Returns: A set of substances present in the plate.</p>
</div>


                            </div>
                            <div id="Plate.moles" class="classattr">
                                        <input id="Plate.moles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">moles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">substance</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plate.moles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.moles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.moles-598"><a href="#Plate.moles-598"><span class="linenos">598</span></a>    <span class="k">def</span> <span class="nf">moles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">substance</span><span class="p">):</span>
</span><span id="Plate.moles-599"><a href="#Plate.moles-599"><span class="linenos">599</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.moles-600"><a href="#Plate.moles-600"><span class="linenos">600</span></a><span class="sd">        Returns: moles of substance in each well.</span>
</span><span id="Plate.moles-601"><a href="#Plate.moles-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.moles-602"><a href="#Plate.moles-602"><span class="linenos">602</span></a>
</span><span id="Plate.moles-603"><a href="#Plate.moles-603"><span class="linenos">603</span></a>        <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">elem</span><span class="p">):</span>
</span><span id="Plate.moles-604"><a href="#Plate.moles-604"><span class="linenos">604</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot; Returns moles of substance in elem. &quot;&quot;&quot;</span>
</span><span id="Plate.moles-605"><a href="#Plate.moles-605"><span class="linenos">605</span></a>            <span class="k">if</span> <span class="n">substance</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
</span><span id="Plate.moles-606"><a href="#Plate.moles-606"><span class="linenos">606</span></a>                <span class="k">return</span> <span class="mi">0</span>
</span><span id="Plate.moles-607"><a href="#Plate.moles-607"><span class="linenos">607</span></a>            <span class="k">if</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_liquid</span><span class="p">():</span>
</span><span id="Plate.moles-608"><a href="#Plate.moles-608"><span class="linenos">608</span></a>                <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;mL&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">substance</span><span class="o">.</span><span class="n">density</span> <span class="o">/</span>
</span><span id="Plate.moles-609"><a href="#Plate.moles-609"><span class="linenos">609</span></a>                             <span class="n">substance</span><span class="o">.</span><span class="n">mol_weight</span><span class="p">,</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Plate.moles-610"><a href="#Plate.moles-610"><span class="linenos">610</span></a>            <span class="k">elif</span> <span class="n">substance</span><span class="o">.</span><span class="n">is_solid</span><span class="p">():</span>
</span><span id="Plate.moles-611"><a href="#Plate.moles-611"><span class="linenos">611</span></a>                <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Unit</span><span class="o">.</span><span class="n">convert_from_storage</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="n">substance</span><span class="p">],</span> <span class="s1">&#39;mol&#39;</span><span class="p">),</span> <span class="n">EXTERNAL_PRECISION</span><span class="p">)</span>
</span><span id="Plate.moles-612"><a href="#Plate.moles-612"><span class="linenos">612</span></a>
</span><span id="Plate.moles-613"><a href="#Plate.moles-613"><span class="linenos">613</span></a>        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">helper</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns: moles of substance in each well.</p>
</div>


                            </div>
                            <div id="Plate.volume" class="classattr">
                                        <input id="Plate.volume-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">volume</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plate.volume-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.volume"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.volume-615"><a href="#Plate.volume-615"><span class="linenos">615</span></a>    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plate.volume-616"><a href="#Plate.volume-616"><span class="linenos">616</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.volume-617"><a href="#Plate.volume-617"><span class="linenos">617</span></a><span class="sd">        Returns: total volume stored in plate in uL.</span>
</span><span id="Plate.volume-618"><a href="#Plate.volume-618"><span class="linenos">618</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.volume-619"><a href="#Plate.volume-619"><span class="linenos">619</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Returns: total volume stored in plate in uL.</p>
</div>


                            </div>
                            <div id="Plate.copy" class="classattr">
                                        <input id="Plate.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plate.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.copy-621"><a href="#Plate.copy-621"><span class="linenos">621</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plate.copy-622"><a href="#Plate.copy-622"><span class="linenos">622</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.copy-623"><a href="#Plate.copy-623"><span class="linenos">623</span></a><span class="sd">        Returns: A clone of the current plate.</span>
</span><span id="Plate.copy-624"><a href="#Plate.copy-624"><span class="linenos">624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.copy-625"><a href="#Plate.copy-625"><span class="linenos">625</span></a>        <span class="n">new_plate</span> <span class="o">=</span> <span class="n">Plate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">make</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Plate.copy-626"><a href="#Plate.copy-626"><span class="linenos">626</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">new_plate</span><span class="o">.</span><span class="n">n_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_columns</span>
</span><span id="Plate.copy-627"><a href="#Plate.copy-627"><span class="linenos">627</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">row_names</span><span class="p">,</span> <span class="n">new_plate</span><span class="o">.</span><span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span>
</span><span id="Plate.copy-628"><a href="#Plate.copy-628"><span class="linenos">628</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">max_volume_per_well</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_volume_per_well</span>  <span class="c1"># Don&#39;t readjust this value</span>
</span><span id="Plate.copy-629"><a href="#Plate.copy-629"><span class="linenos">629</span></a>        <span class="n">new_plate</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Plate.copy-630"><a href="#Plate.copy-630"><span class="linenos">630</span></a>        <span class="k">return</span> <span class="n">new_plate</span>
</span></pre></div>


            <div class="docstring"><p>Returns: A clone of the current plate.</p>
</div>


                            </div>
                            <div id="Plate.add" class="classattr">
                                        <input id="Plate.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>,</span><span class="param">	<span class="n">destination</span><span class="p">:</span> <span class="n"><a href="#Plate">pyplate.pyplate.Plate</a></span> <span class="o">|</span> <span class="n">pyplate</span><span class="o">.</span><span class="n">pyplate</span><span class="o">.</span><span class="n">PlateSlicer</span>,</span><span class="param">	<span class="n">how_much</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plate.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.add-632"><a href="#Plate.add-632"><span class="linenos">632</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Plate.add-633"><a href="#Plate.add-633"><span class="linenos">633</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Plate</span> <span class="o">|</span> <span class="n">PlateSlicer</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="Plate.add-634"><a href="#Plate.add-634"><span class="linenos">634</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.add-635"><a href="#Plate.add-635"><span class="linenos">635</span></a><span class="sd">        Move the given quantity (&#39;10 mol&#39;) of the source substance to the destination.</span>
</span><span id="Plate.add-636"><a href="#Plate.add-636"><span class="linenos">636</span></a>
</span><span id="Plate.add-637"><a href="#Plate.add-637"><span class="linenos">637</span></a><span class="sd">        Returns:</span>
</span><span id="Plate.add-638"><a href="#Plate.add-638"><span class="linenos">638</span></a><span class="sd">            A new copy of destination plate.</span>
</span><span id="Plate.add-639"><a href="#Plate.add-639"><span class="linenos">639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.add-640"><a href="#Plate.add-640"><span class="linenos">640</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Plate.add-641"><a href="#Plate.add-641"><span class="linenos">641</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Plate.add to add to a Plate&quot;</span><span class="p">)</span>
</span><span id="Plate.add-642"><a href="#Plate.add-642"><span class="linenos">642</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Plate.add-643"><a href="#Plate.add-643"><span class="linenos">643</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="Plate.add-644"><a href="#Plate.add-644"><span class="linenos">644</span></a>        <span class="c1"># noinspection PyProtectedMember</span>
</span><span id="Plate.add-645"><a href="#Plate.add-645"><span class="linenos">645</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Move the given quantity ('10 mol') of the source substance to the destination.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new copy of destination plate.</p>
</blockquote>
</div>


                            </div>
                            <div id="Plate.transfer" class="classattr">
                                        <input id="Plate.transfer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">transfer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span>,</span><span class="param">	<span class="n">destination</span><span class="p">:</span> <span class="n"><a href="#Plate">pyplate.pyplate.Plate</a></span> <span class="o">|</span> <span class="n">pyplate</span><span class="o">.</span><span class="n">pyplate</span><span class="o">.</span><span class="n">PlateSlicer</span>,</span><span class="param">	<span class="n">volume</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plate.transfer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plate.transfer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plate.transfer-647"><a href="#Plate.transfer-647"><span class="linenos">647</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Plate.transfer-648"><a href="#Plate.transfer-648"><span class="linenos">648</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Plate</span> <span class="o">|</span> <span class="n">PlateSlicer</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
</span><span id="Plate.transfer-649"><a href="#Plate.transfer-649"><span class="linenos">649</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plate.transfer-650"><a href="#Plate.transfer-650"><span class="linenos">650</span></a><span class="sd">        Move volume (&#39;10 mL&#39;) from source to destination,</span>
</span><span id="Plate.transfer-651"><a href="#Plate.transfer-651"><span class="linenos">651</span></a><span class="sd">        returning copies of the objects with amounts adjusted accordingly.</span>
</span><span id="Plate.transfer-652"><a href="#Plate.transfer-652"><span class="linenos">652</span></a>
</span><span id="Plate.transfer-653"><a href="#Plate.transfer-653"><span class="linenos">653</span></a><span class="sd">        Returns:</span>
</span><span id="Plate.transfer-654"><a href="#Plate.transfer-654"><span class="linenos">654</span></a><span class="sd">            A tuple of (T, Plate) where T is the type of the source.</span>
</span><span id="Plate.transfer-655"><a href="#Plate.transfer-655"><span class="linenos">655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plate.transfer-656"><a href="#Plate.transfer-656"><span class="linenos">656</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Plate.transfer-657"><a href="#Plate.transfer-657"><span class="linenos">657</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You can only use Plate.transfer into a Plate&quot;</span><span class="p">)</span>
</span><span id="Plate.transfer-658"><a href="#Plate.transfer-658"><span class="linenos">658</span></a>        <span class="c1"># noinspection PyProtectedMember</span>
</span><span id="Plate.transfer-659"><a href="#Plate.transfer-659"><span class="linenos">659</span></a>        <span class="k">return</span> <span class="n">PlateSlicer</span><span class="o">.</span><span class="n">_transfer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Move volume ('10 mL') from source to destination,
returning copies of the objects with amounts adjusted accordingly.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A tuple of (T, Plate) where T is the type of the source.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Recipe">
                            <input id="Recipe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Recipe</span>:

                <label class="view-source-button" for="Recipe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Recipe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Recipe-662"><a href="#Recipe-662"><span class="linenos">662</span></a><span class="k">class</span> <span class="nc">Recipe</span><span class="p">:</span>
</span><span id="Recipe-663"><a href="#Recipe-663"><span class="linenos">663</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe-664"><a href="#Recipe-664"><span class="linenos">664</span></a><span class="sd">    A list of instructions for transforming one set of containers into another. The intended workflow is to declare</span>
</span><span id="Recipe-665"><a href="#Recipe-665"><span class="linenos">665</span></a><span class="sd">    the source containers, enumerate the desired transformations, and call recipe.bake(). This method will ensure</span>
</span><span id="Recipe-666"><a href="#Recipe-666"><span class="linenos">666</span></a><span class="sd">    that all solid and liquid handling instructions are valid. If they are indeed valid, then the updated containers</span>
</span><span id="Recipe-667"><a href="#Recipe-667"><span class="linenos">667</span></a><span class="sd">    will be generated. Once recipe.bake() has been called, no more instructions can be added and the Recipe is</span>
</span><span id="Recipe-668"><a href="#Recipe-668"><span class="linenos">668</span></a><span class="sd">    considered immutable.</span>
</span><span id="Recipe-669"><a href="#Recipe-669"><span class="linenos">669</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Recipe-670"><a href="#Recipe-670"><span class="linenos">670</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Recipe-671"><a href="#Recipe-671"><span class="linenos">671</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Recipe-672"><a href="#Recipe-672"><span class="linenos">672</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Recipe-673"><a href="#Recipe-673"><span class="linenos">673</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Recipe-674"><a href="#Recipe-674"><span class="linenos">674</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locked</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Recipe-675"><a href="#Recipe-675"><span class="linenos">675</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">used</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Recipe-676"><a href="#Recipe-676"><span class="linenos">676</span></a>
</span><span id="Recipe-677"><a href="#Recipe-677"><span class="linenos">677</span></a>    <span class="k">def</span> <span class="nf">uses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Recipe-678"><a href="#Recipe-678"><span class="linenos">678</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe-679"><a href="#Recipe-679"><span class="linenos">679</span></a><span class="sd">        Declare *containers (iterable of Containers) as being used in the recipe.</span>
</span><span id="Recipe-680"><a href="#Recipe-680"><span class="linenos">680</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe-681"><a href="#Recipe-681"><span class="linenos">681</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe-682"><a href="#Recipe-682"><span class="linenos">682</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe-683"><a href="#Recipe-683"><span class="linenos">683</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Recipe-684"><a href="#Recipe-684"><span class="linenos">684</span></a>            <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe-685"><a href="#Recipe-685"><span class="linenos">685</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
</span><span id="Recipe-686"><a href="#Recipe-686"><span class="linenos">686</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Recipe-687"><a href="#Recipe-687"><span class="linenos">687</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span><span id="Recipe-688"><a href="#Recipe-688"><span class="linenos">688</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe-689"><a href="#Recipe-689"><span class="linenos">689</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="Recipe-690"><a href="#Recipe-690"><span class="linenos">690</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Recipe-691"><a href="#Recipe-691"><span class="linenos">691</span></a>
</span><span id="Recipe-692"><a href="#Recipe-692"><span class="linenos">692</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="Recipe-693"><a href="#Recipe-693"><span class="linenos">693</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe-694"><a href="#Recipe-694"><span class="linenos">694</span></a><span class="sd">        Adds a step to the recipe which will move the given quantity (&#39;10 mol&#39;)</span>
</span><span id="Recipe-695"><a href="#Recipe-695"><span class="linenos">695</span></a><span class="sd">        of the source substance to the destination.</span>
</span><span id="Recipe-696"><a href="#Recipe-696"><span class="linenos">696</span></a>
</span><span id="Recipe-697"><a href="#Recipe-697"><span class="linenos">697</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe-698"><a href="#Recipe-698"><span class="linenos">698</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe-699"><a href="#Recipe-699"><span class="linenos">699</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe-700"><a href="#Recipe-700"><span class="linenos">700</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Recipe-701"><a href="#Recipe-701"><span class="linenos">701</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Recipe-702"><a href="#Recipe-702"><span class="linenos">702</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Recipe-703"><a href="#Recipe-703"><span class="linenos">703</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination type.&quot;</span><span class="p">)</span>
</span><span id="Recipe-704"><a href="#Recipe-704"><span class="linenos">704</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">destination</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe-705"><a href="#Recipe-705"><span class="linenos">705</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Destination not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="Recipe-706"><a href="#Recipe-706"><span class="linenos">706</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Recipe-707"><a href="#Recipe-707"><span class="linenos">707</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="Recipe-708"><a href="#Recipe-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">))</span>
</span><span id="Recipe-709"><a href="#Recipe-709"><span class="linenos">709</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Recipe-710"><a href="#Recipe-710"><span class="linenos">710</span></a>
</span><span id="Recipe-711"><a href="#Recipe-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span> <span class="o">|</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Recipe-712"><a href="#Recipe-712"><span class="linenos">712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe-713"><a href="#Recipe-713"><span class="linenos">713</span></a><span class="sd">        Adds a step to the recipe which will move volume from source to destination.</span>
</span><span id="Recipe-714"><a href="#Recipe-714"><span class="linenos">714</span></a><span class="sd">        Note that all Substances in the source will be transferred in proportion to their volumetric ratios.</span>
</span><span id="Recipe-715"><a href="#Recipe-715"><span class="linenos">715</span></a>
</span><span id="Recipe-716"><a href="#Recipe-716"><span class="linenos">716</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe-717"><a href="#Recipe-717"><span class="linenos">717</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe-718"><a href="#Recipe-718"><span class="linenos">718</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe-719"><a href="#Recipe-719"><span class="linenos">719</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Recipe-720"><a href="#Recipe-720"><span class="linenos">720</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination type.&quot;</span><span class="p">)</span>
</span><span id="Recipe-721"><a href="#Recipe-721"><span class="linenos">721</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">(</span><span class="n">Substance</span><span class="p">,</span> <span class="n">Container</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Recipe-722"><a href="#Recipe-722"><span class="linenos">722</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Recipe-723"><a href="#Recipe-723"><span class="linenos">723</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">source</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe-724"><a href="#Recipe-724"><span class="linenos">724</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Source not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="Recipe-725"><a href="#Recipe-725"><span class="linenos">725</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">destination</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe-726"><a href="#Recipe-726"><span class="linenos">726</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Destination not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="Recipe-727"><a href="#Recipe-727"><span class="linenos">727</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Recipe-728"><a href="#Recipe-728"><span class="linenos">728</span></a>            <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">[:]</span>
</span><span id="Recipe-729"><a href="#Recipe-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Recipe-730"><a href="#Recipe-730"><span class="linenos">730</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="Recipe-731"><a href="#Recipe-731"><span class="linenos">731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;transfer&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">volume</span><span class="p">))</span>
</span><span id="Recipe-732"><a href="#Recipe-732"><span class="linenos">732</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Recipe-733"><a href="#Recipe-733"><span class="linenos">733</span></a>
</span><span id="Recipe-734"><a href="#Recipe-734"><span class="linenos">734</span></a>    <span class="k">def</span> <span class="nf">create_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="p">,</span> <span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Recipe-735"><a href="#Recipe-735"><span class="linenos">735</span></a>
</span><span id="Recipe-736"><a href="#Recipe-736"><span class="linenos">736</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe-737"><a href="#Recipe-737"><span class="linenos">737</span></a><span class="sd">        Adds a step to the recipe which creates a container.</span>
</span><span id="Recipe-738"><a href="#Recipe-738"><span class="linenos">738</span></a>
</span><span id="Recipe-739"><a href="#Recipe-739"><span class="linenos">739</span></a><span class="sd">        Args:</span>
</span><span id="Recipe-740"><a href="#Recipe-740"><span class="linenos">740</span></a><span class="sd">            name: Name of container</span>
</span><span id="Recipe-741"><a href="#Recipe-741"><span class="linenos">741</span></a><span class="sd">            max_volume: Maximum volume that can be stored in the container in mL</span>
</span><span id="Recipe-742"><a href="#Recipe-742"><span class="linenos">742</span></a><span class="sd">            initial_contents: (optional) Iterable of tuples of the form (Substance, quantity)</span>
</span><span id="Recipe-743"><a href="#Recipe-743"><span class="linenos">743</span></a>
</span><span id="Recipe-744"><a href="#Recipe-744"><span class="linenos">744</span></a><span class="sd">        Returns:</span>
</span><span id="Recipe-745"><a href="#Recipe-745"><span class="linenos">745</span></a><span class="sd">            A new Container so that it may be used in later recipe steps.</span>
</span><span id="Recipe-746"><a href="#Recipe-746"><span class="linenos">746</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe-747"><a href="#Recipe-747"><span class="linenos">747</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe-748"><a href="#Recipe-748"><span class="linenos">748</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe-749"><a href="#Recipe-749"><span class="linenos">749</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="p">)</span>
</span><span id="Recipe-750"><a href="#Recipe-750"><span class="linenos">750</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">new_container</span><span class="p">)</span>
</span><span id="Recipe-751"><a href="#Recipe-751"><span class="linenos">751</span></a>        <span class="k">if</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Recipe-752"><a href="#Recipe-752"><span class="linenos">752</span></a>            <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span> <span class="ow">in</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Recipe-753"><a href="#Recipe-753"><span class="linenos">753</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Recipe-754"><a href="#Recipe-754"><span class="linenos">754</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Containers can only be created from substances.&quot;</span><span class="p">)</span>
</span><span id="Recipe-755"><a href="#Recipe-755"><span class="linenos">755</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">substance</span><span class="p">,</span> <span class="n">new_container</span><span class="p">,</span> <span class="n">how_much</span><span class="p">))</span>
</span><span id="Recipe-756"><a href="#Recipe-756"><span class="linenos">756</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span><span id="Recipe-757"><a href="#Recipe-757"><span class="linenos">757</span></a>
</span><span id="Recipe-758"><a href="#Recipe-758"><span class="linenos">758</span></a>    <span class="k">def</span> <span class="nf">create_stock_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">solvent</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Recipe-759"><a href="#Recipe-759"><span class="linenos">759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe-760"><a href="#Recipe-760"><span class="linenos">760</span></a>
</span><span id="Recipe-761"><a href="#Recipe-761"><span class="linenos">761</span></a><span class="sd">        Adds a step to the recipe which creates a stock solution.</span>
</span><span id="Recipe-762"><a href="#Recipe-762"><span class="linenos">762</span></a>
</span><span id="Recipe-763"><a href="#Recipe-763"><span class="linenos">763</span></a><span class="sd">        Args:</span>
</span><span id="Recipe-764"><a href="#Recipe-764"><span class="linenos">764</span></a><span class="sd">            what: What to dilute.</span>
</span><span id="Recipe-765"><a href="#Recipe-765"><span class="linenos">765</span></a><span class="sd">            concentration: Desired concentration in mol/L</span>
</span><span id="Recipe-766"><a href="#Recipe-766"><span class="linenos">766</span></a><span class="sd">            solvent: What to dilute with.</span>
</span><span id="Recipe-767"><a href="#Recipe-767"><span class="linenos">767</span></a><span class="sd">            volume: Desired total volume in mL.</span>
</span><span id="Recipe-768"><a href="#Recipe-768"><span class="linenos">768</span></a>
</span><span id="Recipe-769"><a href="#Recipe-769"><span class="linenos">769</span></a><span class="sd">        Returns:</span>
</span><span id="Recipe-770"><a href="#Recipe-770"><span class="linenos">770</span></a><span class="sd">            A new Container so that it may be used in later recipe steps.</span>
</span><span id="Recipe-771"><a href="#Recipe-771"><span class="linenos">771</span></a>
</span><span id="Recipe-772"><a href="#Recipe-772"><span class="linenos">772</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe-773"><a href="#Recipe-773"><span class="linenos">773</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe-774"><a href="#Recipe-774"><span class="linenos">774</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe-775"><a href="#Recipe-775"><span class="linenos">775</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{what.name}</span><span class="s2"> </span><span class="si">{concentration:.2}</span><span class="s2">M&quot;</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Recipe-776"><a href="#Recipe-776"><span class="linenos">776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">new_container</span><span class="p">)</span>
</span><span id="Recipe-777"><a href="#Recipe-777"><span class="linenos">777</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;stock&#39;</span><span class="p">,</span> <span class="n">new_container</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span><span class="p">))</span>
</span><span id="Recipe-778"><a href="#Recipe-778"><span class="linenos">778</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span><span id="Recipe-779"><a href="#Recipe-779"><span class="linenos">779</span></a>
</span><span id="Recipe-780"><a href="#Recipe-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">bake</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Recipe-781"><a href="#Recipe-781"><span class="linenos">781</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe-782"><a href="#Recipe-782"><span class="linenos">782</span></a><span class="sd">        Completes steps stored in recipe.</span>
</span><span id="Recipe-783"><a href="#Recipe-783"><span class="linenos">783</span></a><span class="sd">        Checks validity of each step and ensures all declared objects have been used.</span>
</span><span id="Recipe-784"><a href="#Recipe-784"><span class="linenos">784</span></a><span class="sd">        Locks Recipe from further modification.</span>
</span><span id="Recipe-785"><a href="#Recipe-785"><span class="linenos">785</span></a>
</span><span id="Recipe-786"><a href="#Recipe-786"><span class="linenos">786</span></a><span class="sd">        Returns:</span>
</span><span id="Recipe-787"><a href="#Recipe-787"><span class="linenos">787</span></a><span class="sd">            Copies of all used objects in the order they were declared.</span>
</span><span id="Recipe-788"><a href="#Recipe-788"><span class="linenos">788</span></a>
</span><span id="Recipe-789"><a href="#Recipe-789"><span class="linenos">789</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe-790"><a href="#Recipe-790"><span class="linenos">790</span></a>        <span class="k">for</span> <span class="n">operation</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
</span><span id="Recipe-791"><a href="#Recipe-791"><span class="linenos">791</span></a>            <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span><span class="p">:</span>
</span><span id="Recipe-792"><a href="#Recipe-792"><span class="linenos">792</span></a>                <span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="Recipe-793"><a href="#Recipe-793"><span class="linenos">793</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="Recipe-794"><a href="#Recipe-794"><span class="linenos">794</span></a>
</span><span id="Recipe-795"><a href="#Recipe-795"><span class="linenos">795</span></a>                <span class="c1"># containers and such can change while building the recipe</span>
</span><span id="Recipe-796"><a href="#Recipe-796"><span class="linenos">796</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe-797"><a href="#Recipe-797"><span class="linenos">797</span></a>                    <span class="n">new_to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Recipe-798"><a href="#Recipe-798"><span class="linenos">798</span></a>                    <span class="n">new_to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe-799"><a href="#Recipe-799"><span class="linenos">799</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="Recipe-800"><a href="#Recipe-800"><span class="linenos">800</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe-801"><a href="#Recipe-801"><span class="linenos">801</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe-802"><a href="#Recipe-802"><span class="linenos">802</span></a>
</span><span id="Recipe-803"><a href="#Recipe-803"><span class="linenos">803</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Recipe-804"><a href="#Recipe-804"><span class="linenos">804</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe-805"><a href="#Recipe-805"><span class="linenos">805</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe-806"><a href="#Recipe-806"><span class="linenos">806</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe-807"><a href="#Recipe-807"><span class="linenos">807</span></a>
</span><span id="Recipe-808"><a href="#Recipe-808"><span class="linenos">808</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
</span><span id="Recipe-809"><a href="#Recipe-809"><span class="linenos">809</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="Recipe-810"><a href="#Recipe-810"><span class="linenos">810</span></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;transfer&#39;</span><span class="p">:</span>
</span><span id="Recipe-811"><a href="#Recipe-811"><span class="linenos">811</span></a>                <span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="Recipe-812"><a href="#Recipe-812"><span class="linenos">812</span></a>                <span class="c1"># used items can change in a recipe</span>
</span><span id="Recipe-813"><a href="#Recipe-813"><span class="linenos">813</span></a>                <span class="n">frm_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">frm</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">frm</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="Recipe-814"><a href="#Recipe-814"><span class="linenos">814</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="Recipe-815"><a href="#Recipe-815"><span class="linenos">815</span></a>
</span><span id="Recipe-816"><a href="#Recipe-816"><span class="linenos">816</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm_index</span><span class="p">)</span>
</span><span id="Recipe-817"><a href="#Recipe-817"><span class="linenos">817</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="Recipe-818"><a href="#Recipe-818"><span class="linenos">818</span></a>
</span><span id="Recipe-819"><a href="#Recipe-819"><span class="linenos">819</span></a>                <span class="c1"># containers and such can change while baking the recipe</span>
</span><span id="Recipe-820"><a href="#Recipe-820"><span class="linenos">820</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe-821"><a href="#Recipe-821"><span class="linenos">821</span></a>                    <span class="n">new_frm</span> <span class="o">=</span> <span class="n">frm</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Recipe-822"><a href="#Recipe-822"><span class="linenos">822</span></a>                    <span class="n">new_frm</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span>
</span><span id="Recipe-823"><a href="#Recipe-823"><span class="linenos">823</span></a>                    <span class="n">frm</span> <span class="o">=</span> <span class="n">new_frm</span>
</span><span id="Recipe-824"><a href="#Recipe-824"><span class="linenos">824</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe-825"><a href="#Recipe-825"><span class="linenos">825</span></a>                    <span class="n">frm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span>
</span><span id="Recipe-826"><a href="#Recipe-826"><span class="linenos">826</span></a>
</span><span id="Recipe-827"><a href="#Recipe-827"><span class="linenos">827</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe-828"><a href="#Recipe-828"><span class="linenos">828</span></a>                    <span class="n">new_to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Recipe-829"><a href="#Recipe-829"><span class="linenos">829</span></a>                    <span class="n">new_to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe-830"><a href="#Recipe-830"><span class="linenos">830</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="Recipe-831"><a href="#Recipe-831"><span class="linenos">831</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe-832"><a href="#Recipe-832"><span class="linenos">832</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe-833"><a href="#Recipe-833"><span class="linenos">833</span></a>
</span><span id="Recipe-834"><a href="#Recipe-834"><span class="linenos">834</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>  <span class="c1"># Adding a substance is handled differently</span>
</span><span id="Recipe-835"><a href="#Recipe-835"><span class="linenos">835</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Recipe-836"><a href="#Recipe-836"><span class="linenos">836</span></a>                        <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe-837"><a href="#Recipe-837"><span class="linenos">837</span></a>                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe-838"><a href="#Recipe-838"><span class="linenos">838</span></a>                        <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe-839"><a href="#Recipe-839"><span class="linenos">839</span></a>                    <span class="c1"># to = to.add(frm, how_much)</span>
</span><span id="Recipe-840"><a href="#Recipe-840"><span class="linenos">840</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Recipe-841"><a href="#Recipe-841"><span class="linenos">841</span></a>                    <span class="n">frm</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe-842"><a href="#Recipe-842"><span class="linenos">842</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe-843"><a href="#Recipe-843"><span class="linenos">843</span></a>                    <span class="n">frm</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe-844"><a href="#Recipe-844"><span class="linenos">844</span></a>
</span><span id="Recipe-845"><a href="#Recipe-845"><span class="linenos">845</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">frm</span>
</span><span id="Recipe-846"><a href="#Recipe-846"><span class="linenos">846</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
</span><span id="Recipe-847"><a href="#Recipe-847"><span class="linenos">847</span></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;stock&#39;</span><span class="p">:</span>
</span><span id="Recipe-848"><a href="#Recipe-848"><span class="linenos">848</span></a>                <span class="n">to</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="Recipe-849"><a href="#Recipe-849"><span class="linenos">849</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span>
</span><span id="Recipe-850"><a href="#Recipe-850"><span class="linenos">850</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="Recipe-851"><a href="#Recipe-851"><span class="linenos">851</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">create_stock_solution</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="Recipe-852"><a href="#Recipe-852"><span class="linenos">852</span></a>
</span><span id="Recipe-853"><a href="#Recipe-853"><span class="linenos">853</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">):</span>
</span><span id="Recipe-854"><a href="#Recipe-854"><span class="linenos">854</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Something declared as used wasn&#39;t used.&quot;</span><span class="p">)</span>
</span><span id="Recipe-855"><a href="#Recipe-855"><span class="linenos">855</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locked</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Recipe-856"><a href="#Recipe-856"><span class="linenos">856</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Substance</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>A list of instructions for transforming one set of containers into another. The intended workflow is to declare
the source containers, enumerate the desired transformations, and call recipe.bake(). This method will ensure
that all solid and liquid handling instructions are valid. If they are indeed valid, then the updated containers
will be generated. Once recipe.bake() has been called, no more instructions can be added and the Recipe is
considered immutable.</p>
</div>


                            <div id="Recipe.indexes" class="classattr">
                                <div class="attr variable">
            <span class="name">indexes</span>

        
    </div>
    <a class="headerlink" href="#Recipe.indexes"></a>
    
    

                            </div>
                            <div id="Recipe.results" class="classattr">
                                <div class="attr variable">
            <span class="name">results</span>

        
    </div>
    <a class="headerlink" href="#Recipe.results"></a>
    
    

                            </div>
                            <div id="Recipe.steps" class="classattr">
                                <div class="attr variable">
            <span class="name">steps</span>

        
    </div>
    <a class="headerlink" href="#Recipe.steps"></a>
    
    

                            </div>
                            <div id="Recipe.locked" class="classattr">
                                <div class="attr variable">
            <span class="name">locked</span>

        
    </div>
    <a class="headerlink" href="#Recipe.locked"></a>
    
    

                            </div>
                            <div id="Recipe.used" class="classattr">
                                <div class="attr variable">
            <span class="name">used</span>

        
    </div>
    <a class="headerlink" href="#Recipe.used"></a>
    
    

                            </div>
                            <div id="Recipe.uses" class="classattr">
                                        <input id="Recipe.uses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">uses</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Recipe.uses-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Recipe.uses"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Recipe.uses-677"><a href="#Recipe.uses-677"><span class="linenos">677</span></a>    <span class="k">def</span> <span class="nf">uses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Recipe.uses-678"><a href="#Recipe.uses-678"><span class="linenos">678</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe.uses-679"><a href="#Recipe.uses-679"><span class="linenos">679</span></a><span class="sd">        Declare *containers (iterable of Containers) as being used in the recipe.</span>
</span><span id="Recipe.uses-680"><a href="#Recipe.uses-680"><span class="linenos">680</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe.uses-681"><a href="#Recipe.uses-681"><span class="linenos">681</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe.uses-682"><a href="#Recipe.uses-682"><span class="linenos">682</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe.uses-683"><a href="#Recipe.uses-683"><span class="linenos">683</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Recipe.uses-684"><a href="#Recipe.uses-684"><span class="linenos">684</span></a>            <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe.uses-685"><a href="#Recipe.uses-685"><span class="linenos">685</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
</span><span id="Recipe.uses-686"><a href="#Recipe.uses-686"><span class="linenos">686</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Recipe.uses-687"><a href="#Recipe.uses-687"><span class="linenos">687</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span><span id="Recipe.uses-688"><a href="#Recipe.uses-688"><span class="linenos">688</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe.uses-689"><a href="#Recipe.uses-689"><span class="linenos">689</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</span><span id="Recipe.uses-690"><a href="#Recipe.uses-690"><span class="linenos">690</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Declare *containers (iterable of Containers) as being used in the recipe.</p>
</div>


                            </div>
                            <div id="Recipe.add" class="classattr">
                                        <input id="Recipe.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">source</span>, </span><span class="param"><span class="n">destination</span>, </span><span class="param"><span class="n">how_much</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Recipe.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Recipe.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Recipe.add-692"><a href="#Recipe.add-692"><span class="linenos">692</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">):</span>
</span><span id="Recipe.add-693"><a href="#Recipe.add-693"><span class="linenos">693</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe.add-694"><a href="#Recipe.add-694"><span class="linenos">694</span></a><span class="sd">        Adds a step to the recipe which will move the given quantity (&#39;10 mol&#39;)</span>
</span><span id="Recipe.add-695"><a href="#Recipe.add-695"><span class="linenos">695</span></a><span class="sd">        of the source substance to the destination.</span>
</span><span id="Recipe.add-696"><a href="#Recipe.add-696"><span class="linenos">696</span></a>
</span><span id="Recipe.add-697"><a href="#Recipe.add-697"><span class="linenos">697</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe.add-698"><a href="#Recipe.add-698"><span class="linenos">698</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe.add-699"><a href="#Recipe.add-699"><span class="linenos">699</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe.add-700"><a href="#Recipe.add-700"><span class="linenos">700</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Recipe.add-701"><a href="#Recipe.add-701"><span class="linenos">701</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Recipe.add-702"><a href="#Recipe.add-702"><span class="linenos">702</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Recipe.add-703"><a href="#Recipe.add-703"><span class="linenos">703</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination type.&quot;</span><span class="p">)</span>
</span><span id="Recipe.add-704"><a href="#Recipe.add-704"><span class="linenos">704</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">destination</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe.add-705"><a href="#Recipe.add-705"><span class="linenos">705</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Destination not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="Recipe.add-706"><a href="#Recipe.add-706"><span class="linenos">706</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Recipe.add-707"><a href="#Recipe.add-707"><span class="linenos">707</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="Recipe.add-708"><a href="#Recipe.add-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">how_much</span><span class="p">))</span>
</span><span id="Recipe.add-709"><a href="#Recipe.add-709"><span class="linenos">709</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Adds a step to the recipe which will move the given quantity ('10 mol')
of the source substance to the destination.</p>
</div>


                            </div>
                            <div id="Recipe.transfer" class="classattr">
                                        <input id="Recipe.transfer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">transfer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n"><a href="#Container">pyplate.pyplate.Container</a></span>,</span><span class="param">	<span class="n">destination</span><span class="p">:</span> <span class="n"><a href="#Container">pyplate.pyplate.Container</a></span> <span class="o">|</span> <span class="n"><a href="#Plate">pyplate.pyplate.Plate</a></span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Recipe.transfer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Recipe.transfer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Recipe.transfer-711"><a href="#Recipe.transfer-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Container</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Container</span> <span class="o">|</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Recipe.transfer-712"><a href="#Recipe.transfer-712"><span class="linenos">712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe.transfer-713"><a href="#Recipe.transfer-713"><span class="linenos">713</span></a><span class="sd">        Adds a step to the recipe which will move volume from source to destination.</span>
</span><span id="Recipe.transfer-714"><a href="#Recipe.transfer-714"><span class="linenos">714</span></a><span class="sd">        Note that all Substances in the source will be transferred in proportion to their volumetric ratios.</span>
</span><span id="Recipe.transfer-715"><a href="#Recipe.transfer-715"><span class="linenos">715</span></a>
</span><span id="Recipe.transfer-716"><a href="#Recipe.transfer-716"><span class="linenos">716</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe.transfer-717"><a href="#Recipe.transfer-717"><span class="linenos">717</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe.transfer-718"><a href="#Recipe.transfer-718"><span class="linenos">718</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe.transfer-719"><a href="#Recipe.transfer-719"><span class="linenos">719</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="n">Plate</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Recipe.transfer-720"><a href="#Recipe.transfer-720"><span class="linenos">720</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid destination type.&quot;</span><span class="p">)</span>
</span><span id="Recipe.transfer-721"><a href="#Recipe.transfer-721"><span class="linenos">721</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">(</span><span class="n">Substance</span><span class="p">,</span> <span class="n">Container</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)):</span>
</span><span id="Recipe.transfer-722"><a href="#Recipe.transfer-722"><span class="linenos">722</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid source type.&quot;</span><span class="p">)</span>
</span><span id="Recipe.transfer-723"><a href="#Recipe.transfer-723"><span class="linenos">723</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">source</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe.transfer-724"><a href="#Recipe.transfer-724"><span class="linenos">724</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Source not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="Recipe.transfer-725"><a href="#Recipe.transfer-725"><span class="linenos">725</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">destination</span><span class="o">.</span><span class="n">plate</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="n">destination</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">:</span>
</span><span id="Recipe.transfer-726"><a href="#Recipe.transfer-726"><span class="linenos">726</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Destination not found in declared uses.&quot;</span><span class="p">)</span>
</span><span id="Recipe.transfer-727"><a href="#Recipe.transfer-727"><span class="linenos">727</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Recipe.transfer-728"><a href="#Recipe.transfer-728"><span class="linenos">728</span></a>            <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">[:]</span>
</span><span id="Recipe.transfer-729"><a href="#Recipe.transfer-729"><span class="linenos">729</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">Plate</span><span class="p">):</span>
</span><span id="Recipe.transfer-730"><a href="#Recipe.transfer-730"><span class="linenos">730</span></a>            <span class="n">destination</span> <span class="o">=</span> <span class="n">destination</span><span class="p">[:]</span>
</span><span id="Recipe.transfer-731"><a href="#Recipe.transfer-731"><span class="linenos">731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;transfer&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">volume</span><span class="p">))</span>
</span><span id="Recipe.transfer-732"><a href="#Recipe.transfer-732"><span class="linenos">732</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Adds a step to the recipe which will move volume from source to destination.
Note that all Substances in the source will be transferred in proportion to their volumetric ratios.</p>
</div>


                            </div>
                            <div id="Recipe.create_container" class="classattr">
                                        <input id="Recipe.create_container-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_container</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span>, </span><span class="param"><span class="n">max_volume</span>, </span><span class="param"><span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Recipe.create_container-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Recipe.create_container"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Recipe.create_container-734"><a href="#Recipe.create_container-734"><span class="linenos">734</span></a>    <span class="k">def</span> <span class="nf">create_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="p">,</span> <span class="n">initial_contents</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Recipe.create_container-735"><a href="#Recipe.create_container-735"><span class="linenos">735</span></a>
</span><span id="Recipe.create_container-736"><a href="#Recipe.create_container-736"><span class="linenos">736</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe.create_container-737"><a href="#Recipe.create_container-737"><span class="linenos">737</span></a><span class="sd">        Adds a step to the recipe which creates a container.</span>
</span><span id="Recipe.create_container-738"><a href="#Recipe.create_container-738"><span class="linenos">738</span></a>
</span><span id="Recipe.create_container-739"><a href="#Recipe.create_container-739"><span class="linenos">739</span></a><span class="sd">        Args:</span>
</span><span id="Recipe.create_container-740"><a href="#Recipe.create_container-740"><span class="linenos">740</span></a><span class="sd">            name: Name of container</span>
</span><span id="Recipe.create_container-741"><a href="#Recipe.create_container-741"><span class="linenos">741</span></a><span class="sd">            max_volume: Maximum volume that can be stored in the container in mL</span>
</span><span id="Recipe.create_container-742"><a href="#Recipe.create_container-742"><span class="linenos">742</span></a><span class="sd">            initial_contents: (optional) Iterable of tuples of the form (Substance, quantity)</span>
</span><span id="Recipe.create_container-743"><a href="#Recipe.create_container-743"><span class="linenos">743</span></a>
</span><span id="Recipe.create_container-744"><a href="#Recipe.create_container-744"><span class="linenos">744</span></a><span class="sd">        Returns:</span>
</span><span id="Recipe.create_container-745"><a href="#Recipe.create_container-745"><span class="linenos">745</span></a><span class="sd">            A new Container so that it may be used in later recipe steps.</span>
</span><span id="Recipe.create_container-746"><a href="#Recipe.create_container-746"><span class="linenos">746</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe.create_container-747"><a href="#Recipe.create_container-747"><span class="linenos">747</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe.create_container-748"><a href="#Recipe.create_container-748"><span class="linenos">748</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe.create_container-749"><a href="#Recipe.create_container-749"><span class="linenos">749</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">max_volume</span><span class="p">)</span>
</span><span id="Recipe.create_container-750"><a href="#Recipe.create_container-750"><span class="linenos">750</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">new_container</span><span class="p">)</span>
</span><span id="Recipe.create_container-751"><a href="#Recipe.create_container-751"><span class="linenos">751</span></a>        <span class="k">if</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Recipe.create_container-752"><a href="#Recipe.create_container-752"><span class="linenos">752</span></a>            <span class="k">for</span> <span class="n">substance</span><span class="p">,</span> <span class="n">how_much</span> <span class="ow">in</span> <span class="n">initial_contents</span><span class="p">:</span>
</span><span id="Recipe.create_container-753"><a href="#Recipe.create_container-753"><span class="linenos">753</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">substance</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>
</span><span id="Recipe.create_container-754"><a href="#Recipe.create_container-754"><span class="linenos">754</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Containers can only be created from substances.&quot;</span><span class="p">)</span>
</span><span id="Recipe.create_container-755"><a href="#Recipe.create_container-755"><span class="linenos">755</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">substance</span><span class="p">,</span> <span class="n">new_container</span><span class="p">,</span> <span class="n">how_much</span><span class="p">))</span>
</span><span id="Recipe.create_container-756"><a href="#Recipe.create_container-756"><span class="linenos">756</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span></pre></div>


            <div class="docstring"><p>Adds a step to the recipe which creates a container.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name:</strong>  Name of container</li>
<li><strong>max_volume:</strong>  Maximum volume that can be stored in the container in mL</li>
<li><strong>initial_contents:</strong>  (optional) Iterable of tuples of the form (Substance, quantity)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new Container so that it may be used in later recipe steps.</p>
</blockquote>
</div>


                            </div>
                            <div id="Recipe.create_stock_solution" class="classattr">
                                        <input id="Recipe.create_stock_solution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_stock_solution</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">what</span><span class="p">:</span> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>,</span><span class="param">	<span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">solvent</span><span class="p">:</span> <span class="n"><a href="#Substance">pyplate.pyplate.Substance</a></span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Recipe.create_stock_solution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Recipe.create_stock_solution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Recipe.create_stock_solution-758"><a href="#Recipe.create_stock_solution-758"><span class="linenos">758</span></a>    <span class="k">def</span> <span class="nf">create_stock_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">concentration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">solvent</span><span class="p">:</span> <span class="n">Substance</span><span class="p">,</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Recipe.create_stock_solution-759"><a href="#Recipe.create_stock_solution-759"><span class="linenos">759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe.create_stock_solution-760"><a href="#Recipe.create_stock_solution-760"><span class="linenos">760</span></a>
</span><span id="Recipe.create_stock_solution-761"><a href="#Recipe.create_stock_solution-761"><span class="linenos">761</span></a><span class="sd">        Adds a step to the recipe which creates a stock solution.</span>
</span><span id="Recipe.create_stock_solution-762"><a href="#Recipe.create_stock_solution-762"><span class="linenos">762</span></a>
</span><span id="Recipe.create_stock_solution-763"><a href="#Recipe.create_stock_solution-763"><span class="linenos">763</span></a><span class="sd">        Args:</span>
</span><span id="Recipe.create_stock_solution-764"><a href="#Recipe.create_stock_solution-764"><span class="linenos">764</span></a><span class="sd">            what: What to dilute.</span>
</span><span id="Recipe.create_stock_solution-765"><a href="#Recipe.create_stock_solution-765"><span class="linenos">765</span></a><span class="sd">            concentration: Desired concentration in mol/L</span>
</span><span id="Recipe.create_stock_solution-766"><a href="#Recipe.create_stock_solution-766"><span class="linenos">766</span></a><span class="sd">            solvent: What to dilute with.</span>
</span><span id="Recipe.create_stock_solution-767"><a href="#Recipe.create_stock_solution-767"><span class="linenos">767</span></a><span class="sd">            volume: Desired total volume in mL.</span>
</span><span id="Recipe.create_stock_solution-768"><a href="#Recipe.create_stock_solution-768"><span class="linenos">768</span></a>
</span><span id="Recipe.create_stock_solution-769"><a href="#Recipe.create_stock_solution-769"><span class="linenos">769</span></a><span class="sd">        Returns:</span>
</span><span id="Recipe.create_stock_solution-770"><a href="#Recipe.create_stock_solution-770"><span class="linenos">770</span></a><span class="sd">            A new Container so that it may be used in later recipe steps.</span>
</span><span id="Recipe.create_stock_solution-771"><a href="#Recipe.create_stock_solution-771"><span class="linenos">771</span></a>
</span><span id="Recipe.create_stock_solution-772"><a href="#Recipe.create_stock_solution-772"><span class="linenos">772</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe.create_stock_solution-773"><a href="#Recipe.create_stock_solution-773"><span class="linenos">773</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked</span><span class="p">:</span>
</span><span id="Recipe.create_stock_solution-774"><a href="#Recipe.create_stock_solution-774"><span class="linenos">774</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This recipe is locked.&quot;</span><span class="p">)</span>
</span><span id="Recipe.create_stock_solution-775"><a href="#Recipe.create_stock_solution-775"><span class="linenos">775</span></a>        <span class="n">new_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{what.name}</span><span class="s2"> </span><span class="si">{concentration:.2}</span><span class="s2">M&quot;</span><span class="p">,</span> <span class="n">max_volume</span><span class="o">=</span><span class="n">volume</span><span class="p">)</span>
</span><span id="Recipe.create_stock_solution-776"><a href="#Recipe.create_stock_solution-776"><span class="linenos">776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">new_container</span><span class="p">)</span>
</span><span id="Recipe.create_stock_solution-777"><a href="#Recipe.create_stock_solution-777"><span class="linenos">777</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;stock&#39;</span><span class="p">,</span> <span class="n">new_container</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span><span class="p">))</span>
</span><span id="Recipe.create_stock_solution-778"><a href="#Recipe.create_stock_solution-778"><span class="linenos">778</span></a>        <span class="k">return</span> <span class="n">new_container</span>
</span></pre></div>


            <div class="docstring"><p>Adds a step to the recipe which creates a stock solution.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>what:</strong>  What to dilute.</li>
<li><strong>concentration:</strong>  Desired concentration in mol/L</li>
<li><strong>solvent:</strong>  What to dilute with.</li>
<li><strong>volume:</strong>  Desired total volume in mL.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A new Container so that it may be used in later recipe steps.</p>
</blockquote>
</div>


                            </div>
                            <div id="Recipe.bake" class="classattr">
                                        <input id="Recipe.bake-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bake</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Recipe.bake-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Recipe.bake"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Recipe.bake-780"><a href="#Recipe.bake-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">bake</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Recipe.bake-781"><a href="#Recipe.bake-781"><span class="linenos">781</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Recipe.bake-782"><a href="#Recipe.bake-782"><span class="linenos">782</span></a><span class="sd">        Completes steps stored in recipe.</span>
</span><span id="Recipe.bake-783"><a href="#Recipe.bake-783"><span class="linenos">783</span></a><span class="sd">        Checks validity of each step and ensures all declared objects have been used.</span>
</span><span id="Recipe.bake-784"><a href="#Recipe.bake-784"><span class="linenos">784</span></a><span class="sd">        Locks Recipe from further modification.</span>
</span><span id="Recipe.bake-785"><a href="#Recipe.bake-785"><span class="linenos">785</span></a>
</span><span id="Recipe.bake-786"><a href="#Recipe.bake-786"><span class="linenos">786</span></a><span class="sd">        Returns:</span>
</span><span id="Recipe.bake-787"><a href="#Recipe.bake-787"><span class="linenos">787</span></a><span class="sd">            Copies of all used objects in the order they were declared.</span>
</span><span id="Recipe.bake-788"><a href="#Recipe.bake-788"><span class="linenos">788</span></a>
</span><span id="Recipe.bake-789"><a href="#Recipe.bake-789"><span class="linenos">789</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Recipe.bake-790"><a href="#Recipe.bake-790"><span class="linenos">790</span></a>        <span class="k">for</span> <span class="n">operation</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
</span><span id="Recipe.bake-791"><a href="#Recipe.bake-791"><span class="linenos">791</span></a>            <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span><span class="p">:</span>
</span><span id="Recipe.bake-792"><a href="#Recipe.bake-792"><span class="linenos">792</span></a>                <span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="Recipe.bake-793"><a href="#Recipe.bake-793"><span class="linenos">793</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="Recipe.bake-794"><a href="#Recipe.bake-794"><span class="linenos">794</span></a>
</span><span id="Recipe.bake-795"><a href="#Recipe.bake-795"><span class="linenos">795</span></a>                <span class="c1"># containers and such can change while building the recipe</span>
</span><span id="Recipe.bake-796"><a href="#Recipe.bake-796"><span class="linenos">796</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe.bake-797"><a href="#Recipe.bake-797"><span class="linenos">797</span></a>                    <span class="n">new_to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Recipe.bake-798"><a href="#Recipe.bake-798"><span class="linenos">798</span></a>                    <span class="n">new_to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe.bake-799"><a href="#Recipe.bake-799"><span class="linenos">799</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="Recipe.bake-800"><a href="#Recipe.bake-800"><span class="linenos">800</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe.bake-801"><a href="#Recipe.bake-801"><span class="linenos">801</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe.bake-802"><a href="#Recipe.bake-802"><span class="linenos">802</span></a>
</span><span id="Recipe.bake-803"><a href="#Recipe.bake-803"><span class="linenos">803</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Recipe.bake-804"><a href="#Recipe.bake-804"><span class="linenos">804</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe.bake-805"><a href="#Recipe.bake-805"><span class="linenos">805</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe.bake-806"><a href="#Recipe.bake-806"><span class="linenos">806</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe.bake-807"><a href="#Recipe.bake-807"><span class="linenos">807</span></a>
</span><span id="Recipe.bake-808"><a href="#Recipe.bake-808"><span class="linenos">808</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
</span><span id="Recipe.bake-809"><a href="#Recipe.bake-809"><span class="linenos">809</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="Recipe.bake-810"><a href="#Recipe.bake-810"><span class="linenos">810</span></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;transfer&#39;</span><span class="p">:</span>
</span><span id="Recipe.bake-811"><a href="#Recipe.bake-811"><span class="linenos">811</span></a>                <span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="Recipe.bake-812"><a href="#Recipe.bake-812"><span class="linenos">812</span></a>                <span class="c1"># used items can change in a recipe</span>
</span><span id="Recipe.bake-813"><a href="#Recipe.bake-813"><span class="linenos">813</span></a>                <span class="n">frm_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">frm</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">frm</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="Recipe.bake-814"><a href="#Recipe.bake-814"><span class="linenos">814</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="o">.</span><span class="n">plate</span><span class="p">]</span>
</span><span id="Recipe.bake-815"><a href="#Recipe.bake-815"><span class="linenos">815</span></a>
</span><span id="Recipe.bake-816"><a href="#Recipe.bake-816"><span class="linenos">816</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm_index</span><span class="p">)</span>
</span><span id="Recipe.bake-817"><a href="#Recipe.bake-817"><span class="linenos">817</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="Recipe.bake-818"><a href="#Recipe.bake-818"><span class="linenos">818</span></a>
</span><span id="Recipe.bake-819"><a href="#Recipe.bake-819"><span class="linenos">819</span></a>                <span class="c1"># containers and such can change while baking the recipe</span>
</span><span id="Recipe.bake-820"><a href="#Recipe.bake-820"><span class="linenos">820</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe.bake-821"><a href="#Recipe.bake-821"><span class="linenos">821</span></a>                    <span class="n">new_frm</span> <span class="o">=</span> <span class="n">frm</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Recipe.bake-822"><a href="#Recipe.bake-822"><span class="linenos">822</span></a>                    <span class="n">new_frm</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span>
</span><span id="Recipe.bake-823"><a href="#Recipe.bake-823"><span class="linenos">823</span></a>                    <span class="n">frm</span> <span class="o">=</span> <span class="n">new_frm</span>
</span><span id="Recipe.bake-824"><a href="#Recipe.bake-824"><span class="linenos">824</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe.bake-825"><a href="#Recipe.bake-825"><span class="linenos">825</span></a>                    <span class="n">frm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span>
</span><span id="Recipe.bake-826"><a href="#Recipe.bake-826"><span class="linenos">826</span></a>
</span><span id="Recipe.bake-827"><a href="#Recipe.bake-827"><span class="linenos">827</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe.bake-828"><a href="#Recipe.bake-828"><span class="linenos">828</span></a>                    <span class="n">new_to</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Recipe.bake-829"><a href="#Recipe.bake-829"><span class="linenos">829</span></a>                    <span class="n">new_to</span><span class="o">.</span><span class="n">plate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe.bake-830"><a href="#Recipe.bake-830"><span class="linenos">830</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="n">new_to</span>
</span><span id="Recipe.bake-831"><a href="#Recipe.bake-831"><span class="linenos">831</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Recipe.bake-832"><a href="#Recipe.bake-832"><span class="linenos">832</span></a>                    <span class="n">to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span>
</span><span id="Recipe.bake-833"><a href="#Recipe.bake-833"><span class="linenos">833</span></a>
</span><span id="Recipe.bake-834"><a href="#Recipe.bake-834"><span class="linenos">834</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">Substance</span><span class="p">):</span>  <span class="c1"># Adding a substance is handled differently</span>
</span><span id="Recipe.bake-835"><a href="#Recipe.bake-835"><span class="linenos">835</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Recipe.bake-836"><a href="#Recipe.bake-836"><span class="linenos">836</span></a>                        <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe.bake-837"><a href="#Recipe.bake-837"><span class="linenos">837</span></a>                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe.bake-838"><a href="#Recipe.bake-838"><span class="linenos">838</span></a>                        <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe.bake-839"><a href="#Recipe.bake-839"><span class="linenos">839</span></a>                    <span class="c1"># to = to.add(frm, how_much)</span>
</span><span id="Recipe.bake-840"><a href="#Recipe.bake-840"><span class="linenos">840</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
</span><span id="Recipe.bake-841"><a href="#Recipe.bake-841"><span class="linenos">841</span></a>                    <span class="n">frm</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe.bake-842"><a href="#Recipe.bake-842"><span class="linenos">842</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">PlateSlicer</span><span class="p">):</span>
</span><span id="Recipe.bake-843"><a href="#Recipe.bake-843"><span class="linenos">843</span></a>                    <span class="n">frm</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">Plate</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">frm</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">how_much</span><span class="p">)</span>
</span><span id="Recipe.bake-844"><a href="#Recipe.bake-844"><span class="linenos">844</span></a>
</span><span id="Recipe.bake-845"><a href="#Recipe.bake-845"><span class="linenos">845</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">frm_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">frm</span>
</span><span id="Recipe.bake-846"><a href="#Recipe.bake-846"><span class="linenos">846</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
</span><span id="Recipe.bake-847"><a href="#Recipe.bake-847"><span class="linenos">847</span></a>            <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s1">&#39;stock&#39;</span><span class="p">:</span>
</span><span id="Recipe.bake-848"><a href="#Recipe.bake-848"><span class="linenos">848</span></a>                <span class="n">to</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="Recipe.bake-849"><a href="#Recipe.bake-849"><span class="linenos">849</span></a>                <span class="n">to_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">to</span><span class="p">]</span>
</span><span id="Recipe.bake-850"><a href="#Recipe.bake-850"><span class="linenos">850</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">to_index</span><span class="p">)</span>
</span><span id="Recipe.bake-851"><a href="#Recipe.bake-851"><span class="linenos">851</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">to_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">create_stock_solution</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">solvent</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span>
</span><span id="Recipe.bake-852"><a href="#Recipe.bake-852"><span class="linenos">852</span></a>
</span><span id="Recipe.bake-853"><a href="#Recipe.bake-853"><span class="linenos">853</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">used</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">):</span>
</span><span id="Recipe.bake-854"><a href="#Recipe.bake-854"><span class="linenos">854</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Something declared as used wasn&#39;t used.&quot;</span><span class="p">)</span>
</span><span id="Recipe.bake-855"><a href="#Recipe.bake-855"><span class="linenos">855</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locked</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Recipe.bake-856"><a href="#Recipe.bake-856"><span class="linenos">856</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Substance</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Completes steps stored in recipe.
Checks validity of each step and ensures all declared objects have been used.
Locks Recipe from further modification.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Copies of all used objects in the order they were declared.</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>